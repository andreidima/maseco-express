import{v as commonjsGlobal,r as ref,o as onMounted,f as openBlock,i as createElementBlock}from"./app-9b754f1d.js";import{_ as _export_sfc}from"./_plugin-vue_export-helper-c27b6911.js";function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var distExports={},dist={get exports(){return distExports},set exports(n){distExports=n}},jsuitesExports={},jsuites={get exports(){return jsuitesExports},set exports(n){jsuitesExports=n}},hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(n,l){(function(c,f){n.exports=f()})(commonjsGlobal,function(){var c;return function(){var f={195:function(m){(function(u,d){m.exports=d()})(this,function(){return function(qe){function d(Le,Te){this.highOrder=Le,this.lowOrder=Te}var F=[new d(1779033703,4089235720),new d(3144134277,2227873595),new d(1013904242,4271175723),new d(2773480762,1595750129),new d(1359893119,2917565137),new d(2600822924,725511199),new d(528734635,4215389547),new d(1541459225,327033209)],_=[new d(1116352408,3609767458),new d(1899447441,602891725),new d(3049323471,3964484399),new d(3921009573,2173295548),new d(961987163,4081628472),new d(1508970993,3053834265),new d(2453635748,2937671579),new d(2870763221,3664609560),new d(3624381080,2734883394),new d(310598401,1164996542),new d(607225278,1323610764),new d(1426881987,3590304994),new d(1925078388,4068182383),new d(2162078206,991336113),new d(2614888103,633803317),new d(3248222580,3479774868),new d(3835390401,2666613458),new d(4022224774,944711139),new d(264347078,2341262773),new d(604807628,2007800933),new d(770255983,1495990901),new d(1249150122,1856431235),new d(1555081692,3175218132),new d(1996064986,2198950837),new d(2554220882,3999719339),new d(2821834349,766784016),new d(2952996808,2566594879),new d(3210313671,3203337956),new d(3336571891,1034457026),new d(3584528711,2466948901),new d(113926993,3758326383),new d(338241895,168717936),new d(666307205,1188179964),new d(773529912,1546045734),new d(1294757372,1522805485),new d(1396182291,2643833823),new d(1695183700,2343527390),new d(1986661051,1014477480),new d(2177026350,1206759142),new d(2456956037,344077627),new d(2730485921,1290863460),new d(2820302411,3158454273),new d(3259730800,3505952657),new d(3345764771,106217008),new d(3516065817,3606008344),new d(3600352804,1432725776),new d(4094571909,1467031594),new d(275423344,851169720),new d(430227734,3100823752),new d(506948616,1363258195),new d(659060556,3750685593),new d(883997877,3785050280),new d(958139571,3318307427),new d(1322822218,3812723403),new d(1537002063,2003034995),new d(1747873779,3602036899),new d(1955562222,1575990012),new d(2024104815,1125592928),new d(2227730452,2716904306),new d(2361852424,442776044),new d(2428436474,593698344),new d(2756734187,3733110249),new d(3204031479,2999351573),new d(3329325298,3815920427),new d(3391569614,3928383900),new d(3515267271,566280711),new d(3940187606,3454069534),new d(4118630271,4000239992),new d(116418474,1914138554),new d(174292421,2731055270),new d(289380356,3203993006),new d(460393269,320620315),new d(685471733,587496836),new d(852142971,1086792851),new d(1017036298,365543100),new d(1126000580,2618297676),new d(1288033470,3409855158),new d(1501505948,4234509866),new d(1607167915,987167468),new d(1816402316,1246189591)],g=new Array(64),s,b,j,h,C,T,I,B,O,A,R,Z,q=8;function se(Le){return unescape(encodeURIComponent(Le))}function ge(Le){for(var Te=[],Be=(1<<q)-1,Ue=Le.length*q,Ze=0;Ze<Ue;Ze+=q)Te[Ze>>5]|=(Le.charCodeAt(Ze/q)&Be)<<32-q-Ze%32;return Te}function ae(Le){for(var Te="0123456789abcdef",Be="",Ue=Le.length*4,Ze,nt=0;nt<Ue;nt+=1)Ze=Le[nt>>2]>>(3-nt%4)*8,Be+=Te.charAt(Ze>>4&15)+Te.charAt(Ze&15);return Be}function be(Le,Te){var Be,Ue,Ze,nt;return Be=(Le.lowOrder&65535)+(Te.lowOrder&65535),Ue=(Le.lowOrder>>>16)+(Te.lowOrder>>>16)+(Be>>>16),Ze=(Ue&65535)<<16|Be&65535,Be=(Le.highOrder&65535)+(Te.highOrder&65535)+(Ue>>>16),Ue=(Le.highOrder>>>16)+(Te.highOrder>>>16)+(Be>>>16),nt=(Ue&65535)<<16|Be&65535,new d(nt,Ze)}function Ae(Le,Te,Be,Ue){var Ze,nt,rt,dt;return Ze=(Le.lowOrder&65535)+(Te.lowOrder&65535)+(Be.lowOrder&65535)+(Ue.lowOrder&65535),nt=(Le.lowOrder>>>16)+(Te.lowOrder>>>16)+(Be.lowOrder>>>16)+(Ue.lowOrder>>>16)+(Ze>>>16),rt=(nt&65535)<<16|Ze&65535,Ze=(Le.highOrder&65535)+(Te.highOrder&65535)+(Be.highOrder&65535)+(Ue.highOrder&65535)+(nt>>>16),nt=(Le.highOrder>>>16)+(Te.highOrder>>>16)+(Be.highOrder>>>16)+(Ue.highOrder>>>16)+(Ze>>>16),dt=(nt&65535)<<16|Ze&65535,new d(dt,rt)}function je(Le,Te,Be,Ue,Ze){var nt,rt,dt,gt;return nt=(Le.lowOrder&65535)+(Te.lowOrder&65535)+(Be.lowOrder&65535)+(Ue.lowOrder&65535)+(Ze.lowOrder&65535),rt=(Le.lowOrder>>>16)+(Te.lowOrder>>>16)+(Be.lowOrder>>>16)+(Ue.lowOrder>>>16)+(Ze.lowOrder>>>16)+(nt>>>16),dt=(rt&65535)<<16|nt&65535,nt=(Le.highOrder&65535)+(Te.highOrder&65535)+(Be.highOrder&65535)+(Ue.highOrder&65535)+(Ze.highOrder&65535)+(rt>>>16),rt=(Le.highOrder>>>16)+(Te.highOrder>>>16)+(Be.highOrder>>>16)+(Ue.highOrder>>>16)+(Ze.highOrder>>>16)+(nt>>>16),gt=(rt&65535)<<16|nt&65535,new d(gt,dt)}function ie(Le,Te,Be){return new d(Le.highOrder&Te.highOrder^Le.highOrder&Be.highOrder^Te.highOrder&Be.highOrder,Le.lowOrder&Te.lowOrder^Le.lowOrder&Be.lowOrder^Te.lowOrder&Be.lowOrder)}function Pe(Le,Te,Be){return new d(Le.highOrder&Te.highOrder^~Le.highOrder&Be.highOrder,Le.lowOrder&Te.lowOrder^~Le.lowOrder&Be.lowOrder)}function Ye(Le,Te){return Te<=32?new d(Le.highOrder>>>Te|Le.lowOrder<<32-Te,Le.lowOrder>>>Te|Le.highOrder<<32-Te):new d(Le.lowOrder>>>Te|Le.highOrder<<32-Te,Le.highOrder>>>Te|Le.lowOrder<<32-Te)}function Ve(Le){var Te=Ye(Le,28),Be=Ye(Le,34),Ue=Ye(Le,39);return new d(Te.highOrder^Be.highOrder^Ue.highOrder,Te.lowOrder^Be.lowOrder^Ue.lowOrder)}function He(Le){var Te=Ye(Le,14),Be=Ye(Le,18),Ue=Ye(Le,41);return new d(Te.highOrder^Be.highOrder^Ue.highOrder,Te.lowOrder^Be.lowOrder^Ue.lowOrder)}function ut(Le){var Te=Ye(Le,1),Be=Ye(Le,8),Ue=Ne(Le,7);return new d(Te.highOrder^Be.highOrder^Ue.highOrder,Te.lowOrder^Be.lowOrder^Ue.lowOrder)}function Y(Le){var Te=Ye(Le,19),Be=Ye(Le,61),Ue=Ne(Le,6);return new d(Te.highOrder^Be.highOrder^Ue.highOrder,Te.lowOrder^Be.lowOrder^Ue.lowOrder)}function Ne(Le,Te){return Te<=32?new d(Le.highOrder>>>Te,Le.lowOrder>>>Te|Le.highOrder<<32-Te):new d(0,Le.highOrder<<32-Te)}var qe=se(qe),mt=qe.length*q;qe=ge(qe),qe[mt>>5]|=128<<24-mt%32,qe[(mt+128>>10<<5)+31]=mt;for(var O=0;O<qe.length;O+=32){s=F[0],b=F[1],j=F[2],h=F[3],C=F[4],T=F[5],I=F[6],B=F[7];for(var A=0;A<80;A++)A<16?g[A]=new d(qe[A*2+O],qe[A*2+O+1]):g[A]=Ae(Y(g[A-2]),g[A-7],ut(g[A-15]),g[A-16]),R=je(B,He(C),Pe(C,T,I),_[A],g[A]),Z=be(Ve(s),ie(s,b,j)),B=I,I=T,T=C,C=be(h,R),h=j,j=b,b=s,s=be(R,Z);F[0]=be(s,F[0]),F[1]=be(b,F[1]),F[2]=be(j,F[2]),F[3]=be(h,F[3]),F[4]=be(C,F[4]),F[5]=be(T,F[5]),F[6]=be(I,F[6]),F[7]=be(B,F[7])}for(var tt=[],O=0;O<F.length;O++)tt.push(F[O].highOrder),tt.push(F[O].lowOrder);return ae(tt)}})}},L={};function k(m){var u=L[m];if(u!==void 0)return u.exports;var d=L[m]={exports:{}};return f[m].call(d.exports,d,d.exports,k),d.exports}(function(){k.n=function(m){var u=m&&m.__esModule?function(){return m.default}:function(){return m};return k.d(u,{a:u}),u}})(),function(){k.d=function(m,u){for(var d in u)k.o(u,d)&&!k.o(m,d)&&Object.defineProperty(m,d,{enumerable:!0,get:u[d]})}}(),function(){k.o=function(m,u){return Object.prototype.hasOwnProperty.call(m,u)}}();var W={};(function(){k.d(W,{default:function(){return It}});var m=function(w){document.dictionary||(document.dictionary={});var E=null,a=Object.keys(w);for(E=0;E<a.length;E++)document.dictionary[a[E]]=w[a[E]]},u=function(w){return typeof document<"u"&&document.dictionary&&document.dictionary[w]||w},d={setDictionary:m,translate:u},_=function(w,E){if(E===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(o){return o!==null}),setTimeout(function(){window.jSuitesStateControl.push(w)},0);else{var a=window.jSuitesStateControl.indexOf(w);a>=0&&window.jSuitesStateControl.splice(a,1)}},g={};g.two=function(w){return w=""+w,w.length==1&&(w="0"+w),w},g.focus=function(w){if(w.innerText.length){var E=document.createRange(),a=window.getSelection(),o=w.childNodes[w.childNodes.length-1];E.setStart(o,o.length),E.collapse(!0),a.removeAllRanges(),a.addRange(E),w.scrollLeft=w.scrollWidth}},g.isNumeric=function(w){return typeof w=="string"&&(w=w.trim()),!isNaN(w)&&w!==null&&w!==""},g.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(w){var E=Math.random()*16|0,a=w=="x"?E:E&3|8;return a.toString(16)})},g.getNode=function(){var w=document.getSelection().anchorNode;return w?w.nodeType==3?w.parentNode:w:null},g.hash=function(w){var E=0,a,o;if(w.length===0)return E;for(a=0;a<w.length;a++)o=w.charCodeAt(a),o>32&&(E=(E<<5)-E+o,E|=0);return E},g.randomColor=function(w){var E=-.25,a=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);var o=[],P,ee;for(ee=0;ee<3;ee++)P=parseInt(a.substr(ee*2,2),16),P=Math.round(Math.min(Math.max(0,P+P*E),255)).toString(16),o.push(("00"+P).substr(P.length));return w==!0?"#"+g.two(o[0].toString(16))+g.two(o[1].toString(16))+g.two(o[2].toString(16)):o},g.getWindowWidth=function(){var w=window,E=document,a=E.documentElement,o=E.getElementsByTagName("body")[0],P=w.innerWidth||a.clientWidth||o.clientWidth;return P},g.getWindowHeight=function(){var w=window,E=document,a=E.documentElement,o=E.getElementsByTagName("body")[0],P=w.innerHeight||a.clientHeight||o.clientHeight;return P},g.getPosition=function(w){if(w.changedTouches&&w.changedTouches[0])var E=w.changedTouches[0].pageX,a=w.changedTouches[0].pageY;else var E=window.Event?w.pageX:w.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),a=window.Event?w.pageY:w.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[E,a]},g.click=function(w){if(w.click)w.click();else{var E=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});w.dispatchEvent(E)}},g.findElement=function(w,E){var a=!1;function o(P){P&&!a&&(typeof E=="function"?a=E(P):typeof E=="string"&&P.classList&&P.classList.contains(E)&&(a=P)),P.parentNode&&!a&&o(P.parentNode)}return o(w),a};var s=g;function b(w,E,a){if(w=w.split("."),w.length){let o=this,P=null;for(;w.length>1;)if(P=w.shift(),o.hasOwnProperty(P))o=o[P];else{if(typeof E>"u")return;o[P]={},o=o[P]}if(P=w.shift(),typeof E<"u")return a===!0?delete o[P]:o[P]=E,!0;if(o)return o[P]}return!1}function j(w,E){var a={};a.options={};var o={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},P=null;for(var ee in o)E&&E.hasOwnProperty(ee)?a.options[ee]=E[ee]:a.options[ee]=o[ee];w.classList.add("jsorting"),w.addEventListener("dragstart",function(M){let V=M.target;if(V.nodeType===3)if(V.parentNode.getAttribute("draggable")==="true")V=V.parentNode;else{M.preventDefault(),M.stopPropagation();return}if(V.getAttribute("draggable")==="true"){let G=Array.prototype.indexOf.call(V.parentNode.children,V);P={element:V,o:G,d:G},V.style.opacity="0.25",typeof a.options.ondragstart=="function"&&a.options.ondragstart(w,V,M),M.dataTransfer.setDragImage(V,0,0)}}),w.addEventListener("dragover",function(M){if(M.preventDefault(),P&&te(M.target)&&M.target.getAttribute("draggable")=="true"&&P.element!=M.target){if(a.options.direction)var V=M.target.clientWidth/2>M.offsetX;else var V=M.target.clientHeight/2>M.offsetY;V?M.target.parentNode.insertBefore(P.element,M.target):M.target.parentNode.insertBefore(P.element,M.target.nextSibling),P.d=Array.prototype.indexOf.call(M.target.parentNode.children,P.element)}}),w.addEventListener("dragleave",function(M){M.preventDefault()}),w.addEventListener("dragend",function(M){M.preventDefault(),P&&(typeof a.options.ondragend=="function"&&a.options.ondragend(w,P.element,M),P.o<P.d?M.target.parentNode.insertBefore(P.element,M.target.parentNode.children[P.o]):M.target.parentNode.insertBefore(P.element,M.target.parentNode.children[P.o].nextSibling),P.element.style.opacity="",P=null)}),w.addEventListener("drop",function(M){M.preventDefault(),P&&(P.o!==P.d&&typeof a.options.ondrop=="function"&&a.options.ondrop(w,P.o,P.d,P.element,M.target,M),P.element.style.opacity="",P=null)});for(var te=function(M){var V=!1;function G(oe){oe.className&&oe.classList.contains("jsorting")&&(V=!0),V||G(oe.parentNode)}return G(M),V},S=0;S<w.children.length;S++)w.children[S].hasAttribute("draggable")||w.children[S].setAttribute("draggable","true");return w.val=function(){for(var M=null,V=[],G=0;G<w.children.length;G++)(M=w.children[G].getAttribute("data-id"))&&V.push(M);return V},w}function h(w,E){var a={};(!E.loadUp||typeof E.loadUp!="function")&&(E.loadUp=function(){return!1}),(!E.loadDown||typeof E.loadDown!="function")&&(E.loadDown=function(){return!1}),E.timer||(E.timer=100);var o=null,P=function(ee){if(o==null){var te=!1,S=w.scrollTop;w.scrollTop+w.clientHeight*2>=w.scrollHeight?E.loadDown()&&(S==w.scrollTop&&(w.scrollTop=w.scrollTop-w.clientHeight),te=!0):w.scrollTop<=w.clientHeight&&E.loadUp()&&(S==w.scrollTop&&(w.scrollTop=w.scrollTop+w.clientHeight),te=!0),o=setTimeout(function(){o=null},E.timer),te&&typeof E.onupdate=="function"&&E.onupdate()}};return w.onscroll=function(ee){P()},w.onwheel=function(ee){P()},a}function C(){var w=function(E,a){if(Array.isArray(E)){var o={instance:[],complete:a};if(E.length>0)for(var P=0;P<E.length;P++)E[P].multiple=o,o.instance.push(w(E[P]));return o}if(E.data||(E.data={}),E.type&&(E.method=E.type),E.method||(E.method="GET"),E.dataType||(E.dataType="json"),E.data){var ee=function(oe,pe){var ce=[];if(oe){var fe=Object.keys(oe);if(fe.length)for(var Ee=0;Ee<fe.length;Ee++){if(pe)var Ie=pe+"["+fe[Ee]+"]";else var Ie=fe[Ee];if(oe[Ie]instanceof FileList)ce[Ie]=oe[fe[Ee]];else if(oe[fe[Ee]]===null||oe[fe[Ee]]===void 0)ce[Ie]="";else if(typeof oe[fe[Ee]]=="object")for(var Se=ee(oe[fe[Ee]],Ie),ze=Object.keys(Se),Ge=0;Ge<ze.length;Ge++)ce[ze[Ge]]=Se[ze[Ge]];else ce[Ie]=oe[fe[Ee]]}}return ce},te=ee(E.data),S=Object.keys(te);if(E.method=="GET"){if(S.length){for(var M=[],P=0;P<S.length;P++)M.push(S[P]+"="+encodeURIComponent(te[S[P]]));E.url.indexOf("?")<0&&(E.url+="?"),E.url+=M.join("&")}}else for(var M=new FormData,P=0;P<S.length;P++)if(te[S[P]]instanceof FileList){if(te[S[P]].length)for(var V=0;V<te[S[P]].length;V++)M.append(S[P],te[S[P]][V],te[S[P]][V].name)}else M.append(S[P],te[S[P]])}var G=new XMLHttpRequest;return G.open(E.method,E.url,!0),E.requestedWith?G.setRequestHeader("X-Requested-With",E.requestedWith):E.requestedWith!==!1&&G.setRequestHeader("X-Requested-With","XMLHttpRequest"),E.contentType&&G.setRequestHeader("Content-Type",E.contentType),E.method==="POST"?G.setRequestHeader("Accept","application/json"):E.dataType==="blob"?G.responseType="blob":E.contentType||(E.dataType==="json"?G.setRequestHeader("Content-Type","text/json"):E.dataType==="html"&&G.setRequestHeader("Content-Type","text/html")),E.cache!==!0&&(G.setRequestHeader("pragma","no-cache"),G.setRequestHeader("cache-control","no-cache")),E.withCredentials===!0&&(G.withCredentials=!0),typeof E.beforeSend=="function"&&E.beforeSend(G),typeof w.beforeSend=="function"&&w.beforeSend(G),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(G),G.onerror=function(){E.error&&typeof E.error=="function"&&E.error({message:"Network error: Unable to reach the server.",status:0})},G.ontimeout=function(){E.error&&typeof E.error=="function"&&E.error({message:"Request timed out after "+G.timeout+"ms.",status:0})},G.onload=function(){if(G.status>=200&&G.status<300)if(E.dataType==="json")try{var oe=JSON.parse(G.responseText);E.success&&typeof E.success=="function"&&E.success(oe)}catch(ce){E.error&&typeof E.error=="function"&&E.error(ce,oe)}else{if(E.dataType==="blob")var oe=G.response;else var oe=G.responseText;E.success&&typeof E.success=="function"&&E.success(oe)}else E.error&&typeof E.error=="function"&&E.error(G.responseText,G.status);if(w.queue&&w.queue.length>0&&w.send(w.queue.shift()),w.requests&&w.requests.length){var pe=w.requests.indexOf(G);if(w.requests.splice(pe,1),w.requests.length||E.complete&&typeof E.complete=="function"&&E.complete(oe),E.group&&w.oncomplete&&typeof w.oncomplete[E.group]=="function"&&(w.pending(E.group)||(w.oncomplete[E.group](),w.oncomplete[E.group]=null)),E.multiple&&E.multiple.instance){var pe=E.multiple.instance.indexOf(G);E.multiple.instance.splice(pe,1),E.multiple.instance.length||E.multiple.complete&&typeof E.multiple.complete=="function"&&E.multiple.complete(oe)}}},G.options=E,G.data=M,E.queue===!0&&w.requests.length>0?w.queue.push(G):w.send(G),G};return w.send=function(E){E.data?Array.isArray(E.data)?E.send(E.data.join("&")):E.send(E.data):E.send(),w.requests.push(E)},w.exists=function(E,a){var o=new XMLHttpRequest;o.open("HEAD",E,!1),o.send(),o.status&&a(o.status)},w.pending=function(E){var a=0,o=w.requests;if(o&&o.length)for(var P=0;P<o.length;P++)(!E||E==o[P].options.group)&&a++;return a},w.oncomplete={},w.requests=[],w.queue=[],w}var T=C();function I(){const w={loading:{}};return w.loading.show=function(E){w.loading.element||(w.loading.element=document.createElement("div"),w.loading.element.className="jloading"),document.body.appendChild(w.loading.element),E>0&&setTimeout(function(){w.loading.hide()},E*1e3)},w.loading.hide=function(){w.loading.element&&w.loading.element.parentNode&&document.body.removeChild(w.loading.element)},w.slideLeft=function(E,a,o){a==!0?(E.classList.add("jslide-left-in"),setTimeout(function(){E.classList.remove("jslide-left-in"),typeof o=="function"&&o()},400)):(E.classList.add("jslide-left-out"),setTimeout(function(){E.classList.remove("jslide-left-out"),typeof o=="function"&&o()},400))},w.slideRight=function(E,a,o){a===!0?(E.classList.add("jslide-right-in"),setTimeout(function(){E.classList.remove("jslide-right-in"),typeof o=="function"&&o()},400)):(E.classList.add("jslide-right-out"),setTimeout(function(){E.classList.remove("jslide-right-out"),typeof o=="function"&&o()},400))},w.slideTop=function(E,a,o){a===!0?(E.classList.add("jslide-top-in"),setTimeout(function(){E.classList.remove("jslide-top-in"),typeof o=="function"&&o()},400)):(E.classList.add("jslide-top-out"),setTimeout(function(){E.classList.remove("jslide-top-out"),typeof o=="function"&&o()},400))},w.slideBottom=function(E,a,o){a===!0?(E.classList.add("jslide-bottom-in"),setTimeout(function(){E.classList.remove("jslide-bottom-in"),typeof o=="function"&&o()},400)):(E.classList.add("jslide-bottom-out"),setTimeout(function(){E.classList.remove("jslide-bottom-out"),typeof o=="function"&&o()},100))},w.fadeIn=function(E,a){E.style.display="",E.classList.add("jfade-in"),setTimeout(function(){E.classList.remove("jfade-in"),typeof a=="function"&&a()},2e3)},w.fadeOut=function(E,a){E.classList.add("jfade-out"),setTimeout(function(){E.style.display="none",E.classList.remove("jfade-out"),typeof a=="function"&&a()},1e3)},w}var B=I();function O(){var w={};w.now=function(te,S){var M=null,V=null,G=null,oe=null,pe=null,ce=null;return Array.isArray(te)?(M=te[0],V=te[1],G=te[2],oe=te[3],pe=te[4],ce=te[5]):(te||(te=new Date),M=te.getFullYear(),V=te.getMonth()+1,G=te.getDate(),oe=te.getHours(),pe=te.getMinutes(),ce=te.getSeconds()),S==!0?s.two(M)+"-"+s.two(V)+"-"+s.two(G):s.two(M)+"-"+s.two(V)+"-"+s.two(G)+" "+s.two(oe)+":"+s.two(pe)+":"+s.two(ce)},w.toArray=function(te){var M=te.split(te.indexOf("T")!==-1?"T":" "),S=M[1],M=M[0].split("-"),V=parseInt(M[0]),G=parseInt(M[1]),oe=parseInt(M[2]),pe=0,ce=0;return S&&(S=S.split(":"),pe=parseInt(S[0]),ce=parseInt(S[1])),[V,G,oe,pe,ce,0]};var E=Date.UTC(1900,0,0),a=Date.UTC(1900,1,29),o=864e5;w.dateToNum=function(te){typeof te=="string"&&(te=new Date(te+"  GMT+0"));var S=te.getTime();return S>=a&&(S+=o),S-=E,S/o},w.numToDate=function(te){var S=E+te*o;S>=a&&(S-=o);const M=new Date(S);var V=[M.getUTCFullYear(),M.getUTCMonth()+1,M.getUTCDate(),M.getUTCHours(),M.getUTCMinutes(),M.getUTCSeconds()];return w.now(V)};let P=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ee=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(w,"weekdays",{get:function(){return P.map(function(te){return d.translate(te)})}}),Object.defineProperty(w,"weekdaysShort",{get:function(){return P.map(function(te){return d.translate(te).substring(0,3)})}}),Object.defineProperty(w,"months",{get:function(){return ee.map(function(te){return d.translate(te)})}}),Object.defineProperty(w,"monthsShort",{get:function(){return ee.map(function(te){return d.translate(te).substring(0,3)})}}),w}var A=O();function R(){var w={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},E=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var v=0;this.date[4]&&(v=parseFloat(this.date[4]/60));var D=parseInt(this.date[3])+v;D/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?D=s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),D=s.two(this.date[0])+"-"+s.two(this.date[1])+"-"+s.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(D+=" "+s.two(this.date[3])+":"+s.two(this.date[4])+":"+s.two(this.date[5])));return D},a=function(){var v="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)v=parseInt(this.date[3]);else{let X=parseInt(this.date[3]);X<13&&this.values.indexOf("PM")!==-1?v=(X+12)%24:v=X%24}this.date[4]&&(v+=parseFloat(this.date[4]/60)),this.date[5]&&(v+=parseFloat(this.date[5]/3600)),v/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var D=A.now(this.date);v=A.dateToNum(D)}return isNaN(v)&&(v=""),v},o=function(v){return v===null||v===""||v===void 0},P=function(v){var D=(""+v)[0];return D=="="},ee=function(v){return v==="currency"||v==="percentage"||v==="scientific"||v==="numeric"},te=function(v){if(v&&Number(v)==v)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var D=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=D[1]}else{v||(v=this.mask);var X=new RegExp("0{1}(.{1})0+","ig"),D=X.exec(v);if(D&&D[1]&&D[1].length==1)return this.options.decimal=D[1],D[1];var X=new RegExp("#{1}(.{1})#+","ig"),D=X.exec(v);D&&D[1]&&D[1].length==1?D[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},S=function(v,D){if(v=="")return"";D||(D=te.call(this)),v=(""+v).split(D);var X=v[0].match(/[-]+/g);if(X&&X.length?X=!0:X=!1,v[0]=v[0].match(/[0-9]+/g),v[0]?(X&&v[0].unshift("-"),v[0]=v[0].join("")):X&&(v[0]="-"),v[0]||v[1])v[1]!==void 0&&(v[1]=v[1].match(/[0-9]+/g),v[1]?v[1]=v[1].join(""):v[1]="");else return"";return v},M=function(v,D){if(v==="")return"";var X=te.call(this),ue=this.options;if(v=S.call(this,v),v==="")return"";var K=null;if(v[0]&&(ue.style==="percent"?K=parseFloat(v[0])/100:K=parseFloat(v[0]+".1")),(v[0]==="-"||v[0]==="-00")&&!v[1]&&D&&D.inputType=="deleteContentBackward")return"";var le=new Intl.NumberFormat(this.locale,ue).format(K);if(le=le.split(X),ue.style==="percent"&&le[0].indexOf("%")!==-1&&(le[0]=le[0].replace("%",""),le[2]="%"),typeof le[1]<"u"){var me=le[1].replace(/[0-9]*/g,"");me&&(le[2]=me)}return v[1]!==void 0?le[1]=X+v[1]:le[1]="",le.join("")},V=function(v,D){var X=pe.call(v);if(X){var ue=M.call(this,X,D),K=ue.length-X.length,le=oe.call(v)+K;pe.call(v,ue,le,!0)}},G=function(v){var D=S.call(this,v);return D?(D[0]==="-"&&(D[0]="-0"),parseFloat(D.join("."))):null},oe=function(v,D){if(v===void 0)if(this.tagName=="DIV"){var X=0,ue=window.getSelection();if(ue&&ue.rangeCount!==0){var K=ue.getRangeAt(0),le=K.cloneRange();le.selectNodeContents(this),le.setEnd(K.endContainer,K.endOffset),X=le.toString().length}return X}else return this.selectionStart;else{var me=pe.call(this);if(D){for(var le=null,Me=0;Me<me.length;Me++)(me[Me].match(/[\-0-9]/g)||me[Me]==="."||me[Me]===",")&&(le=Me);le===null&&(le=me.indexOf(" ")),v>=le&&(v=le+1)}if(v>me.length&&(v=me.length),v)if(this.tagName=="DIV"){var ue=window.getSelection(),K=document.createRange();this.childNodes[0]&&(K.setStart(this.childNodes[0],v),ue.removeAllRanges(),ue.addRange(K))}else this.selectionStart=v,this.selectionEnd=v}},pe=function(v,D,X){if(this.tagName=="DIV")if(v===void 0){var v=this.innerText;return this.value&&this.value.length>v.length&&(v=this.value),v}else this.innerText!==v&&(this.innerText=v,D&&oe.call(this,D,X));else{if(v===void 0)return this.value;this.value!==v&&(this.value=v,D&&oe.call(this,D,X))}},ce=A.weekdays,fe=A.weekdaysShort,Ee=A.months,Ie=A.monthsShort,Se={YEAR:function(v,D){var X=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<=10&&this.values[this.index].length<D&&(this.values[this.index]+=v),this.values[this.index].length==D){if(D==2)var X=X.substr(0,2)+this.values[this.index];else if(D==3)var X=X.substr(0,1)+this.values[this.index];else if(D==4)var X=this.values[this.index];this.date[0]=X,this.index++}},YYYY:function(v){Se.YEAR.call(this,v,4)},YYY:function(v){Se.YEAR.call(this,v,3)},YY:function(v){Se.YEAR.call(this,v,2)},FIND:function(v,D){if(o(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=v;return}for(var X=0,ue=0,K=(this.values[this.index]+v).toLowerCase(),le=0;le<D.length;le++)D[le].toLowerCase().indexOf(K)==0&&(X=le,ue++);if(ue>1)this.values[this.index]+=v;else if(ue==1){var me=D[X].length-this.values[this.index].length-1;return this.position+=me,this.values[this.index]=D[X],this.index++,X}},MMM:function(v){var D=Se.FIND.call(this,v,Ie);D!==void 0&&(this.date[1]=D+1)},MON:function(v){Se.MMM.call(this,v)},MMMM:function(v){var D=Se.FIND.call(this,v,Ee);D!==void 0&&(this.date[1]=D+1)},MONTH:function(v){Se.MMMM.call(this,v)},MMMMM:function(v){o(this.values[this.index])&&(this.values[this.index]="");for(var D=(this.values[this.index]+v).toLowerCase(),X=0;X<Ee.length;X++)if(Ee[X][0].toLowerCase().indexOf(D)==0){this.values[this.index]=Ee[X][0],this.date[1]=X+1,this.index++;break}},MM:function(v){o(this.values[this.index])?parseInt(v)>1&&parseInt(v)<10?(this.date[1]=this.values[this.index]="0"+v,this.index++):parseInt(v)<2&&(this.values[this.index]=v):this.values[this.index]==1&&parseInt(v)<3?(this.date[1]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[1]=this.values[this.index]+=v,this.index++)},M:function(v){var D=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(o(this.values[this.index]))this.values[this.index]=v,v>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(v)<3)this.date[1]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[1]=this.values[this.index]+=v,this.index++;else var D=!0;else var D=!0;if(D==!0){var X=parseInt(this.values[this.index]);X>0&&X<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(v){var D=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(o(this.values[this.index]))this.values[this.index]=v,parseInt(v)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(v)<2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[2]=this.values[this.index]+=v,this.index++;else var D=!0;else var D=!0;if(D==!0){var X=parseInt(this.values[this.index]);X>0&&X<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(v){o(this.values[this.index])?parseInt(v)>3&&parseInt(v)<10?(this.date[2]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==3&&parseInt(v)<2?(this.date[2]=this.values[this.index]+=v,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(v)<10?(this.date[2]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[2]=this.values[this.index]+=v,this.index++)},DDD:function(v){Se.FIND.call(this,v,fe)},DY:function(v){Se.DDD.call(this,v)},DDDD:function(v){Se.FIND.call(this,v,ce)},DAY:function(v){Se.DDDD.call(this,v)},HH12:function(v,D){o(this.values[this.index])?parseInt(v)>1&&parseInt(v)<10?(D&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==1&&parseInt(v)<3?(this.date[3]=this.values[this.index]+=v,this.index++):this.values[this.index]<1&&parseInt(v)<10&&(this.date[3]=this.values[this.index]+=v,this.index++)},HH24:function(v,D){parseInt(v)>=0&&parseInt(v)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(v)>2&&parseInt(v)<10?(D&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==2&&parseInt(v)<4?(!D&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++):this.values[this.index]<2&&parseInt(v)<10&&(!D&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++))},HH:function(v){Se.HH24.call(this,v,1)},H:function(v){Se.HH24.call(this,v,0)},"\\[H\\]":function(v){this.values[this.index]==null&&(this.values[this.index]=""),v.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=v:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(v,D){this.values[this.index]==null||this.values[this.index]==""?parseInt(v)>5&&parseInt(v)<10?(this.date[D]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):parseInt(v)<10&&(this.date[D]=this.values[this.index]+=v,this.index++)},MI:function(v){Se.N60.call(this,v,4)},SS:function(v){Se.N60.call(this,v,5)},"AM/PM":function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?v.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":v.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<7&&(this.values[this.index]=v),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(v){var D=te.call(this),X=!1;o(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(X=!0);var ue=S.call(this,this.values[this.index],D);ue&&(this.values[this.index]=ue.join(D)),parseInt(v)>=0&&parseInt(v)<10?(this.values[this.index]=="0"&&v>0?this.values[this.index]="":this.values[this.index]=="-0"&&v>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||v==D)&&(this.values[this.index]+=v)):D&&v==D?this.values[this.index].indexOf(D)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=v):v=="-"&&(X=!0),X===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(v){Se["0{1}(.{1}0+)?"].call(this,v)},"0{1}(.{1}0+)?%":function(v){Se["0{1}(.{1}0+)?"].call(this,v),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(v){Se["0{1}(.{1}0+)?"].call(this,v);var D=te.call(this),X=this.tokens[this.index].substr(1,1),ue=this.values[this.index][0]==="-",K=S.call(this,this.values[this.index],D);if(K!==""){var le=K[0].match(/[0-9]/g);if(le){le=le.join("");for(var me=[],Me=0,xe=le.length-1;xe>=0;xe--)me.push(le[xe]),Me++,Me%3||me.push(X);me=me.reverse(),K[0]=me.join(""),K[0].substr(0,1)==X&&(K[0]=K[0].substr(1))}else K[0]="";this.values[this.index]=K.join(D),ue&&(this.values[this.index]="-"+this.values[this.index])}},0:function(v){v.match(/[0-9]/g)&&(this.values[this.index]=v,this.index++)},"[0-9a-zA-Z$]+":function(v){o(this.values[this.index])&&(this.values[this.index]="");var D=this.tokens[this.index],X=this.values[this.index],ue=X.length;D[ue]==v?(this.values[this.index]+=v,this.values[this.index]==D&&this.index++):(this.values[this.index]=D,this.index++,v.match(/[\-0-9]/g)&&this.position--)},A:function(v){v.match(/[a-zA-Z]/gi)&&(this.values[this.index]=v,this.index++)},".":function(v){Se["[0-9a-zA-Z$]+"].call(this,v)},"@":function(v){o(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=v}},ze=function(v){if(this.type=="general")var D=[].concat(w.general);else var D=[].concat(w.currency,w.datetime,w.percentage,w.scientific,w.numeric,w.text,w.general);var X=new RegExp(D.join("|"),"gi");return v.match(X)},Ge=function(v){if(this.type)if(this.type=="text")var D=["text"];else if(this.type=="general")var D=["general"];else if(this.type=="datetime")var D=["numeric","datetime","general"];else var D=["currency","percentage","scientific","numeric","general"];else var D=Object.keys(w);for(var X=0;X<D.length;X++)for(var ue=D[X],K=0;K<w[ue].length;K++){var le=new RegExp(w[ue][K],"gi"),me=v.match(le);if(me)return{type:ue,method:w[ue][K]}}},Q=function(v){for(var D=[],X=0;X<v.length;X++){var ue=Ge.call(this,v[X]);ue?D.push(ue.method):D.push(null)}for(var X=0;X<D.length;X++)D[X]=="MM"&&(D[X-1]&&D[X-1].indexOf("H")>=0||D[X-2]&&D[X-2].indexOf("H")>=0||D[X+1]&&D[X+1].indexOf("S")>=0||D[X+2]&&D[X+2].indexOf("S")>=0)&&(D[X]="MI");return D},he=function(v){var D=Ge.call(this,v);if(D)var X=D.type;if(X){for(var ue=0,K=ze.call(this,v),le=0;le<K.length;le++)D=Ge.call(this,K[le]),D&&ee(D.type)&&ue++;ue>1&&(X="general")}return X},we=function(){typeof Se[this.methods[this.index]]=="function"?(Se[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},U=function(v){return(""+ +v).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(D,X,ue,K,le){return le<0?X+"0."+Array(1-le-ue.length).join(0)+ue+K:X+ue+K+Array(le-K.length+1).join(0)})},J=function(v,D,X){var ue=null,K={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof v=="object"){if(K.input=v.target,K.value=pe.call(v.target),K.caret=oe.call(v.target),(ue=v.target.getAttribute("data-mask"))&&(K.mask=ue),(ue=v.target.getAttribute("data-type"))&&(K.type=ue),v.target.mask?(v.target.mask.options&&(K.options=v.target.mask.options),v.target.mask.locale&&(K.locale=v.target.mask.locale)):(ue=v.target.getAttribute("data-locale"))&&(K.locale=ue,K.mask&&(K.options.style=K.mask)),v.target.attributes&&v.target.attributes.length)for(var le=0;le<v.target.attributes.length;le++){var me=v.target.attributes[le].name,Me=v.target.attributes[le].value;me.substr(0,4)=="data"&&(K.options[me.substr(5)]=Me)}}else{if(typeof D=="string")K.mask=D;else for(var me=Object.keys(D),le=0;le<me.length;le++)K[me[le]]=D[me[le]];typeof v=="number"&&(te.call(K,K.mask),v=(""+v).replace(".",K.options.decimal)),K.value=v,K.input&&(pe.call(K.input,v),s.focus(K.input),K.caret=oe.call(K.input))}if(!P(K.value)&&(K.mask||K.locale)){if(K.mask){if(K.mask=K.mask.replace(new RegExp(/\[h]/),"|h|"),K.mask=K.mask.replace(new RegExp(/\[.*?\]/),""),K.mask=K.mask.replace(new RegExp(/\|h\|/),"[h]"),K.mask.indexOf(";")!==-1){var ue=K.mask.split(";");K.mask=ue[0]}if(K.mask.indexOf("##")!==-1){var xe=K.mask.split(";");xe[0]&&(typeof v=="object"&&(xe[0]=xe[0].replace(new RegExp(/_\)/g),""),xe[0]=xe[0].replace(new RegExp(/_\(/g),"")),xe[0]=xe[0].replace("*","	"),xe[0]=xe[0].replace(new RegExp(/_-/g),""),xe[0]=xe[0].replace(new RegExp(/_/g),""),xe[0]=xe[0].replace(new RegExp(/"/g),""),xe[0]=xe[0].replace("##0.###","##0.000"),xe[0]=xe[0].replace("##0.##","##0.00"),xe[0]=xe[0].replace("##0.#","##0.0"),xe[0]=xe[0].replace("##0,###","##0,000"),xe[0]=xe[0].replace("##0,##","##0,00"),xe[0]=xe[0].replace("##0,#","##0,0")),K.mask=xe[0]}if(K.mask.indexOf("\\")!==-1){var xe=K.mask.split(";");xe[0]=xe[0].replace(new RegExp(/\\/g),""),K.mask=xe[0]}K.type||(K.type=he.call(K,K.mask)),K.tokens=ze.call(K,K.mask)}if(typeof v!="object"||!v.inputType||!v.inputType.indexOf("insert")||!v.inputType.indexOf("delete"))if(K.locale)if(K.input)V.call(K,K.input,v);else var De=M.call(K,K.value);else{for(K.methods=Q.call(K,K.tokens),K.event=v;K.position<K.value.length&&typeof K.tokens[K.index]<"u";)we.call(K);var De=K.values.join("");if(ee(K.type)&&De!==""){for(;typeof K.tokens[K.index]<"u";){var ue=Ge.call(K,K.tokens[K.index]);ue&&ue.type=="general"&&(K.values[K.index]=K.tokens[K.index]),K.index++}var Fe=!0}else var Fe=!1;if(De=K.values.join(""),K.input){if(ue=De.length-K.value.length,ue>0)var $e=K.caret+ue;else var $e=K.caret;pe.call(K.input,De,$e,Fe)}}if(K.input){var ne=null;if(ee(K.type)){let ve=pe.call(K.input);K.number=G.call(K,ve),K.type=="percentage"&&(""+ve).indexOf("%")!==-1?ne=J.adjustPrecision(K.number/100):ne=K.number}else K.type=="datetime"&&(ne=E.call(K),K.date[0]&&K.date[1]&&K.date[2]&&K.input.setAttribute("data-completed",!0));ne&&K.input.setAttribute("data-value",ne)}if(De!==void 0)return X?K:De}};return J.adjustPrecision=function(v){if(typeof v=="number"&&!Number.isInteger(v)){const D=v.toString().split(".");if(D[1]&&D[1].length>10){let X=0;const ue=D[1][D[1].length-2];if(ue==0||ue==9){for(let K=D[1].length-2;K>0;K--)if(X>=0&&D[1][K]==ue){if(X++,X>6)break}else{X=0;break}if(X)return parseFloat(parseFloat(v).toFixed(D[1].length-1))}}}return v},J.getType=he,J.prepare=function(v,D){return D||(D={}),ze.call(D,v)},J.apply=function(v){var D=pe.call(v.target);v.key.length==1&&(D+=v.key),pe.call(v.target,J(D,v.target.getAttribute("data-mask")))},J.run=function(v,D,X){return J(v,{mask:D,decimal:X})},J.extract=function(v,D,X){if(o(v)||typeof D!="object")return v;if(D=Object.assign({},D),D.options||(D.options={}),!D.mask&&D.format&&(D.mask=D.format),D.mask){if(D.mask.indexOf(";")!==-1){var ue=D.mask.split(";");D.mask=ue[0]}D.mask=D.mask.replace(new RegExp(/\[h]/),"|h|"),D.mask=D.mask.replace(new RegExp(/\[.*?\]/),""),D.mask=D.mask.replace(new RegExp(/\|h\|/),"[h]")}te.call(D,D.mask);var K=null,le=null;if(D.type=="percent"||D.options.style=="percent"?K="percentage":D.mask&&(K=he.call(D,D.mask)),K==="text"){var me={};le=v}else if(K==="general"){var me=J(v,D,!0);le=v}else if(K==="datetime"){v instanceof Date&&(v=J.getDateString(v,D.mask));var me=J(v,D,!0);s.isNumeric(v)?le=v:le=a.call(me)}else if(K==="scientific"){le=v,typeof v=="string"&&(le=Number(le));var me=D}else{le=G.call(D,v),K==="percentage"&&(""+v).indexOf("%")!==-1&&(le/=100);var me=D}return me.value=le,!me.type&&K&&(me.type=K),X?me:le},J.render=function(v,D,X,ue){if(o(v)||typeof D!="object")return v;if(D=Object.assign({},D),D.options||(D.options={}),!D.mask&&D.format&&(D.mask=D.format),D.mask){if(D.mask.indexOf(";")!==-1){var K=D.mask.split(";");X||(K[0]=K[0].replace(new RegExp(/_\)/g),""),K[0]=K[0].replace(new RegExp(/_\(/g),"")),D.mask=K[0]}D.mask=D.mask.replace(new RegExp(/\[h]/),"|h|"),D.mask=D.mask.replace(new RegExp(/\[.*?\]/),""),D.mask=D.mask.replace(new RegExp(/\|h\|/),"[h]")}var le=null;D.type=="percent"||D.options.style=="percent"?le="percentage":D.mask?le=he.call(D,D.mask):v instanceof Date&&(le="datetime");var me=!1;if(le=="datetime"||D.type=="calendar"){var K=J.getDateString(v,D.mask);K&&(v=K),D.mask&&X&&(me=!0)}else if(le==="text")typeof v=="number"&&(v=v.toString());else if(typeof v=="string"&&c.isNumeric(v)&&(v=Number(v)),le==="percentage"&&(v=J.adjustPrecision(v*100)),typeof v=="number"){var K=null;if(D.mask&&X){var Me=te.call(D,D.mask);if(le==="scientific")if(D.mask.indexOf(Me)!==-1){let ye=D.mask.split("E");ye=ye[0].split(Me),ye=""+ye[1].match(/[0-9]+/g),ye=ye.length,K=v.toExponential(ye)}else K=v.toExponential(0);else{if(D.mask.indexOf(Me)!==-1){Me=D.mask.split(Me),Me=""+Me[1].match(/[0-9]+/g),Me=Me.length,K=v.toFixed(Me);let ye=v.toString().split("."),ke=ye[1];ke&&ke.length>Me&&ke[ke.length-1]==="5"&&(K=parseFloat(ye[0]+"."+ke+"1").toFixed(Me))}else K=v.toFixed(0);(""+K).indexOf("e")!==-1&&(K=U(K))}}else if(D.locale&&X){var Me=(""+v).split(".");if(D.options){typeof Me[1]>"u"&&(Me[1]="");var De=Me[1].length;if(D.options.minimumFractionDigits>De)for(var xe=0;xe<D.options.minimumFractionDigits-De;xe++)Me[1]+="0"}Me[1].length?K=Me.join("."):K=Me[0];var De=Me[1].length;D.options&&D.options.maximumFractionDigits<De&&(K=parseFloat(K).toFixed(D.options.maximumFractionDigits))}else K=U(v);K!==null&&(v=K,te.call(D,D.mask),D.options.decimal&&(v=v.replace(".",D.options.decimal)))}else D.mask&&X&&(me=!0);if(me){var Fe=D.mask.length-v.length;if(Fe>0)for(var xe=0;xe<Fe;xe++)v+=" "}if(le==="scientific")if(!X)v=U(v);else return v;if(le==="numeric"&&ue===!1&&typeof v=="string")return v;if(v=J(v,D),X&&le==="numeric"){var $e=D.mask.match(new RegExp(/^[0]+$/gm));if($e&&$e.length===1){var ne=$e[0].length;if(ne>3)for(v=""+v;v.length<ne;)v="0"+v}}return v},J.set=function(v,D){if(D){v.setAttribute("data-mask",D);var X=new Event("input",{bubbles:!0,cancelable:!0});v.dispatchEvent(X)}},J.extractDateFromString=function(v,D){var X=J(v,{mask:D},!0);if(v>0&&Number(v)==v&&(X.values.join("")!==X.value||X.type=="numeric")){var ue=new Date(Math.round((v-25569)*86400*1e3));return ue.getFullYear()+"-"+s.two(ue.getMonth())+"-"+s.two(ue.getDate())+" 00:00:00"}var K=!1;return X.values&&X.values.length===X.tokens.length&&X.values[X.values.length-1].length>=X.tokens[X.tokens.length-1].length&&(K=!0),X.date[0]&&X.date[1]&&(X.date[2]||K)?(X.date[2]||(X.date[2]=1),X.date[0]+"-"+s.two(X.date[1])+"-"+s.two(X.date[2])+" "+s.two(X.date[3])+":"+s.two(X.date[4])+":"+s.two(X.date[5])):""},J.getDateString=function(v,D){if(!D)var D={};if(D&&typeof D=="object"){if(D.format)var X=D.format;else if(D.mask)var X=D.mask}else var X=D;if(X||(X="YYYY-MM-DD"),X.indexOf("[h]")>=0){var ue=0;if(v&&s.isNumeric(v)&&(ue=parseFloat(24*Number(v)),X.indexOf("mm")>=0)){var K=(""+ue).split(".");if(K[1]){var le=60*parseFloat("0."+K[1]);le=parseFloat(le.toFixed(2))}else var le=0;ue=parseInt(K[0])+":"+s.two(le)}return ue}v instanceof Date?v=A.now(v):v&&s.isNumeric(v)&&(v=A.numToDate(v));for(var me=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Me=new RegExp(me.join("|"),"gi"),xe=X.match(Me),De=0;De<xe.length;De++)xe[De].toUpperCase()=="MM"&&(xe[De-1]&&xe[De-1].toUpperCase().indexOf("H")>=0||xe[De-2]&&xe[De-2].toUpperCase().indexOf("H")>=0||xe[De+1]&&xe[De+1].toUpperCase().indexOf("S")>=0||xe[De+2]&&xe[De+2].toUpperCase().indexOf("S")>=0)&&(xe[De]="mi");var Fe={tokens:xe};if(v){var le=""+v,$e=le.indexOf("T")!==-1?"T":" ";le=le.split($e);var K=0,ne=0,ve=0;le[1]&&(K=le[1].split(":"),ne=K[1]?K[1]:0,ve=K[2]?K[2]:0,K=K[0]?K[0]:0),le=le[0].split("-");let lt=new Date(le[0],le[1],0).getDate();if(le[0]&&le[1]&&le[2]&&le[0]>0&&le[1]>0&&le[1]<13&&le[2]>0&&le[2]<=lt){Fe.data=[le[0],le[1],le[2],K,ne,ve],Fe.value=[];for(var ye=new Date(Fe.data[0],Fe.data[1]-1,Fe.data[2],Fe.data[3],Fe.data[4],Fe.data[5]),ke=function(ft){var Qe=this.tokens[ft],at=Qe.toUpperCase(),Je=null;at==="YYYY"?Je=this.data[0]:at==="YYY"?Je=this.data[0].substring(1,4):at==="YY"?Je=this.data[0].substring(2,4):at==="Y"?Je=this.data[0].substring(3,4):Qe==="MON"?Je=A.months[ye.getMonth()].substr(0,3).toUpperCase():Qe==="mon"?Je=A.months[ye.getMonth()].substr(0,3).toLowerCase():Qe==="MONTH"?Je=A.months[ye.getMonth()].toUpperCase():Qe==="month"?Je=A.months[ye.getMonth()].toLowerCase():at==="MMMMM"?Je=A.months[ye.getMonth()].substr(0,1):at==="MMMM"||Qe==="Month"?Je=A.months[ye.getMonth()]:at==="MMM"||Qe=="Mon"?Je=A.months[ye.getMonth()].substr(0,3):at==="MM"?Je=s.two(this.data[1]):at==="M"?Je=ye.getMonth()+1:Qe==="DAY"?Je=A.weekdays[ye.getDay()].toUpperCase():Qe==="day"?Je=A.weekdays[ye.getDay()].toLowerCase():at==="DDDD"||Qe=="Day"?Je=A.weekdays[ye.getDay()]:at==="DDD"?Je=A.weekdays[ye.getDay()].substr(0,3):at==="DD"?Je=s.two(this.data[2]):at==="D"?Je=parseInt(this.data[2]):at==="Q"?Je=Math.floor((ye.getMonth()+3)/3):at==="HH24"||at==="HH"?(Je=this.data[3],Je>12&&this.tokens.indexOf("am/pm")!==-1&&(Je-=12),Je=s.two(Je)):at==="HH12"?this.data[3]>12?Je=s.two(this.data[3]-12):Je=s.two(this.data[3]):at==="H"?(Je=this.data[3],Je>12&&this.tokens.indexOf("am/pm")!==-1&&(Je-=12,Je=s.two(Je))):at==="MI"?Je=s.two(this.data[4]):at==="SS"?Je=s.two(this.data[5]):at==="MS"?Je=ye.getMilliseconds():at==="AM/PM"?this.data[3]>=12?Je="PM":Je="AM":at==="WD"&&(Je=A.weekdays[ye.getDay()]),Je===null?this.value[ft]=this.tokens[ft]:this.value[ft]=Je},De=0;De<Fe.tokens.length;De++)ke.call(Fe,De);v=Fe.value.join("")}else v=""}return v},J}var Z=R();function q(){var w=function(E,a){if(E.calendar)return E.calendar.setOptions(a,!0);var o={type:"calendar"};o.options={},o.date=null,o.setOptions=function(U,J){var v={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:A.monthsShort,monthsFull:A.months,weekdays:A.weekdays,textDone:d.translate("Done"),textReset:d.translate("Reset"),textUpdate:d.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var D in v)U&&U.hasOwnProperty(D)?o.options[D]=U[D]:(typeof o.options[D]>"u"||J===!0)&&(o.options[D]=v[D]);if(o.options.resetButton==!1?M.style.display="none":M.style.display="",o.options.readonly?E.setAttribute("readonly","readonly"):E.removeAttribute("readonly"),o.options.placeholder?E.setAttribute("placeholder",o.options.placeholder):E.removeAttribute("placeholder"),s.isNumeric(o.options.value)&&o.options.value>0&&(o.options.value=w.numToDate(o.options.value),o.options.dataType="numeric"),M.innerHTML=o.options.textReset,V.innerHTML=o.options.textDone,Ge.innerHTML=o.options.textUpdate,o.options.format&&E.setAttribute("data-mask",o.options.format.toLowerCase()),!o.options.value&&o.options.today)var X=w.now();else var X=o.options.value;return X&&(o.options.value=null,o.setValue(X)),o},o.open=function(U){if(!S.classList.contains("jcalendar-focus")&&!S.classList.contains("jcalendar-inline")){if(w.current=o,_(o,!0),o.getDays(),o.options.type=="year-month-picker"&&o.getMonths(),o.options.time&&(Q.value=o.date[3],he.value=o.date[4]),S.classList.add("jcalendar-focus"),s.getWindowWidth()<800||o.options.fullscreen)S.classList.add("jcalendar-fullsize"),B.slideBottom(oe,1);else{S.classList.remove("jcalendar-fullsize");var J=E.getBoundingClientRect(),v=oe.getBoundingClientRect();if(o.options.position)G.style.position="fixed",window.innerHeight<J.bottom+v.height?G.style.top=J.top-(v.height+2)+"px":G.style.top=J.top+J.height+2+"px",G.style.left=J.left+"px";else{if(window.innerHeight<J.bottom+v.height){var D=-1*(J.height+v.height+2);D+J.top<0&&(D=-1*(J.top+J.height)),G.style.top=D+"px"}else G.style.top=2+"px";if(window.innerWidth<J.left+v.width){var D=window.innerWidth-(J.left+v.width+20);G.style.left=D+"px"}else G.style.left="0px"}}typeof o.options.onopen=="function"&&o.options.onopen(E)}},o.close=function(U,J){if(o.options.autoSelect!==!0&&typeof J>"u"&&(J=!1),S.classList.contains("jcalendar-focus")){if(J!==!1){var v=S.querySelector(".jcalendar-selected");if(typeof J=="string")var D=J;else if(!v||v.classList.contains("jcalendar-disabled"))var D=o.options.value;else var D=o.getValue();o.setValue(D)}else{let X=o.options.value||"";o.options.value=null,o.setValue(X)}!U&&typeof o.options.onclose=="function"&&o.options.onclose(E),S.classList.remove("jcalendar-focus"),_(o,!1),w.current=null}return o.options.value},o.prev=function(){o.options.mode=="years"?(o.date[0]=o.date[0]-12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])-1,o.getMonths()):(o.date[1]<2?(o.date[0]=o.date[0]-1,o.date[1]=12):o.date[1]=o.date[1]-1,o.getDays())},o.next=function(){o.options.mode=="years"?(o.date[0]=parseInt(o.date[0])+12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])+1,o.getMonths()):(o.date[1]>11?(o.date[0]=parseInt(o.date[0])+1,o.date[1]=1):o.date[1]=parseInt(o.date[1])+1,o.getDays())},o.setToday=function(){var U=new Date().toISOString().substr(0,10);return o.setValue(U),U},o.setValue=function(U){U||(U=""+U);var J=U,v=o.options.value;if(v!=J){if(J){o.setLabel(J,o.options);var X=J.split(" ");X[1]||(X[1]="00:00:00");var D=X[1].split(":"),X=X[0].split("-"),ue=parseInt(X[0]),K=parseInt(X[1]),le=parseInt(X[2]),me=parseInt(D[0]),Me=parseInt(D[1]);o.date=[ue,K,le,me,Me,0];var U=o.setLabel(J,o.options),xe=w.now(new Date(ue,K-1,le),!0);if(o.options.validRange){if(!o.options.validRange[0]||xe>=o.options.validRange[0])var De=!0;else var De=!1;if(!o.options.validRange[1]||xe<=o.options.validRange[1])var Fe=!0;else var Fe=!1;De&&Fe?(E.classList.remove("jcalendar_warning"),E.title=""):(E.classList.add("jcalendar_warning"),E.title=d.translate("Date outside the valid range"))}else E.classList.remove("jcalendar_warning"),E.title=""}else{o.date=null;var U="";E.classList.remove("jcalendar_warning"),E.title=""}o.options.value=J,typeof o.options.onchange=="function"&&o.options.onchange(E,J,v),E.value!=U&&(E.value=U,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))}o.date&&(o.getDays(),o.options.type=="year-month-picker"&&o.getMonths())},o.getValue=function(){return o.date?o.options.time?s.two(o.date[0])+"-"+s.two(o.date[1])+"-"+s.two(o.date[2])+" "+s.two(o.date[3])+":"+s.two(o.date[4])+":"+s.two(0):s.two(o.date[0])+"-"+s.two(o.date[1])+"-"+s.two(o.date[2])+" "+s.two(0)+":"+s.two(0)+":"+s.two(0):""},o.update=function(U,J){if(!U.classList.contains("jcalendar-disabled")){var v=S.querySelector(".jcalendar-selected");v&&v.classList.remove("jcalendar-selected"),U.classList.add("jcalendar-selected"),U.classList.contains("jcalendar-set-month")?(o.date[1]=J,o.date[2]=1):o.date[2]=U.innerText,o.options.time?(o.date[3]=Q.value,o.date[4]=he.value):o.close(null,!0)}te()},o.reset=function(){o.setValue(""),o.date=null,o.close(!1,!1)},o.getDays=function(){o.options.mode="days";var me=new Date,U=o.date&&s.isNumeric(o.date[0])?o.date[0]:parseInt(me.getFullYear()),J=o.date&&s.isNumeric(o.date[1])?o.date[1]:parseInt(me.getMonth())+1,v=o.date&&s.isNumeric(o.date[2])?o.date[2]:parseInt(me.getDate()),D=o.date&&s.isNumeric(o.date[3])?o.date[3]:parseInt(me.getHours()),X=o.date&&s.isNumeric(o.date[4])?o.date[4]:parseInt(me.getMinutes());o.date=[U,J,v,D,X,0],pe.innerHTML=U,ce.innerHTML=o.options.months[J-1];var ue=me.getMonth()==J-1&&me.getFullYear()==U,K=me.getDate(),me=new Date(U,J,0,0,0),le=me.getDate(),me=new Date(U,J-1,0,0,0),Me=me.getDay()+1,$e=o.options.startingDay||0;Me=Me-$e,Ee.innerHTML="";var xe=document.createElement("tr");xe.setAttribute("align","center"),Ee.appendChild(xe);for(var De=0;De<7;De++){var Fe=document.createElement("td");Fe.classList.add("jcalendar-weekday"),Fe.innerHTML=o.options.weekdays[$e].substr(0,1),xe.appendChild(Fe),$e++,$e>6&&($e=0)}for(var $e=0,ne=0,ve=0;ve<6;ve++){var xe=document.createElement("tr");xe.setAttribute("align","center"),xe.style.height="34px";for(var De=0;De<7;De++){var Fe=document.createElement("td");if(Fe.classList.add("jcalendar-set-day"),$e>=Me&&$e<Me+le){ne++,Fe.innerHTML=ne,ne==v&&Fe.classList.add("jcalendar-selected"),ue&&K==ne&&(Fe.style.fontWeight="bold");var ye=w.now(new Date(U,J-1,ne),!0);if(o.options.validRange){if(!o.options.validRange[0]||ye>=o.options.validRange[0])var ke=!0;else var ke=!1;if(!o.options.validRange[1]||ye<=o.options.validRange[1])var Xe=!0;else var Xe=!1;ke&&Xe||Fe.classList.add("jcalendar-disabled")}}xe.appendChild(Fe),$e++}Ee.appendChild(xe)}o.options.time?Se.style.display="":Se.style.display="none",te()},o.getMonths=function(){o.options.mode="months";var U=o.options.months;o.options.value;var J=new Date,v=parseInt(J.getFullYear()),D=parseInt(J.getMonth())+1,X=o.date&&s.isNumeric(o.date[0])?o.date[0]:v,ue=o.date&&s.isNumeric(o.date[1])?o.date[1]:D;pe.innerHTML=o.date[0],ce.innerHTML=U[ue-1];var K=document.createElement("table");K.setAttribute("width","100%");for(var le=null,me=0;me<12;me++){if(!(me%4)){var le=document.createElement("tr");le.setAttribute("align","center"),K.appendChild(le)}var Me=document.createElement("td");if(Me.classList.add("jcalendar-set-month"),Me.setAttribute("data-value",me+1),Me.innerText=U[me],o.options.validRange){var xe=X+"-"+s.two(me+1);if(!o.options.validRange[0]||xe>=o.options.validRange[0].substr(0,7))var De=!0;else var De=!1;if(!o.options.validRange[1]||xe<=o.options.validRange[1].substr(0,7))var Fe=!0;else var Fe=!1;De&&Fe||Me.classList.add("jcalendar-disabled")}me+1==ue&&Me.classList.add("jcalendar-selected"),v==X&&me+1==D&&(Me.style.fontWeight="bold"),le.appendChild(Me)}Ee.innerHTML='<tr><td colspan="7"></td></tr>',Ee.children[0].children[0].appendChild(K),te()},o.getYears=function(){o.options.mode="years";for(var U=new Date,J=U.getFullYear(),v=o.date&&s.isNumeric(o.date[0])?o.date[0]:parseInt(U.getFullYear()),D=[],X=0;X<25;X++)D[X]=parseInt(o.date[0])+(X-12);var ue=document.createElement("table");ue.setAttribute("width","100%");for(var X=0;X<25;X++){if(!(X%5)){var K=document.createElement("tr");K.setAttribute("align","center"),ue.appendChild(K)}var le=document.createElement("td");le.classList.add("jcalendar-set-year"),le.innerText=D[X],v==D[X]&&le.classList.add("jcalendar-selected"),J==D[X]&&(le.style.fontWeight="bold"),K.appendChild(le)}Ee.innerHTML='<tr><td colspan="7"></td></tr>',Ee.firstChild.firstChild.appendChild(ue),te()},o.setLabel=function(U,J){return w.getDateString(U,J)},o.fromFormatted=function(U,J){return w.extractDateFromString(U,J)};var P=function(U){var J=s.findElement(U.target,"jcalendar-container");if(J){var v=U.target.className;if(v=="jcalendar-prev")o.prev();else if(v=="jcalendar-next")o.next();else if(v=="jcalendar-month")o.getMonths();else if(v=="jcalendar-year")o.getYears();else if(v=="jcalendar-set-year")o.date[0]=U.target.innerText,o.options.type=="year-month-picker"?o.getMonths():o.getDays();else if(U.target.classList.contains("jcalendar-set-month")){var D=parseInt(U.target.getAttribute("data-value"));o.options.type=="year-month-picker"?o.update(U.target,D):(o.date[1]=D,o.getDays())}else v=="jcalendar-confirm"||v=="jcalendar-update"||v=="jcalendar-close"?o.close(null,!0):v=="jcalendar-backdrop"?o.close(!1,!1):v=="jcalendar-reset"?o.reset():U.target.classList.contains("jcalendar-set-day")&&U.target.innerText&&o.update(U.target)}else o.close(!1,!1)},ee=function(U){if(U.target.value&&U.target.value.length>3){var J=w.extractDateFromString(U.target.value,o.options.format);J&&o.setValue(J)}},te=function(){var U=S.querySelector(".jcalendar-selected");U&&U.classList.contains("jcalendar-disabled")?(Ge.setAttribute("disabled","disabled"),Q.setAttribute("disabled","disabled"),he.setAttribute("disabled","disabled")):(Ge.removeAttribute("disabled"),Q.removeAttribute("disabled"),he.removeAttribute("disabled")),typeof o.options.onupdate=="function"&&o.options.onupdate(E,o.getValue())},S=null,M=null,V=null,G=null,oe=null,pe=null,ce=null,fe=null,Ee=null,Ie=null,Se=null,ze=null,Ge=null,Q=null,he=null,we=function(){E.tagName=="INPUT"&&E.value&&(a.value=E.value),M=document.createElement("div"),M.className="jcalendar-reset",V=document.createElement("div"),V.className="jcalendar-confirm",Ie=document.createElement("div"),Ie.className="jcalendar-controls",Ie.style.borderBottom="1px solid #ddd",Ie.appendChild(M),Ie.appendChild(V),G=document.createElement("div"),G.className="jcalendar-container",oe=document.createElement("div"),oe.className="jcalendar-content",G.appendChild(oe),E.tagName=="DIV"?(S=E,S.classList.add("jcalendar-inline")):(oe.appendChild(Ie),S=document.createElement("div"),S.className="jcalendar"),S.classList.add("jcalendar-container"),S.appendChild(G);var U=document.createElement("div");U.className="jcalendar-table",oe.appendChild(U);var J=document.createElement("td");J.setAttribute("colspan","2"),J.className="jcalendar-prev",pe=document.createElement("span"),pe.className="jcalendar-year",ce=document.createElement("span"),ce.className="jcalendar-month";var v=document.createElement("td");v.className="jcalendar-header",v.setAttribute("colspan","3"),v.appendChild(ce),v.appendChild(pe);var D=document.createElement("td");D.setAttribute("colspan","2"),D.className="jcalendar-next";var X=document.createElement("thead"),ue=document.createElement("tr");ue.appendChild(J),ue.appendChild(v),ue.appendChild(D),X.appendChild(ue),fe=document.createElement("table"),Ee=document.createElement("tbody"),fe.setAttribute("cellpadding","0"),fe.setAttribute("cellspacing","0"),fe.appendChild(X),fe.appendChild(Ee),U.appendChild(fe),Q=document.createElement("select"),Q.className="jcalendar-select",Q.onchange=function(){o.date[3]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(E,o.getValue())};for(var K=0;K<24;K++){var le=document.createElement("option");le.value=K,le.innerHTML=s.two(K),Q.appendChild(le)}he=document.createElement("select"),he.className="jcalendar-select",he.onchange=function(){o.date[4]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(E,o.getValue())};for(var K=0;K<60;K++){var le=document.createElement("option");le.value=K,le.innerHTML=s.two(K),he.appendChild(le)}var me=document.createElement("div");me.className="jcalendar-controls",Se=document.createElement("div"),Se.className="jcalendar-time",Se.style.maxWidth="140px",Se.appendChild(Q),Se.appendChild(he),Ge=document.createElement("button"),Ge.setAttribute("type","button"),Ge.className="jcalendar-update",ze=document.createElement("div"),ze.style.flexGrow="10",ze.appendChild(Ge),me.appendChild(Se),E.tagName=="INPUT"&&me.appendChild(ze),oe.appendChild(me);var Me=document.createElement("div");Me.className="jcalendar-backdrop",S.appendChild(Me),E.addEventListener("keyup",ee),S.addEventListener("swipeleft",function(xe){B.slideLeft(fe,0,function(){o.next(),B.slideRight(fe,1)}),xe.preventDefault(),xe.stopPropagation()}),S.addEventListener("swiperight",function(xe){B.slideRight(fe,0,function(){o.prev(),B.slideLeft(fe,1)}),xe.preventDefault(),xe.stopPropagation()}),"ontouchend"in document.documentElement?(S.addEventListener("touchend",P),E.addEventListener("touchend",o.open)):(S.addEventListener("mouseup",P),E.addEventListener("mouseup",o.open)),w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),o.setOptions(a),E.tagName=="INPUT"?(E.parentNode.insertBefore(S,E.nextSibling),E.setAttribute("autocomplete","off"),E.classList.add("jcalendar-input"),E.value=o.setLabel(o.getValue(),o.options)):(o.getDays(),o.options.time&&(Q.value=o.date[3],he.value=o.date[4])),o.options.opened==!0&&o.open(),o.options.controls==!1&&G.classList.add("jcalendar-hide-controls"),E.change=o.setValue,E.val=function(xe){if(xe===void 0)return o.getValue();o.setValue(xe)},E.calendar=S.calendar=o};return we(),o};return w.keydown=function(E){var a=null;(a=w.current)&&(E.which==13?a.close(!1,!0):E.which==27&&a.close(!1,!1))},w.prettify=function(E,a){if(!a)var a={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};E.indexOf("GMT")===-1&&E.indexOf("Z")===-1&&(E+=" GMT");var o=new Date,P=new Date(E),ee=parseInt((o-P)/1e3/60);if(String.prototype.format=function(S){return this.replace("{0}",S)},ee==0)var te=a.justNow;else if(ee<90)var te=a.xMinutesAgo.format(ee);else if(ee<1440)var te=a.xHoursAgo.format(Math.round(ee/60));else if(ee<20160)var te=a.xDaysAgo.format(Math.round(ee/1440));else if(ee<43200)var te=a.xWeeksAgo.format(Math.round(ee/10080));else if(ee<1036800)var te=a.xMonthsAgo.format(Math.round(ee/43200));else var te=a.xYearsAgo.format(Math.round(ee/525600));return te},w.prettifyAll=function(){for(var E=document.querySelectorAll(".prettydate"),a=0;a<E.length;a++)E[a].getAttribute("data-date")?E[a].innerHTML=w.prettify(E[a].getAttribute("data-date")):E[a].innerHTML&&(E[a].setAttribute("title",E[a].innerHTML),E[a].setAttribute("data-date",E[a].innerHTML),E[a].innerHTML=w.prettify(E[a].innerHTML))},w.now=A.now,w.toArray=A.toArray,w.dateToNum=A.dateToNum,w.numToDate=A.numToDate,w.weekdays=A.weekdays,w.months=A.months,w.weekdaysShort=A.weekdaysShort,w.monthsShort=A.monthsShort,w.extractDateFromString=Z.extractDateFromString,w.getDateString=Z.getDateString,w}var se=q();function ge(){var w={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},E=function(a){return w[a]?w[a]:w.material};return E.get=function(a){return w[a]?w[a]:w},E.set=function(a,o){w[a]=o},E}var ae=ge();function be(w,E){var a={};a.options={};var o={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var P in o)E&&E.hasOwnProperty(P)?a.options[P]=E[P]:a.options[P]=o[P];w.classList.add("jtabs");var ee=null,te=null,S=null;const M=function(ce){a.options.animation&&setTimeout(function(){let fe=a.headers.children[ce].getBoundingClientRect();a.options.palette==="modern"?(S.style.width=fe.width-4+"px",S.style.left=a.headers.children[ce].offsetLeft+2+"px"):(S.style.width=fe.width+"px",S.style.left=a.headers.children[ce].offsetLeft+"px"),a.options.position==="bottom"?S.style.top="0px":S.style.bottom="0px"},50)};var V=function(ce){typeof a.headers.scrollTo=="function"?a.headers.scrollTo({left:ce,behavior:"smooth"}):a.headers.scrollLeft=ce,ce<=1?ee.classList.add("disabled"):ee.classList.remove("disabled"),ce>=a.headers.scrollWidth-a.headers.offsetWidth?te.classList.add("disabled"):te.classList.remove("disabled"),a.headers.scrollWidth<=a.headers.offsetWidth?(ee.style.display="none",te.style.display="none"):(ee.style.display="",te.style.display="")};if(a.setBorder=M,a.open=function(ce){if(Array.from(a.content.children),!!a.content.children[ce]){for(var fe=null,Ee=0;Ee<a.headers.children.length;Ee++)a.headers.children[Ee].classList.contains("jtabs-selected")&&(fe=Ee),a.headers.children[Ee].classList.remove("jtabs-selected"),a.headers.children[Ee].removeAttribute("aria-selected"),a.content.children[Ee]&&a.content.children[Ee].classList.remove("jtabs-selected");if(a.headers.children[ce].classList.add("jtabs-selected"),a.headers.children[ce].setAttribute("aria-selected","true"),a.content.children[ce]&&a.content.children[ce].classList.add("jtabs-selected"),fe!=ce&&typeof a.options.onchange=="function"&&a.content.children[ce]&&a.options.onchange(w,a,ce,a.headers.children[ce],a.content.children[ce]),a.options.hideHeaders==!0&&a.headers.children.length<3&&a.options.allowCreate==!1)a.headers.parentNode.style.display="none";else{a.headers.parentNode.style.display="";var Ie=a.headers.children[ce].offsetLeft,Se=Ie+a.headers.children[ce].offsetWidth,ze=a.headers.scrollLeft,Ge=ze+a.headers.offsetWidth;ze<=Ie&&Ge>=Se||V(Ie-1),M(ce)}}},a.selectIndex=function(ce){var fe=Array.prototype.indexOf.call(a.headers.children,ce);return fe>=0&&a.open(fe),fe},a.rename=function(ce,fe){fe||(fe=prompt("New title",a.headers.children[ce].innerText)),a.headers.children[ce].innerText=fe,M(a.getActive())},a.create=function(ce,fe){if(typeof a.options.onbeforecreate=="function"){var Ee=a.options.onbeforecreate(w,ce);if(Ee===!1)return!1;ce=Ee}var Ie=a.appendElement(ce);return typeof a.options.oncreate=="function"&&a.options.oncreate(w,Ie),M(a.getActive()),Ie},a.remove=function(ce){return a.deleteElement(ce)},a.nextNumber=function(){for(var ce=0,fe=0;fe<a.headers.children.length;fe++){var Ee=a.headers.children[fe].innerText.match(/[0-9].*/);Ee>ce&&(ce=parseInt(Ee))}return ce?ce++:ce=1,ce},a.deleteElement=function(ce){let fe=a.getActive();if(a.headers.children[ce])a.headers.removeChild(a.headers.children[ce]),a.content.removeChild(a.content.children[ce]);else return!1;if(fe===ce)a.open(0);else{let Ee=a.getActive()||0;M(Ee)}typeof a.options.ondelete=="function"&&a.options.ondelete(w,ce)},a.appendElement=function(ce,fe,Ee,Ie){if(!ce)var ce=prompt("Title?","");if(ce){let Ge=s.guid(),Q=s.guid();var Se=document.createElement("div");Se.setAttribute("id",Q),Se.setAttribute("role","tabpanel"),Se.setAttribute("aria-labelledby",Ge);var ze=document.createElement("div");if(ze.setAttribute("id",Ge),ze.setAttribute("role","tab"),ze.setAttribute("aria-controls",Q),ze.innerHTML=ce,ze.content=Se,typeof Ie>"u")a.content.appendChild(Se),a.headers.insertBefore(ze,a.headers.lastChild);else{let he=a.content.children[Ie];he?a.content.insertBefore(Se,he):a.content.appendChild(Se),he=a.headers.children[Ie]||a.headers.lastChild,a.headers.insertBefore(ze,he)}return a.options.allowChangePosition&&ze.setAttribute("draggable","true"),Ee!==!1&&a.selectIndex(ze),typeof fe=="function"&&fe(Se,ze),Se}},a.getActive=function(){for(var ce=0;ce<a.headers.children.length;ce++)if(a.headers.children[ce].classList.contains("jtabs-selected"))return ce;return!1},a.updateContent=function(ce,fe){if(typeof fe!="string")var Ee=fe;else{var Ee=document.createElement("div");Ee.innerHTML=fe}a.content.children[ce].classList.contains("jtabs-selected")&&fe.classList.add("jtabs-selected"),a.content.replaceChild(fe,a.content.children[ce]),M()},a.updatePosition=function(ce,fe,Ee,Ie){if(ce>fe?a.content.insertBefore(a.content.children[ce],a.content.children[fe]):a.content.insertBefore(a.content.children[ce],a.content.children[fe].nextSibling),Ie!==!1)a.open(fe);else{const Se=a.getActive();fe<Se&&a.setBorder(Se)}!Ee&&typeof a.options.onchangeposition=="function"&&a.options.onchangeposition(a.headers,ce,fe)},a.move=function(ce,fe,Ee,Ie){ce>fe?a.headers.insertBefore(a.headers.children[ce],a.headers.children[fe]):a.headers.insertBefore(a.headers.children[ce],a.headers.children[fe].nextSibling),a.updatePosition(ce,fe,Ee,Ie)},a.setBorder=M,a.init=function(){w.innerHTML="",a.headers=document.createElement("div"),a.content=document.createElement("div"),a.headers.classList.add("jtabs-headers"),a.headers.setAttribute("role","tablist"),a.content.classList.add("jtabs-content"),a.content.setAttribute("role","region"),a.content.setAttribute("aria-label","Tab Panels"),a.options.palette?w.classList.add("jtabs-modern"):w.classList.remove("jtabs-modern"),a.options.padding&&(a.content.style.padding=parseInt(a.options.padding)+"px");var ce=document.createElement("div");ce.className="jtabs-headers-container",ce.appendChild(a.headers),a.options.maxWidth&&(ce.style.maxWidth=parseInt(a.options.maxWidth)+"px");var fe=document.createElement("div");if(fe.className="jtabs-controls",fe.setAttribute("draggable","false"),ce.appendChild(fe),a.options.position=="bottom"?(w.appendChild(a.content),w.appendChild(ce)):(w.appendChild(ce),w.appendChild(a.content)),a.options.allowCreate==!0){var Ee=document.createElement("div");Ee.className="jtabs-add",Ee.onclick=function(){a.create()},fe.appendChild(Ee)}ee=document.createElement("div"),ee.className="jtabs-prev",ee.onclick=function(){V(a.headers.scrollLeft-a.headers.offsetWidth)},fe.appendChild(ee),te=document.createElement("div"),te.className="jtabs-next",te.onclick=function(){V(a.headers.scrollLeft+a.headers.offsetWidth)},fe.appendChild(te);for(var Ie=0;Ie<a.options.data.length;Ie++){if(a.options.data[Ie].titleElement)var Se=a.options.data[Ie].titleElement;else var Se=document.createElement("div");if(a.options.data[Ie].icon){var ze=document.createElement("div"),Ge=document.createElement("i");Ge.classList.add("material-icons"),Ge.innerHTML=a.options.data[Ie].icon,ze.appendChild(Ge),Se.appendChild(ze)}if(a.options.data[Ie].title){var Q=document.createTextNode(a.options.data[Ie].title);Se.appendChild(Q)}if(a.options.data[Ie].width&&(Se.style.width=a.options.data[Ie].width),a.options.data[Ie].contentElement)var he=a.options.data[Ie].contentElement;else{var he=document.createElement("div");he.innerHTML=a.options.data[Ie].content}a.headers.appendChild(Se),a.content.appendChild(he)}S=document.createElement("div"),S.className="jtabs-border",a.headers.appendChild(S),a.options.animation&&w.classList.add("jtabs-animation"),a.headers.addEventListener("click",function(we){if(we.target.parentNode.classList.contains("jtabs-headers"))var U=we.target;else if(we.target.tagName=="I")var U=we.target.parentNode.parentNode;else var U=we.target.parentNode;var J=a.selectIndex(U);typeof a.options.onclick=="function"&&a.options.onclick(w,a,J,a.headers.children[J],a.content.children[J])}),a.headers.addEventListener("contextmenu",function(we){a.selectIndex(we.target)}),a.headers.children.length&&a.open(0),V(0),a.options.allowChangePosition==!0&&j(a.headers,{direction:1,ondrop:function(we,U,J){a.updatePosition(U,J)}}),typeof a.options.onload=="function"&&a.options.onload(w,a)},w.children[0]&&w.children[0].children.length)for(var G=0;G<w.children[0].children.length;G++){var oe=a.options.data&&a.options.data[G]?a.options.data[G]:{};w.children[1]&&w.children[1].children[G]?(oe.titleElement=w.children[0].children[G],oe.contentElement=w.children[1].children[G]):oe.contentElement=w.children[0].children[G],a.options.data[G]=oe}var pe=!1;if(a.options.data)for(var G=0;G<a.options.data.length;G++)a.options.data[G].url&&(T({url:a.options.data[G].url,type:"GET",dataType:"text/html",index:G,success:function(fe){a.options.data[this.index].content=fe},complete:function(){a.init()}}),pe=!0);return pe||a.init(),w.tabs=a,a}function Ae(w,E){if(w.color)return w.color.setOptions(E,!0);var a={type:"color"};a.options={};var o=null,P=null,ee=null,te=null,S=null,M=null,V=null;a.setOptions=function(v,D){var X={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};v||(v={}),v&&!v.palette&&(v.palette=ae());for(var ue in X)v&&v.hasOwnProperty(ue)?a.options[ue]=v[ue]:(typeof a.options[ue]>"u"||D===!0)&&(a.options[ue]=X[ue]);return te&&(te.innerHTML=a.options.resetLabel),S&&(S.innerHTML=a.options.doneLabel),a.options.palette&&V&&V.updateContent(0,fe()),typeof a.options.value=="string"&&(w.value=a.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value)),a.options.placeholder?w.setAttribute("placeholder",a.options.placeholder):w.getAttribute("placeholder")&&w.removeAttribute("placeholder"),a},a.select=function(v){var D=o.querySelector(".jcolor-selected");D&&D.classList.remove("jcolor-selected"),a.values[v]&&a.values[v].classList.add("jcolor-selected"),a.options.value=v},a.open=function(){if(!o.classList.contains("jcolor-focus")){_(a,!0),o.classList.add("jcolor-focus"),a.options.value&&a.select(a.options.value),ee.style.marginTop="",ee.style.marginLeft="";var v=ee.getBoundingClientRect(),D=s.getWindowWidth(),X=s.getWindowHeight();if(D<800||a.options.fullscreen==!0?(ee.classList.add("jcolor-fullscreen"),B.slideBottom(ee,1),P.style.display="block"):(ee.classList.contains("jcolor-fullscreen")&&(ee.classList.remove("jcolor-fullscreen"),P.style.display=""),a.options.position?ee.style.position="fixed":ee.style.position="",v.left+v.width>D&&(ee.style.marginLeft=-1*(v.left+v.width-(D-20))+"px"),v.top+v.height>X&&(ee.style.marginTop=-1*(v.top+v.height-(X-20))+"px")),typeof a.options.onopen=="function"&&a.options.onopen(w,a),V.setBorder(V.getActive()),a.options.value){var ue=ce(a.options.value);he.forEach(function(K,le){K.value=ue[le],K.dispatchEvent(new Event("input"))})}}},a.close=function(v){return o.classList.contains("jcolor-focus")&&(o.classList.remove("jcolor-focus"),P.style.display="",!v&&typeof a.options.onclose=="function"&&a.options.onclose(w,a),_(a,!1)),a.options.value},a.setValue=function(v){v||(v=""),v!=a.options.value&&(a.options.value=v,Q=v,a.select(v),typeof a.options.onchange=="function"&&a.options.onchange(w,v,a),w.value!=a.options.value&&(w.value=a.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value),typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),a.options.closeOnChange==!0&&a.close())},a.getValue=function(){return a.options.value};var G=function(v){var D=v.toString(16);return D.length===1?"0"+D:D},oe=function(v,D,X){return"#"+G(v)+G(D)+G(X)},pe=function(v){return parseInt("0x"+v)},ce=function(v){return[pe(v.substr(1,2)),pe(v.substr(3,2)),pe(v.substr(5,2))]},fe=function(){var v=document.createElement("div");v.className="jcolor-grid",a.values=[];var D=document.createElement("table");D.setAttribute("cellpadding","7"),D.setAttribute("cellspacing","0");for(var X=0;X<a.options.palette.length;X++){for(var ue=document.createElement("tr"),K=0;K<a.options.palette[X].length;K++){var le=document.createElement("td"),me=a.options.palette[X][K];me.length<7&&me.substr(0,1)!=="#"&&(me="#"+me),le.style.backgroundColor=me,le.setAttribute("data-value",me),le.innerHTML="",ue.appendChild(le),a.options.value==me&&le.classList.add("jcolor-selected"),a.values[me]=le}D.appendChild(ue)}return v.appendChild(D),v},Ee=document.createElement("canvas");Ee.width=200,Ee.height=160;var Ie=Ee.getContext("2d"),Se=function(){var v=M.firstChild.getBoundingClientRect();Ee.width=v.width-14,ze()},ze=function(){var v=Ie.createLinearGradient(0,0,Ee.width,0);v.addColorStop(0,"rgb(255,0,0)"),v.addColorStop(.15,"rgb(255,0,255)"),v.addColorStop(.33,"rgb(0,0,255)"),v.addColorStop(.49,"rgb(0,255,255)"),v.addColorStop(.67,"rgb(0,255,0)"),v.addColorStop(.84,"rgb(255,255,0)"),v.addColorStop(1,"rgb(255,0,0)"),Ie.fillStyle=v,Ie.fillRect(0,0,Ee.width,Ee.height),v=Ie.createLinearGradient(0,0,0,Ee.height),v.addColorStop(0,"rgba(255,255,255,1)"),v.addColorStop(.5,"rgba(255,255,255,0)"),v.addColorStop(.5,"rgba(0,0,0,0)"),v.addColorStop(1,"rgba(0,0,0,1)"),Ie.fillStyle=v,Ie.fillRect(0,0,Ee.width,Ee.height)},Ge=function(){var v=document.createElement("div");v.className="jcolor-hsl";var D=document.createElement("div");D.className="jcolor-point";var X=document.createElement("div");X.appendChild(Ee),X.appendChild(D),v.appendChild(X);var ue=function(K,le,me){if(K===1){var Me=v.getBoundingClientRect(),xe=le-Me.left,De=me-Me.top;xe<0&&(xe=0),De<0&&(De=0),xe>Me.width&&(xe=Me.width),De>Me.height&&(De=Me.height),D.style.left=xe+"px",D.style.top=De+"px";var Fe=Ie.getImageData(xe,De,1,1).data;Q=oe(Fe[0],Fe[1],Fe[2])}};return v.addEventListener("mousedown",function(K){ue(K.buttons,K.clientX,K.clientY)}),v.addEventListener("mousemove",function(K){ue(K.buttons,K.clientX,K.clientY)}),v.addEventListener("touchmove",function(K){ue(1,K.changedTouches[0].clientX,K.changedTouches[0].clientY)}),v},Q="",he=[],we=function(){if(Q!=="")for(var v=0;v<he.length;v++){var D=ce(Q);D[v]=0;var X="linear-gradient(90deg, rgb(";X+=D.join(", "),X+="), rgb(",D[v]=255,X+=D.join(", "),X+="))",he[v].style.backgroundImage=X}},U=function(){var v=document.createElement("div");v.className="jcolor-sliders";var D=document.createElement("div"),X=function(me){var Me=document.createElement("div");Me.className="jcolor-sliders-input-container";var xe=document.createElement("label");xe.innerText=me;var De=document.createElement("div");De.className="jcolor-sliders-input-subcontainer";var Fe=document.createElement("input");Fe.type="range",Fe.min=0,Fe.max=255,Fe.value=0,Fe.setAttribute("aria-label","Color value"),Fe.setAttribute("aria-valuemin","0"),Fe.setAttribute("aria-valuemax","255"),Fe.setAttribute("aria-valuenow","0"),Me.appendChild(xe),De.appendChild(Fe);var $e=document.createElement("div");return $e.innerText=Fe.value,Fe.addEventListener("input",function(){$e.innerText=Fe.value}),De.appendChild($e),Me.appendChild(De),D.appendChild(Me),Fe};he=[X("Red"),X("Green"),X("Blue")],v.appendChild(D);var ue=document.createElement("div");ue.className="jcolor-sliders-final-color";var K=document.createElement("div");K.style.visibility="hidden",K.innerText="a",ue.appendChild(K);var le=function(){var me=oe(parseInt(he[0].value),parseInt(he[1].value),parseInt(he[2].value));K.innerText=me,K.style.color=me,K.style.removeProperty("visibility"),Q=me};return he.forEach(function(me){me.addEventListener("input",function(){le(),we()})}),v.appendChild(ue),v},J=function(){a.setOptions(E),w.tagName=="INPUT"&&(w.classList.add("jcolor-input"),w.readOnly=!0),o=document.createElement("div"),o.className="jcolor",P=document.createElement("div"),P.className="jcolor-backdrop",o.appendChild(P),ee=document.createElement("div"),ee.className="jcolor-content";var v=document.createElement("div");v.className="jcolor-controls",ee.appendChild(v),te=document.createElement("div"),te.className="jcolor-reset",te.innerHTML=a.options.resetLabel,v.appendChild(te),S=document.createElement("div"),S.className="jcolor-close",S.innerHTML=a.options.doneLabel,v.appendChild(S),M=document.createElement("div"),ee.appendChild(M),V=be(M,{animation:!0,data:[{title:"Grid",contentElement:fe()},{title:"Spectrum",contentElement:Ge()},{title:"Sliders",contentElement:U()}],onchange:function(D,X,ue){if(ue===1)Se();else{var K=Q!==""?Q:a.getValue();if(ue===2&&K){var le=ce(K);he.forEach(function(me,Me){me.value=le[Me],me.dispatchEvent(new Event("input"))})}}},palette:"modern"}),o.appendChild(ee),w.tagName=="INPUT"?w.parentNode.insertBefore(o,w.nextSibling):w.appendChild(o),o.addEventListener("click",function(D){if(D.target.tagName=="TD"){var X=D.target.getAttribute("data-value");X&&a.setValue(X)}else D.target.classList.contains("jcolor-reset")?(a.setValue(""),a.close()):D.target.classList.contains("jcolor-close")?(V.getActive()>0&&a.setValue(Q),a.close()):D.target.classList.contains("jcolor-backdrop")?a.close():a.open()}),w.addEventListener("mouseup",function(D){a.open()}),window.addEventListener("resize",function(){o.classList.contains("jcolor-focus")&&V.getActive()==1&&Se()}),a.options.opened==!0&&a.open(),w.change=a.setValue,w.val=function(D){if(D===void 0)return a.getValue();a.setValue(D)},w.color=a,o.color=a};return a.toHex=function(v){var D=function(X){return("0"+parseInt(X).toString(16)).slice(-2)};if(v)return/^#[0-9A-F]{6}$/i.test(v)?v:(v=v.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),v&&v.length?"#"+D(v[1])+D(v[2])+D(v[3]):"")},J(),a}function je(){var w=function(E,a){var o={type:"contextmenu"};o.options={};var P={items:null,onclick:null};for(var ee in P)a&&a.hasOwnProperty(ee)?o.options[ee]=a[ee]:o.options[ee]=P[ee];E.classList.add("jcontextmenu"),o.open=function(M,V){if(V&&(o.options.items=V,o.create(V)),w.current&&w.current.close(),_(o,!0),E.classList.add("jcontextmenu-focus"),w.current=o,o.options.items&&o.options.items.length>0||E.children.length){if(M.target)if(M.changedTouches&&M.changedTouches[0])G=M.changedTouches[0].clientX,oe=M.changedTouches[0].clientY;else var G=M.clientX,oe=M.clientY;else var G=M.x,oe=M.y;var pe=E.getBoundingClientRect();if(window.innerHeight<oe+pe.height){var ce=oe-pe.height;ce<0&&(ce=0),E.style.top=ce+"px"}else E.style.top=oe+"px";window.innerWidth<G+pe.width?G-pe.width>0?E.style.left=G-pe.width+"px":E.style.left="10px":E.style.left=G+"px"}},o.isOpened=function(){return!!E.classList.contains("jcontextmenu-focus")},o.close=function(){E.classList.contains("jcontextmenu-focus")&&E.classList.remove("jcontextmenu-focus"),_(o,!1)},o.create=function(M){E.innerHTML="";var V=te();E.appendChild(V);for(var G=0;G<M.length;G++){var oe=S(M[G]);E.appendChild(oe)}};function te(){var M=document.createElement("div");M.classList.add("header"),M.addEventListener("click",function(oe){oe.preventDefault(),oe.stopPropagation()});var V=document.createElement("a");V.classList.add("title"),V.innerHTML=d.translate("Menu"),M.appendChild(V);var G=document.createElement("a");return G.classList.add("close"),G.innerHTML=d.translate("close"),G.addEventListener("click",function(oe){o.close()}),M.appendChild(G),M}function S(M){if(M.type&&(M.type=="line"||M.type=="divisor"))var V=document.createElement("hr");else{var V=document.createElement("div"),G=document.createElement("a");if(G.innerHTML=M.title,M.tooltip&&V.setAttribute("title",M.tooltip),M.icon&&V.setAttribute("data-icon",M.icon),M.id&&(V.id=M.id),M.disabled?V.className="jcontextmenu-disabled":M.onclick&&(V.method=M.onclick,V.addEventListener("mousedown",function(ze){ze.preventDefault()}),V.addEventListener("mouseup",function(ze){this.method(this,ze)})),V.appendChild(G),M.submenu){var oe=document.createElement("span");oe.innerHTML="&#9658;",V.appendChild(oe),V.classList.add("jcontexthassubmenu");var pe=document.createElement("div");pe.classList.add("jcontextmenu"),pe.setAttribute("tabindex","900");for(var ce=M.submenu,fe=0;fe<ce.length;fe++){var Ee=S(ce[fe]);pe.appendChild(Ee)}V.appendChild(pe)}else if(M.shortcut){var Ie=document.createElement("span");Ie.innerHTML=M.shortcut,V.appendChild(Ie)}}return V}return typeof o.options.onclick=="function"&&E.addEventListener("click",function(M){o.options.onclick(o,M)}),o.options.items&&o.create(o.options.items),window.addEventListener("mousewheel",function(){o.close()}),E.contextmenu=o,o};return w}var ie=je();function Pe(){var w=function(E,a){if(E.dropdown)return E.dropdown.setOptions(a,!0);var o={type:"dropdown"};o.options={};var P=function(U,J){U&&U.length&&(o.options.sortResults!==!1&&(typeof o.options.sortResults=="function"?U.sort(o.options.sortResults):U.sort(ee)),o.setData(U)),typeof o.options.onload=="function"&&o.options.onload(E,o,U,J),J&&S(J),J==null&&(o.options.value=""),E.value=o.options.value,o.options.opened==!0&&o.open()},ee=function(U,J){var v,D;return typeof U=="string"?v=U:U.text?v=U.text:U.name&&(v=U.name),typeof J=="string"?D=J:J.text?D=J.text:J.name&&(D=J.name),typeof v=="string"||typeof D=="string"?(typeof v!="string"&&(v=""+v),typeof D!="string"&&(D=""+D),v.localeCompare(D)):v-D},te=function(){o.value={};for(var U=0;U<o.items.length;U++)o.items[U].selected==!0&&(o.items[U].element&&o.items[U].element.classList.remove("jdropdown-selected"),o.items[U].selected=null);o.options.value="",E.value=""},S=function(U){if(te(),U!==null)if(!U)typeof o.value[""]<"u"&&(o.value[""]="");else{Array.isArray(U)||(U=(""+U).split(";"));for(var J=0;J<U.length;J++)o.value[U[J]]=""}for(var J=0;J<o.items.length;J++)typeof o.value[M(J)]<"u"&&(o.items[J].element&&o.items[J].element.classList.add("jdropdown-selected"),o.items[J].selected=!0,o.value[M(J)]=V(J));o.options.value=Object.keys(o.value).join(";"),o.header.value=o.getText()},M=function(U,J){if(o.options.format)var v="id";else var v="value";return o.items[U]?J!==void 0?o.items[U].data[v]=J:o.items[U].data[v]:""},V=function(U,J){if(o.options.format)var v="name";else var v="text";return o.items[U]?J!==void 0?o.items[U].data[v]=J:o.items[U].data[v]:""},G=function(){return Object.keys(o.value)},oe=function(){for(var U=[],J=Object.keys(o.value),v=0;v<J.length;v++)U.push(o.value[J[v]]);return U};o.setOptions=function(U,J){U||(U={});var v={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var D in v)U&&U.hasOwnProperty(D)?o.options[D]=U[D]:(typeof o.options[D]>"u"||J===!0)&&(o.options[D]=v[D]);return(o.options.remoteSearch==!0||o.options.type==="searchbar")&&(o.options.autocomplete=!0),o.options.newOptions==!0?o.header.classList.add("jdropdown-add"):o.header.classList.remove("jdropdown-add"),o.options.autocomplete==!0?o.header.removeAttribute("readonly"):o.header.setAttribute("readonly","readonly"),o.options.placeholder?o.header.setAttribute("placeholder",o.options.placeholder):o.header.removeAttribute("placeholder"),E.classList.remove("jdropdown-searchbar"),E.classList.remove("jdropdown-picker"),E.classList.remove("jdropdown-list"),o.options.type=="searchbar"?E.classList.add("jdropdown-searchbar"):o.options.type=="list"?E.classList.add("jdropdown-list"):o.options.type=="picker"?E.classList.add("jdropdown-picker"):s.getWindowWidth()<800?o.options.autocomplete?(E.classList.add("jdropdown-searchbar"),o.options.type="searchbar"):(E.classList.add("jdropdown-picker"),o.options.type="picker"):(o.options.width?(E.style.width=o.options.width,E.style.minWidth=o.options.width):(E.style.removeProperty("width"),E.style.removeProperty("min-width")),E.classList.add("jdropdown-default"),o.options.type="default"),o.options.type=="searchbar"?pe.appendChild(Ee):ce.insertBefore(Ee,ce.firstChild),o.options.url&&!U.data?T({url:o.options.url,method:"GET",dataType:"json",success:function(X){X&&P(X,o.options.value)}}):P(o.options.data,o.options.value),o};var pe=null,ce=null,fe=null,Ee=null,Ie=null,Se=null,ze=null,Ge=function(){if(a||(a={}),E.tagName=="SELECT"){var U=w.extractFromDom(E,a);E=U.el,a=U.options}!a.placeholder&&E.getAttribute("placeholder")&&(a.placeholder=E.getAttribute("placeholder")),o.value={},o.items=[],o.groups=[],o.search="",o.results=null,E.classList.add("jdropdown"),pe=document.createElement("div"),pe.className="jdropdown-container-header",o.header=document.createElement("input"),o.header.className="jdropdown-header jss_object",o.header.type="text",o.header.setAttribute("autocomplete","off"),o.header.onfocus=function(){typeof o.options.onfocus=="function"&&o.options.onfocus(E)},o.header.onblur=function(){typeof o.options.onblur=="function"&&o.options.onblur(E)},o.header.onkeyup=function(J){o.options.autocomplete==!0&&!ze?(o.search!=o.header.value.trim()&&(ze=setTimeout(function(){o.find(o.header.value.trim()),ze=null},400)),E.classList.contains("jdropdown-focus")||o.open()):o.options.autocomplete||o.next(J.key)},w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),ce=document.createElement("div"),ce.className="jdropdown-container",fe=document.createElement("div"),fe.className="jdropdown-content",Ee=document.createElement("div"),Ee.className="jdropdown-close",Ee.textContent="Done",Ie=document.createElement("div"),Ie.className="jdropdown-reset",Ie.textContent="x",Ie.onclick=function(){o.reset(),o.close()},Se=document.createElement("div"),Se.className="jdropdown-backdrop",pe.appendChild(o.header),ce.appendChild(fe),E.appendChild(pe),E.appendChild(ce),E.appendChild(Se),o.setOptions(a),"ontouchsend"in document.documentElement?E.addEventListener("touchsend",w.mouseup):E.addEventListener("mouseup",w.mouseup),o.options.lazyLoading==!0&&h(fe,{loadUp:o.loadUp,loadDown:o.loadDown}),fe.onwheel=function(J){J.stopPropagation()},E.change=o.setValue,E.val=function(J){if(J===void 0)return o.getValue(!!o.options.multiple);o.setValue(J)},E.dropdown=o};o.getUrl=function(){return o.options.url},o.setUrl=function(U,J){o.options.url=U,T({url:o.options.url,method:"GET",dataType:"json",success:function(v){o.setData(v),typeof J=="function"&&J(o)}})},o.setId=function(U,J){if(o.options.format)var v="id";else var v="value";typeof U=="object"?U[v]=J:o.items[U].data[v]=J};const Q=function(U,J){if(!U){let X=o.options.autocomplete==!0?o.header.value:"";if(U=prompt(d.translate("Add A New Option"),X),!U)return!1}if(J||(J=s.guid()),o.options.format)var v={id:J,name:U};else var v={value:J,text:U};if(typeof o.options.onbeforeinsert=="function"){let X=o.options.onbeforeinsert(o,v);if(X===!1)return!1;X&&(v=X)}o.options.data.push(v);var D=o.createItem(v);return fe.appendChild(D.element),typeof o.options.oninsert=="function"&&o.options.oninsert(o,v,D),fe.style.display=="none"&&(fe.style.display=""),o.results&&o.results.push(D),v};o.add=function(U,J){return typeof o.options.prompt=="function"?o.options.prompt.call(o,Q):Q(U,J)},o.createItem=function(U,J,v){o.options.format?(!U.id&&U.value!==void 0&&(U.id=U.value),!U.name&&U.text!==void 0&&(U.name=U.text)):(!U.value&&U.id!==void 0&&(U.value=U.id),!U.text&&U.name!==void 0&&(U.text=U.name));var D={};if(D.element=document.createElement("div"),D.element.className="jdropdown-item",D.element.indexValue=o.items.length,D.data=U,J&&(D.group=J),U.id&&D.element.setAttribute("id",U.id),U.disabled==!0&&D.element.setAttribute("data-disabled",!0),U.tooltip&&D.element.setAttribute("title",U.tooltip),U.image){var X=document.createElement("img");X.className="jdropdown-image",X.src=U.image,U.title||X.classList.add("jdropdown-image-small"),D.element.appendChild(X)}else if(U.icon){var ue=document.createElement("span");ue.className="jdropdown-icon material-icons",ue.innerText=U.icon,U.title||ue.classList.add("jdropdown-icon-small"),U.color&&(ue.style.color=U.color),D.element.appendChild(ue)}else if(U.color){var K=document.createElement("div");K.className="jdropdown-color",K.style.backgroundColor=U.color,D.element.appendChild(K)}if(o.options.format)var le=U.name;else var le=U.text;var me=document.createElement("div");if(me.className="jdropdown-description",me.textContent=le||"&nbsp;",U.title){var Me=document.createElement("div");Me.className="jdropdown-title",Me.innerText=U.title,me.appendChild(Me)}if(o.options.format)var xe=U.id;else var xe=U.value;return o.value[xe]&&(D.element.classList.add("jdropdown-selected"),D.selected=!0),o.items.push(D),D.element.appendChild(me),D},o.appendData=function(U){if(U.length){for(var J=[],v=[],D=0;D<U.length;D++)U[D].group?(v[U[D].group]||(v[U[D].group]=[]),v[U[D].group].push(D)):J.push(D);var X=0,ue=Object.keys(v);if(ue.length>0)for(var D=0;D<ue.length;D++){var K=document.createElement("div");K.className="jdropdown-group";var le=document.createElement("div");le.className="jdropdown-group-name",le.textContent=ue[D];var me=document.createElement("i");me.className="jdropdown-group-arrow jdropdown-group-arrow-down",le.appendChild(me);var Me=document.createElement("div");Me.className="jdropdown-group-items";for(var xe=0;xe<v[ue[D]].length;xe++){var De=o.createItem(U[v[ue[D]][xe]],K,ue[D]);(o.options.lazyLoading==!1||X<200)&&(Me.appendChild(De.element),X++)}K.appendChild(le),K.appendChild(Me),o.groups.push(K),Me.children.length>0&&fe.appendChild(K)}if(J.length)for(var D=0;D<J.length;D++){var De=o.createItem(U[J[D]]);(o.options.lazyLoading==!1||X<200)&&(fe.appendChild(De.element),X++)}}},o.setData=function(U){if(te(),fe.textContent="",o.header.value="",o.items=[],U&&U.length){for(var J=0;J<U.length;J++)typeof U[J]!="object"&&(o.options.format?U[J]={id:U[J],name:U[J]}:U[J]={value:U[J],text:U[J]});o.appendData(U),o.options.data=U}else o.options.data=[];o.close()},o.getData=function(){return o.options.data},o.getPosition=function(U){for(var J=0;J<o.items.length;J++)if(M(J)==U)return J;return!1},o.getText=function(U){var J=oe();return U?J:J.join("; ")},o.getValue=function(U){var J=G();return U?J:J.join(";")};var he=function(U){E.value!=o.options.value&&(E.value=o.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),typeof o.options.onchange=="function"&&o.options.onchange(E,o,U,o.options.value)};o.setValue=function(U){var J=o.getValue();Array.isArray(U)&&(U=U.join(";")),J!==U&&(S(U),he(J))},o.resetSelected=function(){o.setValue(null)},o.selectIndex=function(v,J){var v=parseInt(v);if(o.items&&o.items[v]&&(J===!0||o.items[v].data.disabled!==!0))if(o.setCursor(v,!1),!o.options.multiple)o.items[v].selected?o.options.allowEmpty!==!1&&o.setValue(null):o.setValue(M(v)),o.close();else{var D=o.options.value;o.items[v].selected?(o.items[v].element.classList.remove("jdropdown-selected"),o.items[v].selected=!1,delete o.value[M(v)]):(o.items[v].element.classList.add("jdropdown-selected"),o.items[v].selected=!0,o.value[M(v)]=V(v)),o.options.value=Object.keys(o.value).join(";"),o.options.autocomplete==!1&&(o.header.value=oe().join("; ")),he(D)}},o.selectItem=function(U){o.selectIndex(U.indexValue)};var we=function(U,J){for(var v=0;v<J.length;v++)if(o.options.format){if(J[v].id==U)return!0}else if(J[v].value==U)return!0;return!1};return o.find=function(U){if(o.search==U.trim())return!1;if(o.search=U,o.setCursor(),o.groups.length)for(var J=0;J<o.groups.length;J++)o.groups[J].lastChild.textContent="";if(fe.textContent="",o.options.remoteSearch==!0){o.results=null;var v=o.options.url;let Me={url:v,method:"GET",data:{q:U},dataType:"json",success:function(xe){o.items=[];var De=Object.keys(o.value);if(De.length)for(var Fe=0;Fe<De.length;Fe++)we(De[Fe],xe)||(o.options.format?xe.unshift({id:De[Fe],name:o.value[De[Fe]]}):xe.unshift({value:De[Fe],text:o.value[De[Fe]]}));o.appendData(xe),xe.length?fe.style.display="":fe.style.display="none",typeof o.options.onsearch=="function"&&o.options.onsearch(o,xe)}};if(typeof o.options.onbeforesearch=="function"){let xe=o.options.onbeforesearch(o,Me);if(xe===!1)return;typeof xe=="object"&&(Me=xe)}T(Me)}else{U=new RegExp(U,"gi");for(var D=[],J=0;J<o.items.length;J++){var X=V(J),ue=o.items[J].data.title||"",K=o.items[J].data.group||"",le=o.items[J].data.synonym||"";le&&(le=le.join(" ")),(U==null||o.items[J].selected==!0||X.toString().match(U)||ue.match(U)||K.match(U)||le.match(U))&&D.push(o.items[J])}if(!D.length)fe.style.display="none",o.results=null;else{fe.style.display="",o.results=D;var me=D.length||0;o.options.lazyLoading==!0&&me>200&&(me=200);for(var J=0;J<me;J++)o.results[J].group?(o.results[J].group.parentNode||fe.appendChild(o.results[J].group),o.results[J].group.lastChild.appendChild(o.results[J].element)):fe.appendChild(o.results[J].element)}}o.options.autofocus==!0&&o.first()},o.open=function(){if(!E.classList.contains("jdropdown-focus")){w.current=o,_(o,!0),E.classList.add("jdropdown-focus"),s.getWindowWidth()<800&&(o.options.type==null||o.options.type=="picker")&&B.slideBottom(ce,1),o.options.autocomplete==!0&&(o.header.value=o.search,o.header.focus());var U=G();if(U[0]){var J=o.getPosition(U[0]);J!==!1&&o.setCursor(J)}if(!o.options.type||o.options.type=="default"){var v=E.getBoundingClientRect(),D=ce.getBoundingClientRect();o.options.position?(ce.style.position="fixed",window.innerHeight<v.bottom+D.height?(ce.style.top="",ce.style.bottom=window.innerHeight-v.top+1+"px"):(ce.style.top=v.bottom+"px",ce.style.bottom=""),ce.style.left=v.left+"px"):window.innerHeight<v.bottom+D.height?(ce.style.top="",ce.style.bottom=v.height+1+"px"):(ce.style.top="",ce.style.bottom=""),ce.style.minWidth=v.width+"px",o.options.maxWidth&&(ce.style.maxWidth=o.options.maxWidth),!o.items.length&&o.options.autocomplete==!0?fe.style.display="none":fe.style.display=""}}typeof o.options.onopen=="function"&&o.options.onopen(E)},o.close=function(U){return E.classList.contains("jdropdown-focus")&&(o.header.value=o.getText(),o.setCursor(),!U&&typeof o.options.onclose=="function"&&o.options.onclose(E),o.header.blur&&o.header.blur(),E.classList.remove("jdropdown-focus"),_(o,!1),w.current=null),o.getValue()},o.setCursor=function(U,J){if(o.currentIndex!=null&&o.items&&o.items[o.currentIndex]&&o.items[o.currentIndex].element.classList.remove("jdropdown-cursor"),U==null)o.currentIndex=null;else if(U=parseInt(U),o.items[U].element.parentNode&&(o.items[U].element.classList.add("jdropdown-cursor"),o.currentIndex=U,J!==!1&&o.items[o.currentIndex].element)){fe.scrollTop;var v=o.items[o.currentIndex].element;fe.scrollTop=v.offsetTop-v.scrollTop+v.clientTop-95}},o.resetCursor=o.setCursor,o.updateCursor=o.setCursor,o.reset=function(){o.setCursor(),o.setValue(null)},o.first=function(){o.options.lazyLoading===!0&&o.loadFirst();var U=fe.querySelectorAll(".jdropdown-item");if(U.length){var J=U[0].indexValue;o.setCursor(J)}},o.last=function(){o.options.lazyLoading===!0&&o.loadLast();var U=fe.querySelectorAll(".jdropdown-item");if(U.length){var J=U[U.length-1].indexValue;o.setCursor(J)}},o.next=function(U){var J=null;if(U){if(U.length==1){var v=o.currentIndex||-1;U=U.toLowerCase();var D=null,X=null,ue=fe.querySelectorAll(".jdropdown-item");if(ue.length){for(var K=0;K<ue.length;K++)if(ue[K].indexValue>v&&(D=o.items[ue[K].indexValue])&&(X=D.element.innerText[0])&&(X=X.toLowerCase(),U==X)){J=ue[K].indexValue;break}o.setCursor(J)}}}else if(o.currentIndex==null||o.currentIndex==null)o.first();else{var le=o.items[o.currentIndex].element,me=le.nextElementSibling;me?(me.classList.contains("jdropdown-group")&&(me=me.lastChild.firstChild),J=me.indexValue):le.parentNode.classList.contains("jdropdown-group-items")&&((me=le.parentNode.parentNode.nextElementSibling)&&(me.classList.contains("jdropdown-group")?me=me.lastChild.firstChild:me.classList.contains("jdropdown-item")?J=me.indexValue:me=null),me&&(J=me.indexValue)),J!==null&&o.setCursor(J)}},o.prev=function(){var U=null;if(o.currentIndex===null)o.first();else{var J=o.items[o.currentIndex].element,v=J.previousElementSibling;v?(v.classList.contains("jdropdown-group")&&(v=v.lastChild.lastChild),U=v.indexValue):J.parentNode.classList.contains("jdropdown-group-items")&&((v=J.parentNode.parentNode.previousElementSibling)&&(v.classList.contains("jdropdown-group")?v=v.lastChild.lastChild:v.classList.contains("jdropdown-item")?U=v.indexValue:v=null),v&&(U=v.indexValue))}U!==null&&o.setCursor(U)},o.loadFirst=function(){if(o.results)var U=o.results;else var U=o.items;var J=U.length||0;o.options.lazyLoading==!0&&J>200&&(J=200),fe.textContent="";for(var v=0;v<J;v++)U[v].group?(U[v].group.parentNode||fe.appendChild(U[v].group),U[v].group.lastChild.appendChild(U[v].element)):fe.appendChild(U[v].element);fe.scrollTop=0},o.loadLast=function(){if(o.results)var U=o.results;else var U=o.items;var J=U.length;if(J>200){J=J-200,fe.textContent="";for(var v=J;v<U.length;v++)U[v].group?(U[v].group.parentNode||fe.appendChild(U[v].group),U[v].group.lastChild.appendChild(U[v].element)):fe.appendChild(U[v].element);fe.scrollTop=fe.scrollHeight}},o.loadUp=function(){var U=!1;if(o.results)var J=o.results;else var J=o.items;var v=fe.querySelectorAll(".jdropdown-item"),D=v[0].indexValue;D=o.items[D];var X=J.indexOf(D)-1;if(X>0){for(var ue=0;X>0&&J[X]&&ue<200;)J[X].group?(J[X].group.parentNode||fe.insertBefore(J[X].group,fe.firstChild),J[X].group.lastChild.insertBefore(J[X].element,J[X].group.lastChild.firstChild)):fe.insertBefore(J[X].element,fe.firstChild),X--,ue++;U=!0}return U},o.loadDown=function(){var U=!1;if(o.results)var J=o.results;else var J=o.items;var v=fe.querySelectorAll(".jdropdown-item"),D=v[v.length-1].indexValue;D=o.items[D];var X=J.indexOf(D)+1;if(X<J.length){for(var ue=0;X<J.length&&J[X]&&ue<200;)J[X].group?(J[X].group.parentNode||fe.appendChild(J[X].group),J[X].group.lastChild.appendChild(J[X].element)):fe.appendChild(J[X].element),X++,ue++;U=!0}return U},Ge(),o};return w.keydown=function(E){var a=null;if(a=w.current){if(E.which==13||E.which==9)a.header.value&&a.currentIndex==null&&a.options.newOptions?a.add():(a.currentIndex==null&&a.options.autocomplete==!0&&a.header.value!=""&&a.find(a.header.value),a.selectIndex(a.currentIndex));else if(E.which==38)a.currentIndex==null?a.first():a.currentIndex>0&&a.prev(),E.preventDefault();else if(E.which==40)a.currentIndex==null?a.first():a.currentIndex+1<a.items.length&&a.next(),E.preventDefault();else if(E.which==36)a.first(),E.target.classList.contains("jdropdown-header")||E.preventDefault();else if(E.which==35)a.last(),E.target.classList.contains("jdropdown-header")||E.preventDefault();else if(E.which==27)a.close();else if(E.which==33){if(a.currentIndex==null)a.first();else if(a.currentIndex>0)for(var o=0;o<7;o++)a.prev();E.preventDefault()}else if(E.which==34){if(a.currentIndex==null)a.first();else if(a.currentIndex+1<a.items.length)for(var o=0;o<7;o++)a.next();E.preventDefault()}}},w.mouseup=function(E){var a=s.findElement(E.target,"jdropdown");if(a){var o=a.dropdown;if(E.target.classList.contains("jdropdown-header"))if(a.classList.contains("jdropdown-focus")&&a.classList.contains("jdropdown-default")){var P=a.getBoundingClientRect();if(E.changedTouches&&E.changedTouches[0]){var ee=E.changedTouches[0].clientX;E.changedTouches[0].clientY}else{var ee=E.clientX;E.clientY}P.width-(ee-P.left)<30?E.target.classList.contains("jdropdown-add")?o.add():o.close():o.options.autocomplete==!1&&o.close()}else o.open();else if(E.target.classList.contains("jdropdown-group-name")){var te=E.target.nextSibling.children;if(E.target.nextSibling.style.display!="none")for(var S=0;S<te.length;S++)te[S].style.display!="none"&&o.selectItem(te[S])}else E.target.classList.contains("jdropdown-group-arrow")?E.target.classList.contains("jdropdown-group-arrow-down")?(E.target.classList.remove("jdropdown-group-arrow-down"),E.target.classList.add("jdropdown-group-arrow-up"),E.target.parentNode.nextSibling.style.display="none"):(E.target.classList.remove("jdropdown-group-arrow-up"),E.target.classList.add("jdropdown-group-arrow-down"),E.target.parentNode.nextSibling.style.display=""):E.target.classList.contains("jdropdown-item")?o.selectItem(E.target):E.target.classList.contains("jdropdown-image")||E.target.classList.contains("jdropdown-description")?o.selectItem(E.target.parentNode):E.target.classList.contains("jdropdown-title")?o.selectItem(E.target.parentNode.parentNode):(E.target.classList.contains("jdropdown-close")||E.target.classList.contains("jdropdown-backdrop"))&&o.close()}},w.extractFromDom=function(E,a){var o=E;if(a||(a={}),E.getAttribute("multiple")&&(!a||a.multiple==null)&&(a.multiple=!0),E.getAttribute("placeholder")&&(!a||a.placeholder==null)&&(a.placeholder=E.getAttribute("placeholder")),E.getAttribute("data-autocomplete")&&(!a||a.autocomplete==null)&&(a.autocomplete=!0),(!a||a.width==null)&&(a.width=E.offsetWidth),E.value&&(!a||a.value==null)&&(a.value=E.value),!a||a.data==null){a.data=[];for(var P=0;P<E.children.length;P++)if(E.children[P].tagName=="OPTGROUP")for(var ee=0;ee<E.children[P].children.length;ee++)a.data.push({value:E.children[P].children[ee].value,text:E.children[P].children[ee].textContent,group:E.children[P].getAttribute("label")});else a.data.push({value:E.children[P].value,text:E.children[P].textContent})}(!a||a.onchange==null)&&(a.onchange=function(S,M,V,G){a.multiple==!0?obj.items[M].classList.contains("jdropdown-selected")?o.options[M].setAttribute("selected","selected"):o.options[M].removeAttribute("selected"):o.value=G});var te=document.createElement("div");return E.parentNode.insertBefore(te,E),E.style.display="none",E=te,{el:E,options:a}},w}var Ye=Pe();function Ve(w,E){if(w.picker)return w.picker.setOptions(E,!0);var a={type:"picker"};a.options={};var o=null,P=null,ee=function(M){return M instanceof Element||M instanceof HTMLDocument},te=function(){P.innerHTML="";for(var M=Object.keys(a.options.data),V=0;V<M.length;V++){var G=document.createElement("div");G.classList.add("jpicker-item"),G.setAttribute("role","option"),G.k=M[V],G.v=a.options.data[M[V]];var oe=a.getLabel(M[V],G);ee(oe)?G.appendChild(oe):G.innerHTML=oe,P.appendChild(G)}};a.setOptions=function(M,V){var G={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};M&&M.options&&(M.data=M.options);for(var oe in G)M&&M.hasOwnProperty(oe)?a.options[oe]=M[oe]:(typeof a.options[oe]>"u"||V===!0)&&(a.options[oe]=G[oe]);return a.options.header===!1?o.style.display="none":o.style.display="",a.options.width?o.style.width=parseInt(a.options.width)+"px":o.style.width="",a.options.height?(P.style.maxHeight=a.options.height+"px",P.style.overflow="scroll"):P.style.overflow="",a.options.columns>0&&(a.options.grid?(P.classList.add("jpicker-grid"),P.style.gridTemplateColumns="repeat("+a.options.grid+", 1fr)"):(P.classList.add("jpicker-columns"),P.style.width=a.options.width?a.options.width:36*a.options.columns+"px")),isNaN(parseInt(a.options.value))&&(a.options.value=0),te(),a.setValue(a.options.value),a},a.getValue=function(){return a.options.value},a.setValue=function(M,V){if(a.setLabel(M),a.options.value=String(M),w.value!=a.options.value&&(w.value=a.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),P.children[M]&&P.children[M].getAttribute("type")!=="generic"&&a.close(),V&&typeof a.options.onchange=="function"){var G=a.options.data[M];a.options.onchange(w,a,G,G,M,V)}},a.getLabel=function(M,V){var G=a.options.data[M]||null;return typeof a.options.render=="function"&&(G=a.options.render(G,V)),G},a.setLabel=function(M){var V;a.options.content?V='<i class="material-icons">'+a.options.content+"</i>":V=a.getLabel(M,null),ee(V)?(o.innerHTML="",o.appendChild(V)):o.innerHTML=V},a.open=function(){if(!w.classList.contains("jpicker-focus")){_(a,!0),w.classList.add("jpicker-focus"),w.focus();var M=0,V=0;P.style.marginLeft="";var G=o.getBoundingClientRect(),oe=P.getBoundingClientRect();window.innerHeight<G.bottom+oe.height||a.options.bottom?M=-1*(oe.height+4):M=G.height+4,a.options.right===!0&&(V=-1*oe.width+G.width),oe.left+V<0&&(V=V+oe.left+10),oe.left+oe.width>window.innerWidth&&(V=-1*(10+oe.left+oe.width-window.innerWidth)),P.style.marginTop=parseInt(M)+"px",P.style.marginLeft=parseInt(V)+"px",typeof a.options.onopen=="function"&&a.options.onopen(w,a)}},a.close=function(){w.classList.contains("jpicker-focus")&&(w.classList.remove("jpicker-focus"),_(a,!1),typeof a.options.onclose=="function"&&a.options.onclose(w,a))};var S=function(){let M=s.guid();w.classList.add("jpicker"),w.setAttribute("role","combobox"),w.setAttribute("aria-haspopup","listbox"),w.setAttribute("aria-expanded","false"),w.setAttribute("aria-controls",M),w.setAttribute("tabindex","0"),w.onmousedown=function(V){w.classList.contains("jpicker-focus")||a.open()},o=document.createElement("div"),o.classList.add("jpicker-header"),P=document.createElement("div"),P.setAttribute("id",M),P.setAttribute("role","listbox"),P.classList.add("jpicker-content"),P.onclick=function(V){var G=s.findElement(V.target,"jpicker-item");G&&G.parentNode===P&&a.setValue(G.k,V)},w.appendChild(o),w.appendChild(P),w.value=E.value||0,a.setOptions(E),typeof a.options.onload=="function"&&a.options.onload(w,a),w.change=a.setValue,w.val=function(V){if(V===void 0)return a.getValue();a.setValue(V)},w.picker=a};return S(),a}function He(w,E){var a={type:"toolbar"};a.options={};var o={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var P in o)E&&E.hasOwnProperty(P)?a.options[P]=E[P]:a.options[P]=o[P];!w&&E.app&&E.app.el&&(w=document.createElement("div"),E.app.el.appendChild(w));var ee=document.createElement("div");ee.classList.add("jtoolbar-item"),ee.classList.add("jtoolbar-arrow");var te=document.createElement("div");te.classList.add("jtoolbar-floating"),ee.appendChild(te),a.selectItem=function(M){for(var V=S.children,G=0;G<V.length;G++)M!=V[G]&&V[G].classList.remove("jtoolbar-selected");M.classList.add("jtoolbar-selected")},a.hide=function(){B.slideBottom(w,0,function(){w.style.display="none"})},a.show=function(){w.style.display="",B.slideBottom(w,1)},a.get=function(){return w},a.setBadge=function(M,V){S.children[M].children[1].firstChild.innerHTML=V},a.destroy=function(){toolbar.remove(),w.innerHTML=""},a.update=function(M,V){for(var G=0;G<S.children.length;G++){var oe=S.children[G];typeof oe.updateState=="function"&&oe.updateState(w,a,oe,M,V)}for(var G=0;G<te.children.length;G++){var oe=te.children[G];typeof oe.updateState=="function"&&oe.updateState(w,a,oe,M,V)}},a.create=function(M){S.innerHTML="";for(var V=0;V<M.length;V++){var G=document.createElement("div");if(G.classList.add("jtoolbar-item"),M[V].width&&(G.style.width=parseInt(M[V].width)+"px"),M[V].k&&(G.k=M[V].k),M[V].tooltip&&(G.setAttribute("title",M[V].tooltip),G.setAttribute("aria-label",M[V].tooltip)),M[V].id&&G.setAttribute("id",M[V].id),M[V].updateState&&(G.updateState=M[V].updateState),M[V].active&&G.classList.add("jtoolbar-active"),M[V].disabled&&G.classList.add("jtoolbar-disabled"),M[V].type=="select"||M[V].type=="dropdown")Ve(G,M[V]);else if(M[V].type=="divisor")G.classList.add("jtoolbar-divisor");else if(M[V].type=="label")G.classList.add("jtoolbar-label"),G.innerHTML=M[V].content;else{var oe=document.createElement("i");if(typeof M[V].class>"u")oe.classList.add("material-icons");else for(var pe=M[V].class.split(" "),ce=0;ce<pe.length;ce++)oe.classList.add(pe[ce]);if(oe.innerHTML=M[V].content?M[V].content:"",G.setAttribute("role","button"),G.appendChild(oe),a.options.badge==!0){var fe=document.createElement("div");fe.classList.add("jbadge");var Ee=document.createElement("div");Ee.innerHTML=M[V].badge?M[V].badge:"",fe.appendChild(Ee),G.appendChild(fe)}if(M[V].title)if(a.options.title==!0){var Ie=document.createElement("span");Ie.innerHTML=M[V].title,G.appendChild(Ie)}else G.setAttribute("title",M[V].title);a.options.app&&M[V].route&&(G.route=M[V].route,G.onclick=function(){a.options.app.pages(this.route)},a.options.app.pages(M[V].route,{toolbarItem:G,closed:!0})),typeof M[V].render=="function"&&M[V].render(G,M[V])}M[V].onclick&&(G.onclick=M[V].onclick.bind(M[V],w,a,G)),S.appendChild(G)}setTimeout(function(){a.refresh()},0)},a.open=function(){ee.classList.add("jtoolbar-arrow-selected"),w.getBoundingClientRect();var M=te.getBoundingClientRect();M.bottom>window.innerHeight||a.options.bottom?te.style.bottom="0":te.style.removeProperty("bottom"),te.style.right="0",ee.children[0].focus(),_(a,!0)},a.close=function(){ee.classList.remove("jtoolbar-arrow-selected"),_(a,!1)},a.refresh=function(){if(a.options.responsive==!0){var M=w.parentNode.getBoundingClientRect();a.options.maxWidth||(a.options.maxWidth=M.width);var V=parseInt(a.options.maxWidth);for(ee.parentNode&&ee.parentNode.removeChild(ee);te.firstChild;)S.appendChild(te.firstChild);if(V<S.offsetWidth)for(V-=50;S.lastChild&&V<S.offsetWidth;)te.insertBefore(S.lastChild,te.firstChild);te.children.length>0&&S.appendChild(ee)}},a.setReadonly=function(M){M=M?"add":"remove",w.classList[M]("jtoolbar-disabled")},w.onclick=function(M){var V=s.findElement(M.target,"jtoolbar-item");V&&a.selectItem(V),M.target.classList.contains("jtoolbar-arrow")&&a.open()},window.addEventListener("resize",function(){a.refresh()}),w.classList.add("jtoolbar"),w.innerHTML="",a.options.container==!0&&w.classList.add("jtoolbar-container");var S=document.createElement("div");return w.appendChild(S),a.options.app&&w.classList.add("jtoolbar-mobile"),a.create(a.options.items),w.toolbar=a,a}function ut(){var w=function(E,a){var o={type:"editor"};o.options={};var P={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var ee in P)a&&a.hasOwnProperty(ee)?o.options[ee]=a[ee]:o.options[ee]=P[ee];var te=null,S=null,M=[];o.el=E,typeof o.options.onclick=="function"&&(E.onclick=function(ne){o.options.onclick(E,o,ne)}),E.classList.add("jeditor-container");var V=document.createElement("div");V.className="jsnippet",V.setAttribute("contenteditable",!1);var G=document.createElement("div");if(G.className="jeditor-toolbar",o.editor=document.createElement("div"),o.editor.setAttribute("contenteditable",!0),o.editor.setAttribute("spellcheck",!1),o.editor.classList.add("jeditor"),o.options.placeholder&&o.editor.setAttribute("data-placeholder",o.options.placeholder),(o.options.maxHeight||o.options.height)&&(o.editor.style.overflowY="auto",o.options.maxHeight&&(o.editor.style.maxHeight=o.options.maxHeight),o.options.height&&(o.editor.style.height=o.options.height)),o.options.url)T({url:o.options.url,dataType:"html",success:function(ne){o.editor.innerHTML=ne,w.setCursor(o.editor,o.options.focus=="initial")}});else if(o.options.value)o.editor.innerHTML=o.options.value;else for(var oe=0;oe<E.children.length;oe++)o.editor.appendChild(E.children[oe]);E.innerHTML="";var pe=function(ne){typeof o.options.onchange=="function"&&o.options.onchange(E,o,ne),o.options.value=o.getData(),E.value!=o.options.value&&(E.value=o.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},ce=function(ne){var ve=document.createElement("div");ve.innerHTML=ne;var ye=ve.querySelectorAll("img");if(ye.length)for(var ke=0;ke<ye.length;ke++)o.addImage(ye[ke].src)},fe=function(){var ne=null;if(ne=V.children[0]){ne.classList.contains("jslider-grid")||ne.classList.add("jslider-grid");var ve=ne.children.length;ne.setAttribute("data-number",ve>4?4:ve),ve>4?ne.setAttribute("data-total",ve-4):ne.removeAttribute("data-total")}},Ee=function(ne){V.innerHTML||o.appendSnippet({}),V.children[0].appendChild(ne),fe()};o.appendSnippet=function(ne){V.innerHTML="";for(var ve=["image","title","description","host","url"],ye=0;ye<ve.length;ye++){var ke=document.createElement("div");if(ke.className="jsnippet-"+ve[ye],ke.setAttribute("data-k",ve[ye]),V.appendChild(ke),ne[ve[ye]])if(ve[ye]=="image"){Array.isArray(ne.image)||(ne.image=[ne.image]);for(var Xe=0;Xe<ne.image.length;Xe++){var Ke=document.createElement("img");Ke.src=ne.image[Xe],ke.appendChild(Ke)}}else ke.innerHTML=ne[ve[ye]]}o.editor.appendChild(document.createElement("br")),o.editor.appendChild(V)},o.setData=function(ne){typeof ne=="object"?o.editor.innerHTML=ne.content:o.editor.innerHTML=ne,o.options.focus&&w.setCursor(o.editor,!0),M=[]},o.getFiles=function(){for(var ne=o.editor.querySelectorAll(".jfile"),ve=[],ye=0;ye<ne.length;ye++)M[ne[ye].src]&&ve.push(M[ne[ye].src]);return ve},o.getText=function(){return o.editor.innerText},o.getData=function(ne){if(ne){var ve={content:""};if(V.innerHTML){ve.snippet={};for(var ye=0;ye<V.children.length;ye++){var ke=V.children[ye].getAttribute("data-k");if(ke)if(ke=="image"){ve.snippet.image||(ve.snippet.image=[]);for(var Xe=0;Xe<V.children[ye].children.length;Xe++)ve.snippet.image.push(V.children[ye].children[Xe].getAttribute("src"))}else ve.snippet[ke]=V.children[ye].innerHTML}}var Ke=Object.keys(M);if(Ke.length){ve.files=[];for(var ye=0;ye<Ke.length;ye++)ve.files.push(M[Ke[ye]])}var lt=document.createElement("div");lt.innerHTML=o.editor.innerHTML;var ft=lt.querySelector(".jsnippet");ft&&ft.remove();var Qe=lt.innerHTML;Qe=Qe.replace(/<br>/g,`
`),Qe=Qe.replace(/<\/div>/g,`</div>
`),Qe=Qe.replace(/<(?:.|\n)*?>/gm,""),ve.content=Qe.trim(),De("getData",ve)}else var ve=o.editor.innerHTML;return ve},o.reset=function(){o.editor.innerHTML="",V.innerHTML="",M=[]},o.addPdf=function(ne){if(ne.result.substr(0,4)!="data")console.error("Invalid source");else{var ve=document.createElement("canvas");ve.width=60,ve.height=60;var ye=new Image,ke=ve.getContext("2d");ke.drawImage(ye,0,0,ve.width,ve.height),ve.toBlob(function(Xe){var Ke=document.createElement("img");Ke.src=window.URL.createObjectURL(Xe),Ke.title=ne.name,Ke.className="jfile pdf",M[Ke.src]={file:Ke.src,extension:"pdf",content:ne.result},document.execCommand("insertHtml",!1,Ke.outerHTML)})}},o.addImage=function(ne,ve){if(o.options.acceptImages)if(ne||(ne=""),ne.substr(0,4)!="data"&&!o.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(ne.substr(0,4)=="data"){var ye=ne.split(";");ye=ye[0].split("/"),ye=ye[1]}else{var ye=ne.substr(ne.lastIndexOf(".")+1);ne=o.options.remoteParser+ne}var ke=new Image;ke.onload=function(){var Ke=document.createElement("canvas");Ke.width=ke.width,Ke.height=ke.height;var lt=Ke.getContext("2d");lt.drawImage(ke,0,0,Ke.width,Ke.height),Ke.toBlob(function(ft){var Qe=document.createElement("img");Qe.src=window.URL.createObjectURL(ft),Qe.classList.add("jfile"),Qe.setAttribute("tabindex","900"),Qe.setAttribute("width",ke.width),Qe.setAttribute("height",ke.height),M[Qe.src]={file:Qe.src,extension:ye,content:Ke.toDataURL()},o.options.dropAsSnippet||ve?(Ee(Qe),M[Qe.src].snippet=!0):document.execCommand("insertHtml",!1,Qe.outerHTML),pe()})},ke.src=ne}},o.addFile=function(ne){for(var ve=[],ye=0;ye<ne.length;ye++)if(ne[ye].size>o.options.maxFileSize)alert("The file is too big");else{var ke=ne[ye].type.split("/");ke[0]=="image"?ke=1:ke[1]=="pdf"?ke=2:ke=0,ke?(ve[ye]=new FileReader,ve[ye].index=ye,ve[ye].type=ke,ve[ye].name=ne[ye].name,ve[ye].date=ne[ye].lastModified,ve[ye].size=ne[ye].size,ve[ye].addEventListener("load",function(Xe){Xe.target.type==2?o.options.acceptFiles==!0&&o.addPdf(Xe.target):o.addImage(Xe.target.result)},!1),ve[ye].readAsDataURL(ne[ye])):alert("The extension is not allowed")}},o.destroy=function(){o.editor.removeEventListener("mouseup",me),o.editor.removeEventListener("mousedown",Me),o.editor.removeEventListener("mousemove",xe),o.editor.removeEventListener("keyup",K),o.editor.removeEventListener("keydown",le),o.editor.removeEventListener("dragstart",U),o.editor.removeEventListener("dragenter",J),o.editor.removeEventListener("dragover",v),o.editor.removeEventListener("drop",D),o.editor.removeEventListener("paste",we),o.editor.removeEventListener("blur",X),o.editor.removeEventListener("focus",ue),E.editor=null,E.classList.remove("jeditor-container"),G.remove(),V.remove(),o.editor.remove()},o.upload=function(){s.click(o.file)};const Ie=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],Se=["width","height","align","border","src","tabindex"],ze=["color","font-weight","font-size","background","background-color","margin"],Ge=function(ne){if(ne.tagName&&Ie.indexOf(ne.tagName.toLowerCase())===-1&&ne.innerText&&(ne.innerHTML=ne.innerText),ne.attributes&&ne.attributes.length){let ve=null,ye=ne.getAttribute("style");if(ye){ve=[];let Xe=ye.split(";");for(let Ke=0;Ke<Xe.length;Ke++){let lt=Xe[Ke].trim().split(":");if(ze.indexOf(lt[0].trim())>=0){let ft=lt.shift();lt=lt.join(":"),ve.push(ft+":"+lt)}}}ne.tagName.toUpperCase()==="IMG"&&(!o.options.acceptImages||!ne.src?ne.parentNode.removeChild(ne):(ne.setAttribute("tabindex","900"),o.addImage(ne.src)));let ke=[];for(let Xe=0;Xe<ne.attributes.length;Xe++)ke.push(ne.attributes[Xe].name);ke.length&&ke.forEach(function(Xe){Se.indexOf(Xe)===-1?ne.removeAttribute(Xe):ne.attributes&&ne.attributes[oe]&&ne.attributes[oe].value.indexOf("<")!==-1&&ne.attributes[oe].value.replace("<","&#60;")}),ne.style="",ve&&ve.length&&ne.setAttribute("style",ve.join(";"))}if(ne.children.length)for(let ve=ne.children.length;ve>0;ve--)Ge(ne.children[ve-1])};var Q=function(ne){var ve=window.getSelection(),ye=document.createRange();ye.selectNode(ne),ve.addRange(ye)},he=function(ne){ne&&(ne=ne.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ve=new DOMParser,ye=ve.parseFromString(ne,"text/html");Ge(ye);var ke=document.createElement("div");return ke.innerHTML=ye.firstChild.innerHTML,ke},we=function(ne){if(o.options.filterPaste==!0){if(ne.clipboardData||ne.originalEvent.clipboardData)var ve=(ne.originalEvent||ne).clipboardData.getData("text/html"),ye=(ne.originalEvent||ne).clipboardData.getData("text/plain"),ke=(ne.originalEvent||ne).clipboardData.files;else if(window.clipboardData)var ve=window.clipboardData.getData("Html"),ye=window.clipboardData.getData("Text"),ke=window.clipboardData.files;if(ke.length)o.addFile(ke);else if(!ve)ve=ye.split(`\r
`),ne.target.innerText?(ve=ve.map(function(Ke){return"<div>"+Ke+"</div>"}),document.execCommand("insertText",!1,ve.join(""))):ve.map(function(Ke){var lt=document.createElement("div");lt.innerText=Ke,o.editor.appendChild(lt)});else{var Xe=he(ve);document.execCommand("insertHtml",!1,Xe.innerHTML)}ne.preventDefault()}},U=function(ne){S&&S.e&&ne.preventDefault()},J=function(ne){S||o.options.dropZone==!1||(E.classList.add("jeditor-dragging"),ne.preventDefault())},v=function(ne){S||o.options.dropZone==!1||(te&&clearTimeout(te),te=setTimeout(function(){E.classList.remove("jeditor-dragging")},100),ne.preventDefault())},D=function(ne){if(!(S||o.options.dropZone==!1)){var ve=null;document.caretRangeFromPoint?ve=document.caretRangeFromPoint(ne.clientX,ne.clientY):ne.rangeParent&&(ve=document.createRange(),ve.setStart(ne.rangeParent,ne.rangeOffset));var ye=window.getSelection();ye.removeAllRanges(),ye.addRange(ve),ye.anchorNode.parentNode.focus();var ke=(ne.originalEvent||ne).dataTransfer.getData("text/html"),Xe=(ne.originalEvent||ne).dataTransfer.getData("text/plain"),Ke=(ne.originalEvent||ne).dataTransfer.files;Ke.length?o.addFile(Ke):Xe&&ce(ke),E.classList.remove("jeditor-dragging"),ne.preventDefault()}},X=function(ne){De("onevent",ne),pe(ne),typeof o.options.onblur=="function"&&o.options.onblur(E,o,ne)},ue=function(ne){typeof o.options.onfocus=="function"&&o.options.onfocus(E,o,ne)},K=function(ne){o.editor.innerHTML||(o.editor.innerHTML="<div><br></div>"),typeof o.options.onkeyup=="function"&&o.options.onkeyup(E,o,ne)},le=function(ne){if(De("onevent",ne),ne.key=="Delete"&&ne.target.tagName=="IMG"){var ve=ne.target.parentNode;Q(ne.target),ve.classList.contains("jsnippet-image")&&fe()}typeof o.options.onkeydown=="function"&&o.options.onkeydown(E,o,ne)},me=function(ne){if(S&&S.e&&(S.e.classList.remove("resizing"),S.e.changed==!0)){var ve=S.e.cloneNode();ve.width=parseInt(S.e.style.width)||S.e.getAttribute("width"),ve.height=parseInt(S.e.style.height)||S.e.getAttribute("height"),S.e.style.width="",S.e.style.height="",Q(S.e),document.execCommand("insertHtml",!1,ve.outerHTML)}S=!1},Me=function(ne){var ve=function(Ke){var lt=Ke.getBoundingClientRect();lt.width-(ne.clientX-lt.left)<40&&ne.clientY-lt.top<40&&(Ke.innerHTML="",Ke.remove())};if(ne.target.tagName=="IMG")if(ne.target.style.cursor){var ye=ne.target.getBoundingClientRect();S={e:ne.target,x:ne.clientX,y:ne.clientY,w:ye.width,h:ye.height,d:ne.target.style.cursor},ne.target.getAttribute("width")||ne.target.setAttribute("width",ye.width),ne.target.getAttribute("height")||ne.target.setAttribute("height",ye.height);var ke=window.getSelection();if(ke.rangeCount)for(var Xe=0;Xe<ke.rangeCount;Xe++)ke.removeRange(ke.getRangeAt(Xe));ne.target.classList.add("resizing")}else S=!0;else ne.target.classList.contains("jsnippet")?ve(ne.target):ne.target.parentNode.classList.contains("jsnippet")&&ve(ne.target.parentNode),S=!0},xe=function(ne){if(ne.target.tagName=="IMG"&&!ne.target.parentNode.classList.contains("jsnippet-image")&&o.options.allowImageResize==!0&&ne.target.getAttribute("tabindex")){var ve=ne.target.getBoundingClientRect();ne.clientY-ve.top<5?ve.width-(ne.clientX-ve.left)<5?ne.target.style.cursor="ne-resize":ne.clientX-ve.left<5?ne.target.style.cursor="nw-resize":ne.target.style.cursor="n-resize":ve.height-(ne.clientY-ve.top)<5?ve.width-(ne.clientX-ve.left)<5?ne.target.style.cursor="se-resize":ne.clientX-ve.left<5?ne.target.style.cursor="sw-resize":ne.target.style.cursor="s-resize":ve.width-(ne.clientX-ve.left)<5?ne.target.style.cursor="e-resize":ne.clientX-ve.left<5?ne.target.style.cursor="w-resize":ne.target.style.cursor=""}if(ne.which==1&&S&&S.d){if(S.d=="e-resize"||S.d=="ne-resize"||S.d=="se-resize")if(S.e.style.width=S.w+(ne.clientX-S.x),ne.shiftKey){var ye=(ne.clientX-S.x)*(S.h/S.w);S.e.style.height=S.h+ye}else var ye=null;ye||(S.d=="s-resize"||S.d=="se-resize"||S.d=="sw-resize")&&(ne.shiftKey||(S.e.style.height=S.h+(ne.clientY-S.y))),S.e.changed=!0}},De=function(ne,ve){if(o.options.extensions){var ye=Object.keys(o.options.extensions);if(ye.length)for(var ke=0;ke<ye.length;ke++)o.options.extensions[ye[ke]]&&typeof o.options.extensions[ye[ke]][ne]=="function"&&o.options.extensions[ye[ke]][ne].call(o,ve)}},Fe=function(){if(o.options.extensions){var ne=Object.keys(o.options.extensions);if(ne.length)for(var ve=0;ve<ne.length;ve++)o.options.extensions[ne[ve]]&&typeof o.options.extensions[ne[ve]]=="function"&&(o.options.extensions[ne[ve]]=o.options.extensions[ne[ve]](E,o))}};if(document.addEventListener("mouseup",me),document.addEventListener("mousemove",xe),o.editor.addEventListener("mousedown",Me),o.editor.addEventListener("keyup",K),o.editor.addEventListener("keydown",le),o.editor.addEventListener("dragstart",U),o.editor.addEventListener("dragenter",J),o.editor.addEventListener("dragover",v),o.editor.addEventListener("drop",D),o.editor.addEventListener("paste",we),o.editor.addEventListener("focus",ue),o.editor.addEventListener("blur",X),E.appendChild(o.editor),o.options.snippet&&o.appendSnippet(o.options.snippet),o.options.toolbar){if(Array.isArray(o.options.toolbar))var $e={container:!0,responsive:!0,items:o.options.toolbar};else if(o.options.toolbar===!0)var $e={container:!0,responsive:!0,items:[]};else var $e=o.options.toolbar;$e.items&&$e.items.length||($e.items=w.getDefaultToolbar(o)),o.options.toolbarOnTop?(E.classList.add("toolbar-on-top"),E.insertBefore(G,E.firstChild)):(o.editor.style.padding="15px",E.appendChild(G)),He(G,$e),G.addEventListener("click",function(){o.editor.focus()})}return o.file=document.createElement("input"),o.file.style.display="none",o.file.type="file",o.file.setAttribute("accept","image/*"),o.file.onchange=function(){o.addFile(this.files)},E.appendChild(o.file),o.options.focus&&w.setCursor(o.editor,o.options.focus=="initial"),E.change=o.setData,E.val=function(ne){if(ne===void 0){var ve=E.getAttribute("data-html")!=="true";return o.getData(ve)}else o.setData(ne)},Fe(),E.editor=o,typeof o.options.onload=="function"&&o.options.onload(E,o,o.editor),o};return w.setCursor=function(E,a){E.focus(),document.execCommand("selectAll");var o=window.getSelection(),P=o.getRangeAt(0);if(a==!0)var ee=P.startContainer,te=0;else var ee=P.endContainer,te=ee.length;P.setStart(ee,te),P.setEnd(ee,te),o.removeAllRanges(),o.addRange(P)},w.getDefaultToolbar=function(E){var a=function(P,ee,te){te.color||(Ae(te,{onchange:function(S,M){te.k==="color"?document.execCommand("foreColor",!1,M):document.execCommand("backColor",!1,M)}}),te.color.open())},o=[];return o.push({content:"undo",onclick:function(){document.execCommand("undo")}}),o.push({content:"redo",onclick:function(){document.execCommand("redo")}}),o.push({type:"divisor"}),E.options.toolbarOnTop&&(o.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(P){return'<span style="font-family:'+P+'">'+P+"</span>"},onchange:function(P,ee,te,S,M){document.execCommand("fontName",!1,S)}}),o.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(P){return'<span style="font-size:'+P+'">'+P+"</span>"},onchange:function(P,ee,te,S,M){document.execCommand("fontSize",!1,parseInt(M)+1)}}),o.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(P){return'<i class="material-icons">'+P+"</i>"},onchange:function(P,ee,te,S,M){var V=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(V[M])}}),o.push({type:"divisor"}),o.push({content:"format_color_text",k:"color",onclick:a}),o.push({content:"format_color_fill",k:"background-color",onclick:a})),o.push({content:"format_bold",onclick:function(P,ee,te){document.execCommand("bold"),document.queryCommandState("bold")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_italic",onclick:function(P,ee,te){document.execCommand("italic"),document.queryCommandState("italic")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_underline",onclick:function(P,ee,te){document.execCommand("underline"),document.queryCommandState("underline")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({type:"divisor"}),o.push({content:"format_list_bulleted",onclick:function(P,ee,te){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_list_numbered",onclick:function(P,ee,te){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_indent_increase",onclick:function(P,ee,te){document.execCommand("indent",!0,null),document.queryCommandState("indent")?te.classList.add("selected"):te.classList.remove("selected")}}),o.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),E.options.toolbarOnTop&&(o.push({type:"divisor"}),o.push({content:"photo",onclick:function(){E.upload()}}),o.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(P,ee){ee&&(ee.onmouseover=this.onmouseover,P=P.split("x"),ee.setAttribute("data-x",P[0]),ee.setAttribute("data-y",P[1]));var te=document.createElement("div");return ee.style.margin="1px",ee.style.border="1px solid #ddd",te},onmouseover:function(P){for(var ee=parseInt(P.target.getAttribute("data-x")),te=parseInt(P.target.getAttribute("data-y")),S=0;S<P.target.parentNode.children.length;S++){var M=P.target.parentNode.children[S],V=parseInt(M.getAttribute("data-x")),G=parseInt(M.getAttribute("data-y"));V<=ee&&G<=te?(M.style.backgroundColor="#cae1fc",M.style.borderColor="#2977ff"):(M.style.backgroundColor="",M.style.borderColor="#ddd")}},onchange:function(P,ee,te){te=te.split("x");for(var S=document.createElement("table"),M=document.createElement("tbody"),V=0;V<=te[1];V++){for(var G=document.createElement("tr"),oe=0;oe<=te[0];oe++){var pe=document.createElement("td");pe.innerHTML="",G.appendChild(pe)}M.appendChild(G)}S.appendChild(M),S.setAttribute("width","100%"),S.setAttribute("cellpadding","6"),S.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,S.outerHTML)}})),o},w}var Y=ut();function Ne(){var w=function(E,a){var o={};o.options={};var P={type:"big",title:"Untitled",width:510,height:472};for(var ee in P)a&&a.hasOwnProperty(ee)?o.options[ee]=a[ee]:o.options[ee]=P[ee];var te=function(){for(var V=document.createElement("div");E.children[0];)V.appendChild(E.children[0]);for(o.content=document.createElement("div"),o.content.className="jfloating_content",o.content.innerHTML=E.innerHTML;V.children[0];)o.content.appendChild(V.children[0]);o.container=document.createElement("div"),o.container.className="jfloating",o.container.appendChild(o.content),o.options.title?o.container.setAttribute("title",o.options.title):o.container.classList.add("no-title"),o.options.width&&(o.container.style.width=parseInt(o.options.width)+"px"),o.options.height&&(o.container.style.height=parseInt(o.options.height)+"px"),E.innerHTML="",E.appendChild(o.container)},S=function(){o.container&&o.container.addEventListener("click",function(V){var G=V.target.getBoundingClientRect();if(V.target.classList.contains("jfloating")){if(V.changedTouches&&V.changedTouches[0])var oe=V.changedTouches[0].clientX,pe=V.changedTouches[0].clientY;else var oe=V.clientX,pe=V.clientY;G.width-(oe-G.left)<50&&pe-G.top<50?setTimeout(function(){o.close()},100):o.setState()}})},M=function(){o.container.classList.add("jfloating-"+o.options.type)};return o.state={isMinized:!1},o.setState=function(){o.state.isMinized?o.container.classList.remove("jfloating-minimized"):o.container.classList.add("jfloating-minimized"),o.state.isMinized=!o.state.isMinized},o.close=function(){Components.elements.splice(w.elements.indexOf(o.container),1),o.updatePosition(),E.remove()},o.updatePosition=function(){for(var V=0;V<w.elements.length;V++){var G=w.elements[V],oe=w.elements[V-1];G.style.right=V*(oe?oe.offsetWidth:G.offsetWidth)*1.01+"px"}},o.init=function(){te(),S(),M(),w.elements.push(o.container),o.updatePosition(),E.floating=o},o.init(),o};return w.elements=[],w}var qe=Ne();function mt(){const w=function(S){return!isNaN(S)&&S!==null&&(typeof S!="string"||S.trim()!=="")},E={between:function(S,M){return S>=M[0]&&S<=M[1]},"not between":function(S,M){return S<M[0]||S>M[1]},"<":function(S,M){return S<M[0]},"<=":function(S,M){return S<=M[0]},">":function(S,M){return S>M[0]},">=":function(S,M){return S>=M[0]},"=":function(S,M){return S==M[0]},"!=":function(S,M){return S!=M[0]}},a={"valid date":function(){return!0},"=":function(S,M){return S===M[0]},"!=":function(S,M){return S!==M[0]},"<":function(S,M){return S<M[0]},"<=":function(S,M){return S<=M[0]},">":function(S,M){return S>M[0]},">=":function(S,M){return S>=M[0]},between:function(S,M){return S>=M[0]&&S<=M[1]},"not between":function(S,M){return S<M[0]||S>M[1]}},o={contains:function(S,M){return S.includes(M[0])},"not contains":function(S,M){return!S.includes(M[0])},"begins with":function(S,M){return S.startsWith(M[0])},"ends with":function(S,M){return S.endsWith(M[0])},"=":function(S,M){return S===M[0]},"!=":function(S,M){return S!==M[0]},"valid email":function(S){var M=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return M.test(S)},"valid url":function(S){var M=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return M.test(S)}},P=function(S,M){return typeof P[M.type]=="function"?M.allowBlank&&(typeof S>"u"||S===""||S===null)?!0:P[M.type].call(this,S,M):null};P.url=function(S){var M=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!M.test(S)},P.email=function(S){var M=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(S&&M.test(S))},P.required=function(S){return!!(S&&S.trim())},P.empty=function(S){return typeof S>"u"||S===null||typeof S=="string"&&!S.toString().trim()},P["not exist"]=P.empty,P.notEmpty=function(S){return!P.empty(S)},P.exist=P.notEmpty,P.number=function(S,M){if(!w(S))return!1;if(!M||!M.criteria)return!0;if(!E[M.criteria])return!1;let V=M.value.map(function(G){return parseFloat(G)});return E[M.criteria](S,V)},P.login=function(S){let M=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(S&&M.test(S))},P.list=function(S,M){let V=typeof S;if(V!=="string"&&V!=="number")return!1;let G;return typeof M.value[0]=="string"?M.source?G=M.source:G=M.value[0].split(","):G=M.value[0],Array.isArray(G)?G.findIndex(function(pe){return pe==S})>-1:!1};const ee=function(){let S=new Date;return S.setHours(0,0,0,0),S},te={"one year ago":function(){let S=ee();return S.setFullYear(S.getFullYear()-1),S},"one month ago":function(){let S=ee();return S.setMonth(S.getMonth()-1),S},"one week ago":function(){let S=ee();return S.setDate(S.getDate()-7),S},yesterday:function(){let S=ee();return S.setDate(S.getDate()-1),S},today:ee,tomorrow:function(){let S=ee();return S.setDate(S.getDate()+1),S}};return P.date=function(S,M){if(w(S)&&S>0&&S<1e6&&(S=A.numToDate(S)),new Date(S)=="Invalid Date")return!1;if(!M||!M.criteria)return!0;if(!a[M.criteria])return!1;let V=M.value.map(function(G){return typeof G=="string"&&te[G]?te[G]().getTime():new Date(G).getTime()});return a[M.criteria](new Date(S).getTime(),V)},P.text=function(S,M){if(typeof S>"u"||S===null)S="";else if(typeof S!="string")return!1;return!M||!M.criteria?!0:o[M.criteria]?o[M.criteria](S,M.value):!1},P.textLength=function(S,M){let V;return typeof S=="string"?V=S.length:typeof S<"u"&&S!==null&&typeof S.toString=="function"?V=S.toString().length:V=0,P.number(V,M)},P}var tt=mt();function Le(){var w=function(E,a){var o={};o.options={};var P={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(M,V){alert(V)}};for(var ee in P)a&&a.hasOwnProperty(ee)?o.options[ee]=a[ee]:o.options[ee]=P[ee];o.options.validations||(o.options.validations={}),o.options.submitButton||(o.options.submitButton=E.querySelector("input[type=submit]")),o.options.submitButton&&o.options.url&&(o.options.submitButton.onclick=function(){o.save()}),o.options.validations.email||(o.options.validations.email=tt.email),o.options.validations.length||(o.options.validations.length=tt.length),o.options.validations.required||(o.options.validations.required=tt.required),o.setUrl=function(M){o.options.url=M},o.load=function(){T({url:o.options.url,method:"GET",dataType:"json",queue:!0,success:function(M){if(typeof o.options.onbeforeload=="function"){var V=o.options.onbeforeload(E,M);V&&(M=V)}w.setElements(E,M),typeof o.options.onload=="function"&&o.options.onload(E,M)}})},o.save=function(){var M=o.validate();if(M)o.options.onerror(E,M);else{var V=w.getElements(E,!0);if(typeof o.options.onbeforesave=="function"){var V=o.options.onbeforesave(E,V);if(V===!1)return}T({url:o.options.url,method:"POST",dataType:"json",data:V,success:function(G){typeof o.options.onsave=="function"&&o.options.onsave(E,V,G)}})}},o.remove=function(){if(typeof o.options.onbeforeremove=="function"){var M=o.options.onbeforeremove(E,o);if(M===!1)return!1}T({url:o.options.url,method:"DELETE",dataType:"json",success:function(V){typeof o.options.onremove=="function"&&o.options.onremove(E,o,V),o.reset()}})};var te=function(M){M.classList.add("error"),o.options.submitButton&&o.options.submitButton.setAttribute("disabled",!0);var V=M.getAttribute("data-error")||"There is an error in the form";return M.setAttribute("title",V),V},S=function(M){var V=!1;M.classList.remove("error"),M.removeAttribute("title");for(var G=E.querySelectorAll("input, select, textarea, div[name]"),oe=0;oe<G.length;oe++)G[oe].getAttribute("data-validation")&&G[oe].classList.contains("error")&&(V=!0);o.options.submitButton&&(V?o.options.submitButton.setAttribute("disabled",!0):o.options.submitButton.removeAttribute("disabled"))};return o.validateElement=function(M){var V=!1,G=w.getValue(M),oe=M.getAttribute("data-validation");return typeof o.options.validations[oe]=="function"&&!o.options.validations[oe](G,M)?V=te(M):M.classList.contains("error")&&S(M),V},o.reset=function(){for(var M=E.querySelectorAll("input, select, textarea, div[name]"),V=0;V<M.length;V++)M[V].getAttribute("name")&&(M[V].type=="checkbox"||M[V].type=="radio"?M[V].checked=!1:typeof M[V].val=="function"?M[V].val(""):M[V].value="")},o.validate=function(){for(var M=[],V=E.querySelectorAll("input, select, textarea, div[name]"),G=0;G<V.length;G++)if(V[G].getAttribute("data-validation")){var oe=o.validateElement(V[G]);oe&&M.push(oe)}return M.length>0?M.join("<br>"):!1},o.getError=function(){return!!o.validation()},o.setHash=function(){return o.getHash(w.getElements(E))},o.getHash=function(M){var V=0,G,oe;if(M.length===0)return V;for(G=0;G<M.length;G++)oe=M.charCodeAt(G),V=(V<<5)-V+oe,V|=0;return V},o.isChanged=function(){var M=o.setHash();return o.options.currentHash!=M},o.resetTracker=function(){o.options.currentHash=o.setHash(),o.options.ignore=!1},o.setIgnore=function(M){o.options.ignore=!!M},setTimeout(function(){o.options.currentHash=o.setHash()},1e3),E.addEventListener("keyup",function(M){M.target.getAttribute("data-validation")&&o.validateElement(M.target)}),w.hasEvents||(window.addEventListener("beforeunload",function(M){if(o.isChanged()&&o.options.ignore==!1){var V=o.options.message?o.options.message:"o/";return V?(typeof M>"u"&&(M=window.event),M&&(M.returnValue=V),V):void 0}}),w.hasEvents=!0),E.form=o,o};return w.getValue=function(E){var a=null;if(E.type=="checkbox")E.checked==!0&&(a=E.value||!0);else if(E.type=="radio")E.checked==!0&&(a=E.value);else if(E.type=="file")a=E.files;else if(E.tagName=="select"&&E.multiple==!0){a=[];for(var o=E.querySelectorAll("options[selected]"),P=0;P<o.length;P++)a.push(o[P].value)}else typeof E.val=="function"?a=E.val():a=E.value||"";return a},w.getElements=function(E,a){for(var o={},P=null,ee=E.querySelectorAll("input, select, textarea, div[name]"),te=0;te<ee.length;te++)(P=ee[te].getAttribute("name"))&&(o[P]=w.getValue(ee[te])||"");return a==!0?o:JSON.stringify(o)},w.setElements=function(E,a){for(var o=null,P=null,ee=E.querySelectorAll("input, select, textarea, div[name]"),te=0;te<ee.length;te++){var S=ee[te].getAttribute("type");if(o=ee[te].getAttribute("name")){if(o=o.replace(new RegExp(/\[(.*?)\]/ig),".$1"),P=null,o.match(/\./)){var M=b.call(a,o)||"";typeof M<"u"&&(P=M)}else typeof a[o]<"u"&&(P=a[o]);P!==null&&(S=="checkbox"||S=="radio"?ee[te].checked=!!P:S=="file"||(typeof ee[te].val=="function"?ee[te].val(P):ee[te].value=P))}}},w}var Te=Le();function Be(){var w=function(){var a=null,o=function(S){if(S.which==27)for(var M=document.querySelectorAll(".jmodal"),V=0;V<M.length;V++)M[V].parentNode.modal.close()},P=function(S){let M=S.composedPath();var V=s.findElement(M[0],"jmodal");if(V){var G=V.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0])var oe=S.changedTouches[0].clientX,pe=S.changedTouches[0].clientY;else var oe=S.clientX,pe=S.clientY;G.width-(oe-G.left)<50&&pe-G.top<50&&V.parentNode.modal.close()}a&&(a.element.style.cursor="auto",a=null)},ee=function(S){let M=S.composedPath();var V=s.findElement(M[0],"jmodal");if(V){var G=V.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0])var oe=S.changedTouches[0].clientX,pe=S.changedTouches[0].clientY;else var oe=S.clientX,pe=S.clientY;G.width-(oe-G.left)<50&&pe-G.top<50||pe-G.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),a={left:G.left,top:G.top,x:S.clientX,y:S.clientY,width:G.width,height:G.height,element:V})}},te=function(S){if(a){if(S=S||window.event,S.buttons)var M=S.buttons;else if(S.button)var M=S.button;else var M=S.which;M?(a.element.style.top=a.top+(S.clientY-a.y)+a.height/2+"px",a.element.style.left=a.left+(S.clientX-a.x)+a.width/2+"px",a.element.style.cursor="move"):a.element.style.cursor="auto"}};document.addEventListener("keydown",o),document.addEventListener("mouseup",P),document.addEventListener("mousedown",ee),document.addEventListener("mousemove",te)},E=function(a,o){var P={};P.options={};var ee={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var te in ee)o&&o.hasOwnProperty(te)?P.options[te]=o[te]:P.options[te]=ee[te];!P.options.title&&a.getAttribute("title")&&(P.options.title=a.getAttribute("title"));for(var S=document.createElement("div");a.children[0];)S.appendChild(a.children[0]);for(P.title=document.createElement("div"),P.title.className="jmodal_title",P.options.icon&&P.title.setAttribute("data-icon",P.options.icon),P.content=document.createElement("div"),P.content.className="jmodal_content",P.content.innerHTML=a.innerHTML;S.children[0];)P.content.appendChild(S.children[0]);if(P.container=document.createElement("div"),P.container.className="jmodal",P.container.appendChild(P.title),P.container.appendChild(P.content),P.options.padding&&(P.content.style.padding=P.options.padding),P.options.width&&(P.container.style.width=P.options.width),P.options.height&&(P.container.style.height=P.options.height),P.options.title){var M=document.createElement("h4");M.innerText=P.options.title,P.title.appendChild(M)}if(a.innerHTML="",a.style.display="none",a.appendChild(P.container),P.options.backdrop){var V=document.createElement("div");V.className="jmodal_backdrop",V.onclick=function(){P.close()},a.appendChild(V)}return P.open=function(){a.style.display="block";var G=P.container.getBoundingClientRect();s.getWindowWidth()<G.width?(P.container.style.top="",P.container.style.left="",P.container.classList.add("jmodal_fullscreen"),B.slideBottom(P.container,1)):P.options.backdrop&&(V.style.display="block"),typeof P.options.onopen=="function"&&P.options.onopen(a,P)},P.resetPosition=function(){P.container.style.top="",P.container.style.left=""},P.isOpen=function(){return a.style.display!="none"},P.close=function(){P.isOpen()&&(a.style.display="none",P.options.backdrop&&(V.style.display=""),P.container.classList.remove("jmodal_fullscreen"),typeof P.options.onclose=="function"&&P.options.onclose(a,P))},P.options.url?T({url:P.options.url,method:"GET",dataType:"text/html",success:function(G){P.content.innerHTML=G,P.options.closed||P.open(),typeof P.options.onload=="function"&&P.options.onload(P)}}):(P.options.closed||P.open(),typeof P.options.onload=="function"&&P.options.onload(P)),a.modal=P,w(),w=function(){},P};return E}var Ue=Be();function Ze(){var w=function(E){var a={};a.options={};var o={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var P in o)E&&E.hasOwnProperty(P)?a.options[P]=E[P]:a.options[P]=o[P];var ee=document.createElement("div");ee.className="jnotification",a.options.error&&ee.classList.add("jnotification-error");var te=document.createElement("div");te.className="jnotification-container",ee.appendChild(te);var S=document.createElement("div");S.className="jnotification-header",te.appendChild(S);var M=document.createElement("div");if(M.className="jnotification-image",S.appendChild(M),a.options.icon){var V=document.createElement("img");V.src=a.options.icon,M.appendChild(V)}var G=document.createElement("div");if(G.className="jnotification-name",G.innerHTML=a.options.name,S.appendChild(G),a.options.closeable==!0){var oe=document.createElement("div");oe.className="jnotification-close",oe.onclick=function(){a.hide()},S.appendChild(oe)}var pe=document.createElement("div");pe.className="jnotification-date",S.appendChild(pe);var ce=document.createElement("div");if(ce.className="jnotification-content",te.appendChild(ce),a.options.title){var fe=document.createElement("div");fe.className="jnotification-title",fe.innerHTML=a.options.title,ce.appendChild(fe)}var Ee=document.createElement("div");if(Ee.className="jnotification-message",Ee.innerHTML=a.options.message,ce.appendChild(Ee),a.show=function(){document.body.appendChild(ee),s.getWindowWidth()>800?B.fadeIn(ee):B.slideTop(ee,1)},a.hide=function(){s.getWindowWidth()>800?B.fadeOut(ee,function(){ee.parentNode&&(ee.parentNode.removeChild(ee),Ie&&clearTimeout(Ie))}):B.slideTop(ee,0,function(){ee.parentNode&&(ee.parentNode.removeChild(ee),Ie&&clearTimeout(Ie))})},a.show(),a.options.autoHide==!0)var Ie=setTimeout(function(){a.hide()},a.options.timeout);return s.getWindowWidth()<800&&ee.addEventListener("swipeup",function(Se){a.hide(),Se.preventDefault(),Se.stopPropagation()}),a};return w.isVisible=function(){var E=document.querySelector(".jnotification");return!!(E&&E.parentNode)},w}var nt=Ze();function rt(w,E){var a={};a.options={};var o={value:0,onchange:null,width:null};for(var P in o)E&&E.hasOwnProperty(P)?a.options[P]=E[P]:a.options[P]=o[P];w.classList.add("jprogressbar"),w.setAttribute("tabindex",1),w.setAttribute("data-value",a.options.value);var ee=document.createElement("div");ee.style.width=a.options.value+"%",ee.style.color="#fff",w.appendChild(ee),a.options.width&&(w.style.width=a.options.width),a.setValue=function(S){S=parseInt(S),a.options.value=S,ee.style.width=S+"%",w.setAttribute("data-value",S+"%"),S<6?w.style.color="#000":w.style.color="#fff",a.options.value=S,typeof a.options.onchange=="function"&&a.options.onchange(w,S),w.value!=a.options.value&&(w.value=a.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},a.getValue=function(){return a.options.value};var te=function(S){if(S.which){var M=w.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0]){var V=S.changedTouches[0].clientX;S.changedTouches[0].clientY}else{var V=S.clientX;S.clientY}a.setValue(Math.round((V-M.left)/M.width*100))}};return"touchstart"in document.documentElement?(w.addEventListener("touchstart",te),w.addEventListener("touchend",te)):(w.addEventListener("mousedown",te),w.addEventListener("mousemove",te)),w.change=a.setValue,w.val=function(S){if(S===void 0)return a.getValue();a.setValue(S)},w.progressbar=a,a}function dt(w,E){if(w.rating)return w.rating.setOptions(E,!0);var a={};a.options={},a.setOptions=function(P,ee){var te={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var S in te)P&&P.hasOwnProperty(S)?a.options[S]=P[S]:(typeof a.options[S]>"u"||ee===!0)&&(a.options[S]=te[S]);w.innerHTML="";for(var M=0;M<a.options.number;M++){var V=document.createElement("div");V.setAttribute("data-index",M+1),V.setAttribute("title",a.options.tooltip[M]),w.appendChild(V)}if(a.options.value)for(var M=0;M<a.options.number;M++)M<a.options.value&&w.children[M].classList.add("jrating-selected");return a},a.setValue=function(P){for(var ee=0;ee<a.options.number;ee++)ee<P?w.children[ee].classList.add("jrating-selected"):(w.children[ee].classList.remove("jrating-over"),w.children[ee].classList.remove("jrating-selected"));a.options.value=P,typeof a.options.onchange=="function"&&a.options.onchange(w,P),w.value!=a.options.value&&(w.value=a.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},a.getValue=function(){return a.options.value};var o=function(){a.setOptions(E),w.classList.add("jrating"),w.addEventListener("click",function(P){var ee=P.target.getAttribute("data-index");ee!=null&&(ee==a.options.value?a.setValue(0):a.setValue(ee))}),w.addEventListener("mouseover",function(P){for(var ee=P.target.getAttribute("data-index"),te=0;te<a.options.number;te++)te<ee?w.children[te].classList.add("jrating-over"):w.children[te].classList.remove("jrating-over")}),w.addEventListener("mouseout",function(P){for(var ee=0;ee<a.options.number;ee++)w.children[ee].classList.remove("jrating-over")}),w.change=a.setValue,w.val=function(P){if(P===void 0)return a.getValue();a.setValue(P)},w.rating=a};return o(),a}function gt(w,E){if(w.search)return w.search;var a=null,o=function(V){if(V.target.classList.contains("jsearch_item"))var G=V.target;else var G=V.target.parentNode;S.selectIndex(G),V.preventDefault()},P=function(V){if(typeof S.options.onsearch=="function"){var G=S.options.onsearch(S,V);G&&(V=G)}if(M.innerHTML="",!V.length)w.style.display="";else{w.style.display="block";for(var oe=V.length<11?V.length:10,pe=0;pe<oe;pe++){if(typeof V[pe]=="string")var ce=V[pe],fe=V[pe];else{var ce=V[pe].text;!ce&&V[pe].name&&(ce=V[pe].name);var fe=V[pe].value;!fe&&V[pe].id&&(fe=V[pe].id)}var Ee=document.createElement("div");Ee.setAttribute("data-value",fe),Ee.setAttribute("data-text",ce),Ee.className="jsearch_item",V[pe].id&&Ee.setAttribute("id",V[pe].id),S.options.forceSelect&&pe==0&&Ee.classList.add("selected");var Ie=document.createElement("img");V[pe].image?Ie.src=V[pe].image:Ie.style.display="none",Ee.appendChild(Ie);var Se=document.createElement("div");Se.innerHTML=ce,Ee.appendChild(Se),M.appendChild(Ee)}}},ee=function(V){if(V!=S.terms)if(S.terms=V,S.options.forceSelect?a=0:a=null,Array.isArray(S.options.data)){var G=function(pe){if(typeof pe=="string"){if((""+pe).toLowerCase().search(V.toLowerCase())>=0)return!0}else for(var ce in pe){var fe=pe[ce];if((""+fe).toLowerCase().search(V.toLowerCase())>=0)return!0}return!1},oe=S.options.data.filter(function(pe){return G(pe)});P(oe)}else T({url:S.options.data+V,method:"GET",dataType:"json",success:function(pe){P(pe)}})},te=null,S=function(V){te&&clearTimeout(te),te=setTimeout(function(){ee(V)},500)};E.forceSelect===null&&(E.forceSelect=!0),S.options={data:E.data||null,input:E.input||null,searchByNode:E.searchByNode||null,onselect:E.onselect||null,forceSelect:E.forceSelect,onsearch:E.onsearch||null,onbeforesearch:E.onbeforesearch||null},S.selectIndex=function(V){var G=V.getAttribute("id"),oe=V.getAttribute("data-text"),pe=V.getAttribute("data-value"),ce=V.children[0].src||"";typeof S.options.onselect=="function"&&S.options.onselect(S,oe,pe,G,ce),S.close()},S.open=function(){w.style.display="block"},S.close=function(){te&&clearTimeout(te),S.terms="",M.innerHTML="",w.style.display=""},S.isOpened=function(){return!!w.style.display},S.keydown=function(V){S.isOpened()&&(V.key=="Enter"?a!==null&&M.children[a]?(S.selectIndex(M.children[a]),V.preventDefault()):S.close():V.key==="ArrowUp"?(a!==null&&M.children[0]&&(M.children[a].classList.remove("selected"),!S.options.forceSelect&&a===0?a=null:(a=Math.max(0,a-1),M.children[a].classList.add("selected"))),V.preventDefault()):V.key==="ArrowDown"&&(a==null?a=-1:M.children[a].classList.remove("selected"),a<9&&M.children[a+1]&&a++,M.children[a].classList.add("selected"),V.preventDefault()))},S.keyup=function(V){if(!S.options.searchByNode&&S.options.input)if(S.options.input.tagName==="DIV")var G=S.options.input.innerText;else var G=S.options.input.value;else{var oe=s.getNode();if(oe)var G=oe.innerText}if(typeof S.options.onbeforesearch=="function"){var pe=S.options.onbeforesearch(S,G);if(pe)G=pe;else if(pe===!1)return}S(G)},S.blur=function(V){S.close()},S.options.input&&(S.options.input.addEventListener("keyup",S.keyup),S.options.input.addEventListener("keydown",S.keydown),S.options.input.addEventListener("blur",S.blur));var M=document.createElement("div");return M.classList.add("jsearch_container"),M.onmousedown=o,w.appendChild(M),w.classList.add("jsearch"),w.search=S,S}function bt(w,E){var a={};if(a.options={},a.currentImage=null,E&&(a.options=E),w.setAttribute("tabindex","900"),a.options.items=[],!w.classList.contains("jslider")){if(w.classList.add("jslider"),w.classList.add("unselectable"),a.options.height&&(w.style.minHeight=parseInt(a.options.height)+"px"),a.options.width&&(w.style.width=parseInt(a.options.width)+"px"),a.options.grid){w.classList.add("jslider-grid");var o=w.children.length;o>4&&w.setAttribute("data-total",o-4),w.setAttribute("data-number",o>4?4:o)}var P=document.createElement("div");if(P.classList.add("jslider-counter"),w.children.length>0)for(var ee=0;ee<w.children.length;ee++){a.options.items.push(w.children[ee]);var te=document.createElement("div");te.onclick=function(){var oe=Array.prototype.slice.call(P.children).indexOf(this);a.show(a.currentImage=a.options.items[oe])},P.appendChild(te)}var S=document.createElement("div");S.className="jslider-caption";var M=document.createElement("div"),V=document.createElement("div");V.className="jslider-close",V.innerHTML="",V.onclick=function(){a.close()},M.appendChild(S),M.appendChild(V)}a.updateCounter=function(oe){for(var pe=0;pe<P.children.length;pe++)if(P.children[pe].classList.contains("jslider-counter-focus")){P.children[pe].classList.remove("jslider-counter-focus");break}P.children[oe].classList.add("jslider-counter-focus")},a.show=function(oe){if(!oe)var oe=w.children[0];w.classList.add("jslider-focus"),w.classList.remove("jslider-grid"),w.appendChild(M),w.appendChild(P);var pe=a.options.items.indexOf(oe);a.updateCounter(pe);for(var ce=0;ce<w.children.length;ce++)w.children[ce].style.display="";oe.style.display="block",oe.previousElementSibling?w.classList.add("jslider-left"):w.classList.remove("jslider-left"),oe.nextElementSibling&&oe.nextElementSibling.tagName=="IMG"?w.classList.add("jslider-right"):w.classList.remove("jslider-right"),a.currentImage=oe,a.currentImage.offsetHeight>a.currentImage.offsetWidth&&a.currentImage.classList.add("jslider-vertical"),M.children[0].innerText=a.currentImage.getAttribute("title")},a.open=function(){a.show(),typeof a.options.onopen=="function"&&a.options.onopen(w)},a.close=function(){w.classList.remove("jslider-focus"),w.classList.remove("jslider-left"),w.classList.remove("jslider-right"),a.options.grid&&w.classList.add("jslider-grid");for(var oe=0;oe<w.children.length;oe++)w.children[oe].style.display="";P.remove(),M.remove(),a.currentImage=null,typeof a.options.onclose=="function"&&a.options.onclose(w)},a.reset=function(){w.innerHTML=""},a.next=function(){var oe=a.currentImage.nextElementSibling;oe&&oe.tagName==="IMG"&&a.show(a.currentImage.nextElementSibling)},a.prev=function(){a.currentImage.previousElementSibling&&a.show(a.currentImage.previousElementSibling)};var G=function(oe){if(oe.target.tagName=="IMG")a.show(oe.target);else if(!oe.target.classList.contains("jslider-close")&&!(oe.target.parentNode.classList.contains("jslider-counter")||oe.target.classList.contains("jslider-counter"))){var pe=oe.offsetX||oe.changedTouches[0].clientX;oe.target.clientWidth-pe<40?a.next():pe<40&&a.prev()}};return"ontouchend"in document.documentElement?w.addEventListener("touchend",G):w.addEventListener("mouseup",G),w.addEventListener("swipeleft",function(oe){a.next(),oe.preventDefault(),oe.stopPropagation()}),w.addEventListener("swiperight",function(oe){a.prev(),oe.preventDefault(),oe.stopPropagation()}),w.addEventListener("keydown",function(oe){oe.which==27&&a.close()}),w.slider=a,a}function Ft(w,E){if(w.tags)return w.tags.setOptions(E,!0);var a={type:"tags"};a.options={};var o=function(){return!!(a.options.limit&&w.children.length>=a.options.limit)},P=null,ee=null;a.setOptions=function(Q,he){var we={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var U in we)Q&&Q.hasOwnProperty(U)?a.options[U]=Q[U]:(typeof a.options[U]>"u"||he===!0)&&(a.options[U]=we[U]);return a.options.placeholder?w.setAttribute("data-placeholder",a.options.placeholder):w.removeAttribute("data-placeholder"),w.placeholder=a.options.placeholder,a.setValue(a.options.value),V(),a.options.search?ee||(ee=document.createElement("div"),w.parentNode.insertBefore(ee,w.nextSibling),P=gt(ee,{data:a.options.search,onselect:function(J,v,D){a.selectIndex(v,D)}})):ee&&(P=null,ee.remove(),ee=null),a},a.add=function(Q,he){if(typeof a.options.onbeforechange=="function"){var we=a.options.onbeforechange(w,a,a.options.value,Q);if(we===!1)return!1;we!=null&&(Q=we)}if(P&&P.close(),o())typeof a.options.onlimit=="function"?a.options.onlimit(a,a.options.limit):alert(d.translate("You reach the limit number of entries")+" "+a.options.limit);else{var U=s.getNode();if(U&&U.parentNode&&U.parentNode.classList.contains("jtags")&&U.nextSibling&&!(U.nextSibling.innerText&&U.nextSibling.innerText.trim()))J=U.nextSibling;else{if(w.lastChild&&(w.lastChild.innerText.trim()||w.removeChild(w.lastChild)),!Q||typeof Q=="string")var J=S(Q,Q,U);else for(var v=0;v<=Q.length;v++)if(!o()){if(!Q[v]||typeof Q[v]=="string")var D=Q[v]||"",X=null;else var D=Q[v].text,X=Q[v].value;var J=S(D,X)}M()}he&&te(J)}},a.setLimit=function(Q){for(a.options.limit=Q,w.children.length-Q;w.children.length>Q;)w.removeChild(w.lastChild)},a.remove=function(Q){Q.parentNode.removeChild(Q),w.children.length?M():a.add("",!0),typeof a.options.onremoveitem=="function"&&a.options.onremoveitem(w,a,Q)},a.getData=function(){for(var Q=[],he=0;he<w.children.length;he++){var we=w.children[he].innerText.replace(`
`,""),U=w.children[he].getAttribute("data-value");U||(U=we),(we||U)&&Q.push({text:we,value:U})}return Q},a.getValue=function(Q){var he=null;if(Q!=null)he=w.children[Q].getAttribute("data-value"),he||(he=w.children[Q].innerText.replace(`
`,""));else{for(var we=[],U=0;U<w.children.length;U++)he=w.children[U].innerText.replace(`
`,""),he&&we.push(a.getValue(U));he=we.join(",")}return he},a.setValue=function(Q){if(!Q)a.reset();else if(w.value!=Q)if(Array.isArray(Q))a.add(Q);else{var he=(""+Q).trim(),we=oe(he);w.innerHTML="",a.add(we)}},a.reset=function(){w.classList.add("jtags-empty"),w.innerHTML="<div></div>",M()},a.isValid=function(){for(var Q=0,he=0;he<w.children.length;he++)w.children[he].classList.contains("jtags_error")&&Q++;return Q==0},a.selectIndex=function(Q,he){var we=s.getNode();we&&(we.innerText=Q,he&&we.setAttribute("data-value",he),we.classList.remove("jtags_error"),o()||a.add("",!0))},a.search=function(Q){Q.innerText},a.destroy=function(){w.removeEventListener("mouseup",Ie),w.removeEventListener("keydown",ce),w.removeEventListener("keyup",fe),w.removeEventListener("paste",Ee),w.removeEventListener("focus",Se),w.removeEventListener("blur",ze),w.parentNode.removeChild(w)};var te=function(Q){if(w.children.length){var he=document.createRange(),we=window.getSelection();if(!Q)var Q=w.childNodes[w.childNodes.length-1];he.setStart(Q,Q.length),he.collapse(!0),we.removeAllRanges(),we.addRange(he),w.scrollLeft=w.scrollWidth}},S=function(Q,he,we){var U=document.createElement("div");return U.textContent=Q||"",he&&U.setAttribute("data-value",he),we&&we.parentNode.classList.contains("jtags")?w.insertBefore(U,we.nextSibling):w.appendChild(U),U},M=function(){var Q=a.getValue();Q!=a.options.value&&(a.options.value=Q,typeof a.options.onchange=="function"&&a.options.onchange(w,a,a.options.value),w.value!=a.options.value&&(w.value=a.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))),V()},V=function(){for(var Q=0;Q<w.children.length;Q++)w.children[Q].tagName==="DIV"&&(a.getValue(Q)?(w.children[Q].classList.add("jtags_label"),typeof a.options.validation=="function"&&a.getValue(Q)?a.options.validation(w.children[Q],w.children[Q].innerText,w.children[Q].getAttribute("data-value"))?w.children[Q].classList.remove("jtags_error"):w.children[Q].classList.add("jtags_error"):w.children[Q].classList.remove("jtags_error")):w.children[Q].classList.remove("jtags_label"));G()},G=function(){w.innerText.trim()?w.classList.remove("jtags-empty"):(!w.children.length||w.children[0].tagName==="BR")&&(w.innerHTML="",te(S()))},oe=function(Q){var he=[],we="";if(Q=Q.trim(),Q){for(var U=0;U<Q.length;U++)Q[U]==","||Q[U]==";"||Q[U]==`
`?we&&(he.push(we.trim()),we=""):we+=Q[U];we&&he.push(we)}return he},pe=0,ce=function(Q){if(pe=window.getSelection().anchorOffset,G(),Q.key==="Tab"||Q.key===";"||Q.key===","){var he=window.getSelection().anchorOffset;he>1&&(o()?typeof a.options.onlimit=="function"&&a.options.onlimit(a,a.options.limit):a.add("",!0)),Q.preventDefault()}else if(Q.key=="Enter"){if(!P||!P.isOpened()){var he=window.getSelection().anchorOffset;he>1&&(o()||a.add("",!0)),Q.preventDefault()}}else Q.key=="Backspace"&&w.children.length==1&&window.getSelection().anchorOffset<1&&Q.preventDefault();P&&P.keydown(Q),G()},fe=function(Q){if(Q.which==39){var he=window.getSelection().anchorOffset;he>1&&he==pe&&a.add("",!0)}else Q.which==13||Q.which==38||Q.which==40?Q.preventDefault():P&&P.keyup(Q);V()},Ee=function(Q){if(Q.clipboardData||Q.originalEvent.clipboardData)var he=(Q.originalEvent||Q).clipboardData.getData("text/plain");else if(window.clipboardData)var he=window.clipboardData.getData("Text");var we=oe(he);if(typeof a.options.onbeforepaste=="function"){var U=a.options.onbeforepaste(w,a,we);if(U===!1)return Q.preventDefault(),!1;U&&(we=U)}we.length>1?(a.add(we,!0),Q.preventDefault()):we[0]&&(document.execCommand("insertText",!1,we[0]),Q.preventDefault())},Ie=function(Q){if(Q.target.parentNode&&Q.target.parentNode.classList.contains("jtags")&&(Q.target.classList.contains("jtags_label")||Q.target.classList.contains("jtags_error"))){var he=Q.target.getBoundingClientRect();he.width-(Q.clientX-he.left)<16&&a.remove(Q.target)}Q.target==w&&te()},Se=function(){w.classList.contains("jtags-focus")||((!w.children.length||a.getValue(w.children.length-1))&&(o()||S("")),typeof a.options.onfocus=="function"&&a.options.onfocus(w,a,a.getValue()),w.classList.add("jtags-focus"))},ze=function(){if(w.classList.contains("jtags-focus")){P&&P.close();for(var Q=0;Q<w.children.length-1;Q++)a.getValue(Q)||w.removeChild(w.children[Q]);M(),w.classList.remove("jtags-focus"),typeof a.options.onblur=="function"&&a.options.onblur(w,a,a.getValue())}},Ge=function(){"touchend"in document.documentElement?w.addEventListener("touchend",Ie):w.addEventListener("mouseup",Ie),w.addEventListener("keydown",ce),w.addEventListener("keyup",fe),w.addEventListener("paste",Ee),w.addEventListener("focus",Se),w.addEventListener("blur",ze),w.setAttribute("contenteditable",!0),w.classList.add("jtags"),a.setOptions(E),typeof a.options.onload=="function"&&a.options.onload(w,a),w.change=a.setValue,w.val=function(Q){if(Q===void 0)return a.getValue();a.setValue(Q)},w.tags=a};return Ge(),a}function Tt(w,E){var a={};a.options={};var o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var P in o)E&&E.hasOwnProperty(P)?a.options[P]=E[P]:a.options[P]=o[P];a.options.multiple==!0&&w.setAttribute("data-multiple",!0),w.content=[],w.classList.add("jupload"),a.options.input==!0&&w.classList.add("input"),a.add=function(M){if(a.options.multiple==!1&&(w.content=[],w.innerText=""),a.options.type=="image"){var V=document.createElement("img");V.setAttribute("src",M.file),V.setAttribute("tabindex",-1),w.getAttribute("name")||(V.className="jfile",V.content=M),w.appendChild(V)}else{if(M.name)var G=M.name;else var G=M.file;var oe=document.createElement("div");oe.innerText=G||a.options.type,oe.classList.add("jupload-item"),oe.setAttribute("tabindex",-1),w.appendChild(oe)}M.content&&(M.file=s.guid()),w.content.push(M),typeof a.options.onchange=="function"&&a.options.onchange(w,M)},a.addFromFile=function(M){var V=M.type.split("/");if(V[0]==a.options.type){var G=new FileReader;G.addEventListener("load",function(oe){var pe={file:oe.srcElement.result,extension:M.name.substr(M.name.lastIndexOf(".")+1),name:M.name,size:M.size,lastmodified:M.lastModified,content:oe.srcElement.result};a.add(pe)}),G.readAsDataURL(M)}else alert(d.translate("This extension is not allowed"))},a.addFromUrl=function(M){if(M.substr(0,4)!="data"&&!a.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(M.substr(0,4)=="data"){var V=M.split(";");V=V[0].split("/");var G=V[0].replace("data:","");if(G==a.options.type){var oe={file:M,name:"",extension:V[1],content:M};a.add(oe)}else alert(a.options.text.extensionNotAllowed)}else{var V=M.substr(M.lastIndexOf(".")+1);M=a.options.remoteParser+M,T({url:M,type:"GET",dataType:"blob",success:function(ce){}})}};var ee=a.options.type+"/"+a.options.extension,te=document.createElement("input");te.type="file",te.setAttribute("accept",ee),te.onchange=function(){for(var M=0;M<this.files.length;M++)a.addFromFile(this.files[M])},a.options.multiple==!0&&te.setAttribute("multiple",!0);var S=null;return w.addEventListener("click",function(M){S=null,!w.children.length||M.target===w?s.click(te):M.target.parentNode==w&&(S=M.target)}),w.addEventListener("dblclick",function(M){s.click(te)}),w.addEventListener("dragenter",function(M){w.style.border="1px dashed #000"}),w.addEventListener("dragleave",function(M){w.style.border="1px solid #eee"}),w.addEventListener("dragstop",function(M){w.style.border="1px solid #eee"}),w.addEventListener("dragover",function(M){M.preventDefault()}),w.addEventListener("keydown",function(M){if(S&&M.which==46){var V=Array.prototype.indexOf.call(w.children,S);V>=0&&(w.content.splice(V,1),S.remove(),S=null)}}),w.addEventListener("drop",function(M){M.preventDefault(),M.stopPropagation();var V=(M.originalEvent||M).dataTransfer.getData("text/html"),G=(M.originalEvent||M).dataTransfer.files;if(G.length)for(var oe=0;oe<M.dataTransfer.files.length;oe++)a.addFromFile(M.dataTransfer.files[oe]);else if(V){a.options.multiple==!1&&(w.innerText="");var pe=document.createElement("div");pe.innerHTML=V;var ce=pe.querySelectorAll("img");if(ce.length)for(var oe=0;oe<ce.length;oe++)a.addFromUrl(ce[oe].src)}return w.style.border="1px solid #eee",!1}),w.val=function(M){if(M===void 0)return w.content&&w.content.length?w.content:null;if(w.innerText="",w.content=[],M)if(Array.isArray(M))for(var V=0;V<M.length;V++)typeof M[V]=="string"?a.add({file:M[V]}):a.add(M[V]);else typeof M=="string"&&a.add({file:M})},w.upload=w.image=a,a}var Nt=k(195),Ot=k.n(Nt),pt={...d,...s,version:"5.9.2",setExtensions:function(w){if(typeof w=="object")for(var E=Object.keys(w),a=0;a<E.length;a++)pt[E[a]]=w[E[a]]},tracking:_,path:b,sorting:j,lazyLoading:h,ajax:T,animation:B,calendar:se,color:Ae,contextmenu:ie,dropdown:Ye,editor:Y,floating:qe,form:Te,mask:Z,modal:Ue,notification:nt,palette:ae,picker:Ve,progressbar:rt,rating:dt,search:gt,slider:bt,tabs:be,tags:Ft,toolbar:He,upload:Tt,validations:tt};pt.image=Tt,pt.image.create=function(w){var E=document.createElement("img");return E.setAttribute("src",w.file),E.className="jfile",E.setAttribute("tabindex",-1),E.content=w,E},pt.tracker=Te,pt.loading=B.loading,pt.sha512=Ot(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const w=function(Q,he){return Q[he.type]&&Q[he.type]==he||Q.component&&Q.component==he?!0:Q.parentNode?w(Q.parentNode,he):!1},E=function(Q){let he=window.jSuitesStateControl;if(he&&he.length>0)for(let we=0;we<he.length;we++)he[we]&&!w(Q,he[we])&&he[we].close()};let a=15,o=!1,P={x:null,y:null},ee=document.createElement("div");ee.classList.add("jtooltip");const te=function(Q){return Q&&(Q.shadowRoot||Q.tagName&&Q.tagName.includes("-"))},S=function(Q){let he,we,U=Q.path||Q.composedPath&&Q.composedPath();return U?(we=U[0],we&&te(we)&&!we.shadowRoot&&Q.toElement&&(we=Q.toElement)):(Q.target&&te(Q.target)?he=Q.target.shadowRoot:he=document,we=he.elementFromPoint(x,y)),we},M=function(Q){if(Q.changedTouches&&Q.changedTouches[0])var he=Q.changedTouches[0].clientX,we=Q.changedTouches[0].clientY;else var he=Q.clientX,we=Q.clientY;let U=S(Q),J=U&&U.tagName==="DIV"&&U.getAttribute("contentEditable"),v=pt.findElement(U,"jpanel");if(v&&!v.classList.contains("readonly")&&!J){let D=v.getBoundingClientRect(),X=0;v.style.rotate&&(X=parseFloat(v.style.rotate));let ue="move";U.getAttribute("data-action")?ue=U.getAttribute("data-action"):v.style.cursor?ue="resize":v.style.cursor="move",o={action:ue,a:X,e:v,x:he,y:we,l:D.left,t:D.top,b:D.bottom,r:D.right,w:D.width,h:D.height,d:v.style.cursor,actioned:!1},v.style.width||(v.style.width=D.width+"px"),v.style.height||(v.style.height=D.height+"px")}else o=!1;E(U),fe(Q)},V=function(Q,he,we,U,J,v){const D=we-Q,X=U-he,ue=J-Q,K=v-he;let le=Math.atan2(X,D),Me=Math.atan2(K,ue)-le;return Me=Me*(180/Math.PI),Me<0&&(Me+=360),Me},G=function(Q){o&&o.e&&(typeof o.e.refresh=="function"&&P.actioned&&o.e.refresh(),o.e.style.cursor=""),P={x:null,y:null},o=!1},oe=function(Q){if(o){let v=Q.clientX||Q.pageX,D=Q.clientY||Q.pageY;if(P.x==null&&P.y==null&&(P.x=v,P.y=D),o.action==="move"){var he=v-P.x,we=D-P.y,U=o.e.offsetTop+we,J=o.e.offsetLeft+he;o.e.style.top=U+"px",o.e.style.left=J+"px",typeof o.e.refresh=="function"&&(P.actioned=!0,o.e.refresh("position",U,J))}else if(o.action==="rotate"){let X=o.l+o.w/2,ue=o.t+o.h/2,K=V(X,ue,o.x,o.y,v,D);K=K+o.a%360,K=Math.round(K/2)*2,o.e.style.rotate=`${K}deg`,typeof o.e.refresh=="function"&&(P.actioned=!0,o.e.refresh("rotate",K))}else if(o.action==="resize"){let X=null,ue=null,K=null,le=null;o.d=="e-resize"||o.d=="ne-resize"||o.d=="se-resize"?(K=o.e.offsetWidth+(v-P.x),Q.shiftKey&&(le=o.e.offsetHeight+(v-P.x)*(o.e.offsetHeight/o.e.offsetWidth))):(o.d==="w-resize"||o.d=="nw-resize"||o.d=="sw-resize")&&(ue=o.e.offsetLeft+(v-P.x),K=o.e.offsetLeft+o.e.offsetWidth-ue,Q.shiftKey&&(le=o.e.offsetHeight-(v-P.x)*(o.e.offsetHeight/o.e.offsetWidth))),o.d=="s-resize"||o.d=="se-resize"||o.d=="sw-resize"?le||(le=o.e.offsetHeight+(D-P.y)):(o.d==="n-resize"||o.d=="ne-resize"||o.d=="nw-resize")&&(X=o.e.offsetTop+(D-P.y),le=o.e.offsetTop+o.e.offsetHeight-X),X&&(o.e.style.top=X+"px"),ue&&(o.e.style.left=ue+"px"),K&&(o.e.style.width=K+"px"),le&&(o.e.style.height=le+"px"),typeof o.e.refresh=="function"&&(P.actioned=!0,o.e.refresh("dimensions",K,le))}P.x=v,P.y=D}else{let v=S(Q),D=pt.findElement(v,"jpanel");if(D){if(D.classList.contains("jpanel-controls")){let ue=v.getAttribute("data-position");ue?D.style.cursor=ue:D.style.cursor=""}else if(D.getAttribute("tabindex")){let ue=D.getBoundingClientRect();Q.clientY-ue.top<a?ue.width-(Q.clientX-ue.left)<a?D.style.cursor="ne-resize":Q.clientX-ue.left<a?D.style.cursor="nw-resize":D.style.cursor="n-resize":ue.height-(Q.clientY-ue.top)<a?ue.width-(Q.clientX-ue.left)<a?D.style.cursor="se-resize":Q.clientX-ue.left<a?D.style.cursor="sw-resize":D.style.cursor="s-resize":ue.width-(Q.clientX-ue.left)<a?D.style.cursor="e-resize":Q.clientX-ue.left<a?D.style.cursor="w-resize":D.style.cursor=""}}}};let pe=["n","ne","e","se","s","sw","w","nw","rotate"];pe.forEach(function(Q,he){pe[he]=document.createElement("div"),pe[he].classList.add("jpanel-action"),Q==="rotate"?pe[he].setAttribute("data-action","rotate"):(pe[he].setAttribute("data-action","resize"),pe[he].setAttribute("data-position",Q+"-resize"))});let ce;const fe=function(Q){let he=S(Q),we=pt.findElement(he,"jpanel");we&&!we.classList.contains("readonly")&&we.classList.contains("jpanel-controls")?(we.append(...pe),we.classList.contains("jpanel-rotate")||pe[pe.length-1].remove(),ce=we):Ee()},Ee=function(Q){ce&&(pe.forEach(function(he){he.remove()}),ce=null)},Ie=function(Q){var we=S(Q).getAttribute("data-tooltip");if(we){if(ee.innerText=we,Q.changedTouches&&Q.changedTouches[0])var U=Q.changedTouches[0].clientX,J=Q.changedTouches[0].clientY;else var U=Q.clientX,J=Q.clientY;ee.style.top=J+"px",ee.style.left=U+"px",document.body.appendChild(ee)}else ee.innerText&&(ee.innerText="",document.body.removeChild(ee))},Se=function(Q){var he=document.activeElement;if(he&&typeof he.contextmenu=="function")he.contextmenu(Q),Q.preventDefault(),Q.stopImmediatePropagation();else if(he=pt.findElement(Q.target,function(U){return U.tagName&&U.getAttribute("aria-contextmenu-id")}),he){var we=document.querySelector("#"+he);we?(we.contextmenu.open(Q),Q.preventDefault(),Q.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+he)}},ze=function(Q){let he=document.activeElement;he&&Q.key==="Delete"&&typeof he.delete=="function"&&(he.delete(),Q.preventDefault(),Q.stopImmediatePropagation());let we=window.jSuitesStateControl;we&&we.length>0&&(he=we[we.length-1],he&&Q.key==="Escape"&&typeof he.isOpened=="function"&&typeof he.close=="function"&&he.isOpened()&&(he.close(),Q.preventDefault(),Q.stopImmediatePropagation()))},Ge=function(Q){(Q.target.getAttribute("data-mask")||Q.target.mask)&&pt.mask(Q)};document.addEventListener("focusin",fe),document.addEventListener("mouseup",G),document.addEventListener("mousedown",M),document.addEventListener("mousemove",oe),document.addEventListener("mouseover",Ie),document.addEventListener("keydown",ze),document.addEventListener("contextmenu",Se),document.addEventListener("input",Ge)}();var It=pt})(),c=W.default}(),c})}(jsuites)),jsuitesExports}(function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();(function(n,l){module.exports=l()})(commonjsGlobal,function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(n){var l;n.exports=(function(){var c={765:function(W,m){var u;u=function(d){d.version="1.0.2";var F=Math;function _(je,ie){for(var Pe=0,Ye=0;Pe<je.length;++Pe)Ye=ie*Ye+je[Pe];return Ye}function g(je,ie,Pe,Ye,Ve){if(ie===0)return Pe;if(ie===1)return Ye;for(var He=2/je,ut=Ye,Y=1;Y<ie;++Y)ut=Ye*Y*He+Ve*Pe,Pe=Ye,Ye=ut;return ut}function s(je,ie,Pe,Ye,Ve){return function(He,ut){if(Ye){if(He===0)return Ye==1?-1/0:1/0;if(He<0)return NaN}return ut===0?je(He):ut===1?ie(He):ut<0?NaN:g(He,ut|=0,je(He),ie(He),Ve)}}var b,j,h,C,T,I,B,O,A,R,Z,q,se,ge=function(){var je=.636619772,ie=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Pe=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Ye=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ve=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function He(tt){var Le=0,Te=0,Be=0,Ue=tt*tt;if(tt<8)Le=(Te=_(ie,Ue))/(Be=_(Pe,Ue));else{var Ze=tt-.785398164;Te=_(Ye,Ue=64/Ue),Be=_(Ve,Ue),Le=F.sqrt(je/tt)*(F.cos(Ze)*Te-F.sin(Ze)*Be*8/tt)}return Le}var ut=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),Y=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Ne=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),qe=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function mt(tt){var Le=0,Te=0,Be=0,Ue=tt*tt,Ze=F.abs(tt)-2.356194491;return Math.abs(tt)<8?Le=(Te=tt*_(ut,Ue))/(Be=_(Y,Ue)):(Te=_(Ne,Ue=64/Ue),Be=_(qe,Ue),Le=F.sqrt(je/F.abs(tt))*(F.cos(Ze)*Te-F.sin(Ze)*Be*8/F.abs(tt)),tt<0&&(Le=-Le)),Le}return function tt(Le,Te){if(Te=Math.round(Te),!isFinite(Le))return isNaN(Le)?Le:0;if(Te<0)return(Te%2?-1:1)*tt(Le,-Te);if(Le<0)return(Te%2?-1:1)*tt(-Le,Te);if(Te===0)return He(Le);if(Te===1)return mt(Le);if(Le===0)return 0;var Be=0;if(Le>Te)Be=g(Le,Te,He(Le),mt(Le),-1);else{for(var Ue=!1,Ze=0,nt=0,rt=1,dt=0,gt=2/Le,bt=2*F.floor((Te+F.floor(F.sqrt(40*Te)))/2);bt>0;bt--)dt=bt*gt*rt-Ze,Ze=rt,rt=dt,F.abs(rt)>1e10&&(rt*=1e-10,Ze*=1e-10,Be*=1e-10,nt*=1e-10),Ue&&(nt+=rt),Ue=!Ue,bt==Te&&(Be=Ze);Be/=nt=2*nt-rt}return Be}}(),ae=(b=.636619772,j=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),h=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),C=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),T=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),I=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),B=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),O=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),A=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),s(function(je){var ie=0,Pe=0,Ye=0,Ve=je*je,He=je-.785398164;return je<8?ie=(Pe=_(j,Ve))/(Ye=_(h,Ve))+b*ge(je,0)*F.log(je):(Pe=_(C,Ve=64/Ve),Ye=_(T,Ve),ie=F.sqrt(b/je)*(F.sin(He)*Pe+F.cos(He)*Ye*8/je)),ie},function(je){var ie=0,Pe=0,Ye=0,Ve=je*je,He=je-2.356194491;return je<8?ie=(Pe=je*_(I,Ve))/(Ye=_(B,Ve))+b*(ge(je,1)*F.log(je)-1/je):(Pe=_(O,Ve=64/Ve),Ye=_(A,Ve),ie=F.sqrt(b/je)*(F.sin(He)*Pe+F.cos(He)*Ye*8/je)),ie},0,1,-1)),be=(R=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),Z=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),q=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),se=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function je(ie,Pe){if((Pe=Math.round(Pe))===0)return function(qe){return qe<=3.75?_(R,qe*qe/14.0625):F.exp(F.abs(qe))/F.sqrt(F.abs(qe))*_(Z,3.75/F.abs(qe))}(ie);if(Pe===1)return function(qe){return qe<3.75?qe*_(q,qe*qe/14.0625):(qe<0?-1:1)*F.exp(F.abs(qe))/F.sqrt(F.abs(qe))*_(se,3.75/F.abs(qe))}(ie);if(Pe<0)return NaN;if(F.abs(ie)===0)return 0;if(ie==1/0)return 1/0;var Ye,Ve=0,He=2/F.abs(ie),ut=0,Y=1,Ne=0;for(Ye=2*F.round((Pe+F.round(F.sqrt(40*Pe)))/2);Ye>0;Ye--)Ne=Ye*He*Y+ut,ut=Y,Y=Ne,F.abs(Y)>1e10&&(Y*=1e-10,ut*=1e-10,Ve*=1e-10),Ye==Pe&&(Ve=ut);return Ve*=je(ie,0)/Y,ie<0&&Pe%2?-Ve:Ve}),Ae=function(){var je=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ie=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Pe=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Ye=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return s(function(Ve){return Ve<=2?-F.log(Ve/2)*be(Ve,0)+_(je,Ve*Ve/4):F.exp(-Ve)/F.sqrt(Ve)*_(ie,2/Ve)},function(Ve){return Ve<=2?F.log(Ve/2)*be(Ve,1)+1/Ve*_(Pe,Ve*Ve/4):F.exp(-Ve)/F.sqrt(Ve)*_(Ye,2/Ve)},0,2,1)}();d.besselj=ge,d.bessely=ae,d.besseli=be,d.besselk=Ae},u(typeof DO_NOT_EXPORT_BESSEL>"u"?m:{})},162:function(W){var m;W.exports=(m=function(u,d){var F=Array.prototype.concat,_=Array.prototype.slice,g=Object.prototype.toString;function s(A,R){var Z=A>R?A:R;return u.pow(10,17-~~(u.log(Z>0?Z:-Z)*u.LOG10E))}var b=Array.isArray||function(A){return g.call(A)==="[object Array]"};function j(A){return g.call(A)==="[object Function]"}function h(A){return typeof A=="number"&&A-A==0}function C(){return new C._init(arguments)}function T(){return 0}function I(){return 1}function B(A,R){return A===R?1:0}C.fn=C.prototype,C._init=function(A){if(b(A[0]))if(b(A[0][0])){j(A[1])&&(A[0]=C.map(A[0],A[1]));for(var R=0;R<A[0].length;R++)this[R]=A[0][R];this.length=A[0].length}else this[0]=j(A[1])?C.map(A[0],A[1]):A[0],this.length=1;else if(h(A[0]))this[0]=C.seq.apply(null,A),this.length=1;else{if(A[0]instanceof C)return C(A[0].toArray());this[0]=[],this.length=1}return this},C._init.prototype=C.prototype,C._init.constructor=C,C.utils={calcRdx:s,isArray:b,isFunction:j,isNumber:h,toVector:function(A){return F.apply([],A)}},C._random_fn=u.random,C.setRandom=function(A){if(typeof A!="function")throw new TypeError("fn is not a function");C._random_fn=A},C.extend=function(A){var R,Z;if(arguments.length===1){for(Z in A)C[Z]=A[Z];return this}for(R=1;R<arguments.length;R++)for(Z in arguments[R])A[Z]=arguments[R][Z];return A},C.rows=function(A){return A.length||1},C.cols=function(A){return A[0].length||1},C.dimensions=function(A){return{rows:C.rows(A),cols:C.cols(A)}},C.row=function(A,R){return b(R)?R.map(function(Z){return C.row(A,Z)}):A[R]},C.rowa=function(A,R){return C.row(A,R)},C.col=function(A,R){if(b(R)){var Z=C.arange(A.length).map(function(){return new Array(R.length)});return R.forEach(function(ge,ae){C.arange(A.length).forEach(function(be){Z[be][ae]=A[be][ge]})}),Z}for(var q=new Array(A.length),se=0;se<A.length;se++)q[se]=[A[se][R]];return q},C.cola=function(A,R){return C.col(A,R).map(function(Z){return Z[0]})},C.diag=function(A){for(var R=C.rows(A),Z=new Array(R),q=0;q<R;q++)Z[q]=[A[q][q]];return Z},C.antidiag=function(A){for(var R=C.rows(A)-1,Z=new Array(R),q=0;R>=0;R--,q++)Z[q]=[A[q][R]];return Z},C.transpose=function(A){var R,Z,q,se,ge,ae=[];for(b(A[0])||(A=[A]),Z=A.length,q=A[0].length,ge=0;ge<q;ge++){for(R=new Array(Z),se=0;se<Z;se++)R[se]=A[se][ge];ae.push(R)}return ae.length===1?ae[0]:ae},C.map=function(A,R,Z){var q,se,ge,ae,be;for(b(A[0])||(A=[A]),se=A.length,ge=A[0].length,ae=Z?A:new Array(se),q=0;q<se;q++)for(ae[q]||(ae[q]=new Array(ge)),be=0;be<ge;be++)ae[q][be]=R(A[q][be],q,be);return ae.length===1?ae[0]:ae},C.cumreduce=function(A,R,Z){var q,se,ge,ae,be;for(b(A[0])||(A=[A]),se=A.length,ge=A[0].length,ae=Z?A:new Array(se),q=0;q<se;q++)for(ae[q]||(ae[q]=new Array(ge)),ge>0&&(ae[q][0]=A[q][0]),be=1;be<ge;be++)ae[q][be]=R(ae[q][be-1],A[q][be]);return ae.length===1?ae[0]:ae},C.alter=function(A,R){return C.map(A,R,!0)},C.create=function(A,R,Z){var q,se,ge=new Array(A);for(j(R)&&(Z=R,R=A),q=0;q<A;q++)for(ge[q]=new Array(R),se=0;se<R;se++)ge[q][se]=Z(q,se);return ge},C.zeros=function(A,R){return h(R)||(R=A),C.create(A,R,T)},C.ones=function(A,R){return h(R)||(R=A),C.create(A,R,I)},C.rand=function(A,R){return h(R)||(R=A),C.create(A,R,C._random_fn)},C.identity=function(A,R){return h(R)||(R=A),C.create(A,R,B)},C.symmetric=function(A){var R,Z,q=A.length;if(A.length!==A[0].length)return!1;for(R=0;R<q;R++)for(Z=0;Z<q;Z++)if(A[Z][R]!==A[R][Z])return!1;return!0},C.clear=function(A){return C.alter(A,T)},C.seq=function(A,R,Z,q){j(q)||(q=!1);var se,ge=[],ae=s(A,R),be=(R*ae-A*ae)/((Z-1)*ae),Ae=A;for(se=0;Ae<=R&&se<Z;Ae=(A*ae+be*ae*++se)/ae)ge.push(q?q(Ae,se):Ae);return ge},C.arange=function(A,R,Z){var q,se=[];if(Z=Z||1,R===d&&(R=A,A=0),A===R||Z===0)return[];if(A<R&&Z<0)return[];if(A>R&&Z>0)return[];if(Z>0)for(q=A;q<R;q+=Z)se.push(q);else for(q=A;q>R;q+=Z)se.push(q);return se},C.slice=function(){function A(R,Z,q,se){var ge,ae=[],be=R.length;if(Z===d&&q===d&&se===d)return C.copy(R);if(se=se||1,(Z=(Z=Z||0)>=0?Z:be+Z)===(q=(q=q||R.length)>=0?q:be+q)||se===0)return[];if(Z<q&&se<0)return[];if(Z>q&&se>0)return[];if(se>0)for(ge=Z;ge<q;ge+=se)ae.push(R[ge]);else for(ge=Z;ge>q;ge+=se)ae.push(R[ge]);return ae}return function(R,Z){var q,se;return h((Z=Z||{}).row)?h(Z.col)?R[Z.row][Z.col]:A(C.rowa(R,Z.row),(q=Z.col||{}).start,q.end,q.step):h(Z.col)?A(C.cola(R,Z.col),(se=Z.row||{}).start,se.end,se.step):(se=Z.row||{},q=Z.col||{},A(R,se.start,se.end,se.step).map(function(ge){return A(ge,q.start,q.end,q.step)}))}}(),C.sliceAssign=function(A,R,Z){var q,se;if(h(R.row)){if(h(R.col))return A[R.row][R.col]=Z;R.col=R.col||{},R.col.start=R.col.start||0,R.col.end=R.col.end||A[0].length,R.col.step=R.col.step||1,q=C.arange(R.col.start,u.min(A.length,R.col.end),R.col.step);var ge=R.row;return q.forEach(function(be,Ae){A[ge][be]=Z[Ae]}),A}if(h(R.col)){R.row=R.row||{},R.row.start=R.row.start||0,R.row.end=R.row.end||A.length,R.row.step=R.row.step||1,se=C.arange(R.row.start,u.min(A[0].length,R.row.end),R.row.step);var ae=R.col;return se.forEach(function(be,Ae){A[be][ae]=Z[Ae]}),A}return Z[0].length===d&&(Z=[Z]),R.row.start=R.row.start||0,R.row.end=R.row.end||A.length,R.row.step=R.row.step||1,R.col.start=R.col.start||0,R.col.end=R.col.end||A[0].length,R.col.step=R.col.step||1,se=C.arange(R.row.start,u.min(A.length,R.row.end),R.row.step),q=C.arange(R.col.start,u.min(A[0].length,R.col.end),R.col.step),se.forEach(function(be,Ae){q.forEach(function(je,ie){A[be][je]=Z[Ae][ie]})}),A},C.diagonal=function(A){var R=C.zeros(A.length,A.length);return A.forEach(function(Z,q){R[q][q]=Z}),R},C.copy=function(A){return A.map(function(R){return h(R)?R:R.map(function(Z){return Z})})};var O=C.prototype;return O.length=0,O.push=Array.prototype.push,O.sort=Array.prototype.sort,O.splice=Array.prototype.splice,O.slice=Array.prototype.slice,O.toArray=function(){return this.length>1?_.call(this):_.call(this)[0]},O.map=function(A,R){return C(C.map(this,A,R))},O.cumreduce=function(A,R){return C(C.cumreduce(this,A,R))},O.alter=function(A){return C.alter(this,A),this},function(A){for(var R=0;R<A.length;R++)(function(Z){O[Z]=function(q){var se,ge=this;return q?(setTimeout(function(){q.call(ge,O[Z].call(ge))}),this):(se=C[Z](this),b(se)?C(se):se)}})(A[R])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(A){for(var R=0;R<A.length;R++)(function(Z){O[Z]=function(q,se){var ge=this;return se?(setTimeout(function(){se.call(ge,O[Z].call(ge,q))}),this):C(C[Z](this,q))}})(A[R])}("row col".split(" ")),function(A){for(var R=0;R<A.length;R++)(function(Z){O[Z]=function(){return C(C[Z].apply(null,arguments))}})(A[R])}("create zeros ones rand identity".split(" ")),C}(Math),function(u,d){var F=u.utils.isFunction;function _(b,j){return b-j}function g(b,j,h){return d.max(j,d.min(b,h))}u.sum=function(b){for(var j=0,h=b.length;--h>=0;)j+=b[h];return j},u.sumsqrd=function(b){for(var j=0,h=b.length;--h>=0;)j+=b[h]*b[h];return j},u.sumsqerr=function(b){for(var j,h=u.mean(b),C=0,T=b.length;--T>=0;)C+=(j=b[T]-h)*j;return C},u.sumrow=function(b){for(var j=0,h=b.length;--h>=0;)j+=b[h];return j},u.product=function(b){for(var j=1,h=b.length;--h>=0;)j*=b[h];return j},u.min=function(b){for(var j=b[0],h=0;++h<b.length;)b[h]<j&&(j=b[h]);return j},u.max=function(b){for(var j=b[0],h=0;++h<b.length;)b[h]>j&&(j=b[h]);return j},u.unique=function(b){for(var j={},h=[],C=0;C<b.length;C++)j[b[C]]||(j[b[C]]=!0,h.push(b[C]));return h},u.mean=function(b){return u.sum(b)/b.length},u.meansqerr=function(b){return u.sumsqerr(b)/b.length},u.geomean=function(b){var j=b.map(d.log),h=u.mean(j);return d.exp(h)},u.median=function(b){var j=b.length,h=b.slice().sort(_);return 1&j?h[j/2|0]:(h[j/2-1]+h[j/2])/2},u.cumsum=function(b){return u.cumreduce(b,function(j,h){return j+h})},u.cumprod=function(b){return u.cumreduce(b,function(j,h){return j*h})},u.diff=function(b){var j,h=[],C=b.length;for(j=1;j<C;j++)h.push(b[j]-b[j-1]);return h},u.rank=function(b){var j,h=[],C={};for(j=0;j<b.length;j++)C[O=b[j]]?C[O]++:(C[O]=1,h.push(O));var T=h.sort(_),I={},B=1;for(j=0;j<T.length;j++){var O,A=C[O=T[j]],R=(B+(B+A-1))/2;I[O]=R,B+=A}return b.map(function(Z){return I[Z]})},u.mode=function(b){var j,h=b.length,C=b.slice().sort(_),T=1,I=0,B=0,O=[];for(j=0;j<h;j++)C[j]===C[j+1]?T++:(T>I?(O=[C[j]],I=T,B=0):T===I&&(O.push(C[j]),B++),T=1);return B===0?O[0]:O},u.range=function(b){return u.max(b)-u.min(b)},u.variance=function(b,j){return u.sumsqerr(b)/(b.length-(j?1:0))},u.pooledvariance=function(b){return b.reduce(function(j,h){return j+u.sumsqerr(h)},0)/(b.reduce(function(j,h){return j+h.length},0)-b.length)},u.deviation=function(b){for(var j=u.mean(b),h=b.length,C=new Array(h),T=0;T<h;T++)C[T]=b[T]-j;return C},u.stdev=function(b,j){return d.sqrt(u.variance(b,j))},u.pooledstdev=function(b){return d.sqrt(u.pooledvariance(b))},u.meandev=function(b){for(var j=u.mean(b),h=[],C=b.length-1;C>=0;C--)h.push(d.abs(b[C]-j));return u.mean(h)},u.meddev=function(b){for(var j=u.median(b),h=[],C=b.length-1;C>=0;C--)h.push(d.abs(b[C]-j));return u.median(h)},u.coeffvar=function(b){return u.stdev(b)/u.mean(b)},u.quartiles=function(b){var j=b.length,h=b.slice().sort(_);return[h[d.round(j/4)-1],h[d.round(j/2)-1],h[d.round(3*j/4)-1]]},u.quantiles=function(b,j,h,C){var T,I,B,O,A,R=b.slice().sort(_),Z=[j.length],q=b.length;for(h===void 0&&(h=.375),C===void 0&&(C=.375),T=0;T<j.length;T++)B=q*(I=j[T])+(h+I*(1-h-C)),O=d.floor(g(B,1,q-1)),A=g(B-O,0,1),Z[T]=(1-A)*R[O-1]+A*R[O];return Z},u.percentile=function(b,j,h){var C=b.slice().sort(_),T=j*(C.length+(h?1:-1))+(h?0:1),I=parseInt(T),B=T-I;return I+1<C.length?C[I-1]+B*(C[I]-C[I-1]):C[I-1]},u.percentileOfScore=function(b,j,h){var C,T,I=0,B=b.length,O=!1;for(h==="strict"&&(O=!0),T=0;T<B;T++)C=b[T],(O&&C<j||!O&&C<=j)&&I++;return I/B},u.histogram=function(b,j){j=j||4;var h,C=u.min(b),T=(u.max(b)-C)/j,I=b.length,B=[];for(h=0;h<j;h++)B[h]=0;for(h=0;h<I;h++)B[d.min(d.floor((b[h]-C)/T),j-1)]+=1;return B},u.covariance=function(b,j){var h,C=u.mean(b),T=u.mean(j),I=b.length,B=new Array(I);for(h=0;h<I;h++)B[h]=(b[h]-C)*(j[h]-T);return u.sum(B)/(I-1)},u.corrcoeff=function(b,j){return u.covariance(b,j)/u.stdev(b,1)/u.stdev(j,1)},u.spearmancoeff=function(b,j){return b=u.rank(b),j=u.rank(j),u.corrcoeff(b,j)},u.stanMoment=function(b,j){for(var h=u.mean(b),C=u.stdev(b),T=b.length,I=0,B=0;B<T;B++)I+=d.pow((b[B]-h)/C,j);return I/b.length},u.skewness=function(b){return u.stanMoment(b,3)},u.kurtosis=function(b){return u.stanMoment(b,4)-3};var s=u.prototype;(function(b){for(var j=0;j<b.length;j++)(function(h){s[h]=function(C,T){var I=[],B=0,O=this;if(F(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(O,s[h].call(O,C))}),this;if(this.length>1){for(O=C===!0?this:this.transpose();B<O.length;B++)I[B]=u[h](O[B]);return I}return u[h](this[0],C)}})(b[j])})("cumsum cumprod".split(" ")),function(b){for(var j=0;j<b.length;j++)(function(h){s[h]=function(C,T){var I=[],B=0,O=this;if(F(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(O,s[h].call(O,C))}),this;if(this.length>1){for(h!=="sumrow"&&(O=C===!0?this:this.transpose());B<O.length;B++)I[B]=u[h](O[B]);return C===!0?u[h](u.utils.toVector(I)):I}return u[h](this[0],C)}})(b[j])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(b){for(var j=0;j<b.length;j++)(function(h){s[h]=function(){var C,T=[],I=0,B=this,O=Array.prototype.slice.call(arguments);if(F(O[O.length-1])){C=O[O.length-1];var A=O.slice(0,O.length-1);return setTimeout(function(){C.call(B,s[h].apply(B,A))}),this}C=void 0;var R=function(Z){return u[h].apply(B,[Z].concat(O))};if(this.length>1){for(B=B.transpose();I<B.length;I++)T[I]=R(B[I]);return T}return R(this[0])}})(b[j])}("quantiles percentileOfScore".split(" "))}(m,Math),function(u,d){u.gammaln=function(F){var _,g,s,b=0,j=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015;for(s=(g=_=F)+5.5,s-=(_+.5)*d.log(s);b<6;b++)h+=j[b]/++g;return d.log(2.5066282746310007*h/_)-s},u.loggam=function(F){var _,g,s,b,j,h,C,T=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(_=F,C=0,F==1||F==2)return 0;for(F<=7&&(_=F+(C=d.floor(7-F))),g=1/(_*_),s=2*d.PI,j=T[9],h=8;h>=0;h--)j*=g,j+=T[h];if(b=j/_+.5*d.log(s)+(_-.5)*d.log(_)-_,F<=7)for(h=1;h<=C;h++)b-=d.log(_-1),_-=1;return b},u.gammafn=function(F){var _,g,s,b,j=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],C=!1,T=0,I=0,B=0,O=F;if(F>171.6243769536076)return 1/0;if(O<=0){if(!(b=O%1+36e-17))return 1/0;C=(1&O?-1:1)*d.PI/d.sin(d.PI*b),O=1-O}for(s=O,g=O<1?O++:(O-=T=(0|O)-1)-1,_=0;_<8;++_)B=(B+j[_])*g,I=I*g+h[_];if(b=B/I+1,s<O)b/=s;else if(s>O)for(_=0;_<T;++_)b*=O,O++;return C&&(b=C/b),b},u.gammap=function(F,_){return u.lowRegGamma(F,_)*u.gammafn(F)},u.lowRegGamma=function(F,_){var g,s=u.gammaln(F),b=F,j=1/F,h=j,C=_+1-F,T=1/1e-30,I=1/C,B=I,O=1,A=-~(8.5*d.log(F>=1?F:1/F)+.4*F+17);if(_<0||F<=0)return NaN;if(_<F+1){for(;O<=A;O++)j+=h*=_/++b;return j*d.exp(-_+F*d.log(_)-s)}for(;O<=A;O++)B*=(I=1/(I=(g=-O*(O-F))*I+(C+=2)))*(T=C+g/T);return 1-B*d.exp(-_+F*d.log(_)-s)},u.factorialln=function(F){return F<0?NaN:u.gammaln(F+1)},u.factorial=function(F){return F<0?NaN:u.gammafn(F+1)},u.combination=function(F,_){return F>170||_>170?d.exp(u.combinationln(F,_)):u.factorial(F)/u.factorial(_)/u.factorial(F-_)},u.combinationln=function(F,_){return u.factorialln(F)-u.factorialln(_)-u.factorialln(F-_)},u.permutation=function(F,_){return u.factorial(F)/u.factorial(F-_)},u.betafn=function(F,_){if(!(F<=0||_<=0))return F+_>170?d.exp(u.betaln(F,_)):u.gammafn(F)*u.gammafn(_)/u.gammafn(F+_)},u.betaln=function(F,_){return u.gammaln(F)+u.gammaln(_)-u.gammaln(F+_)},u.betacf=function(F,_,g){var s,b,j,h,C=1e-30,T=1,I=_+g,B=_+1,O=_-1,A=1,R=1-I*F/B;for(d.abs(R)<C&&(R=C),h=R=1/R;T<=100&&(R=1+(b=T*(g-T)*F/((O+(s=2*T))*(_+s)))*R,d.abs(R)<C&&(R=C),A=1+b/A,d.abs(A)<C&&(A=C),h*=(R=1/R)*A,R=1+(b=-(_+T)*(I+T)*F/((_+s)*(B+s)))*R,d.abs(R)<C&&(R=C),A=1+b/A,d.abs(A)<C&&(A=C),h*=j=(R=1/R)*A,!(d.abs(j-1)<3e-7));T++);return h},u.gammapinv=function(F,_){var g,s,b,j,h,C,T=0,I=_-1,B=u.gammaln(_);if(F>=1)return d.max(100,_+100*d.sqrt(_));if(F<=0)return 0;for(_>1?(h=d.log(I),C=d.exp(I*(h-1)-B),j=F<.5?F:1-F,g=(2.30753+.27061*(s=d.sqrt(-2*d.log(j))))/(1+s*(.99229+.04481*s))-s,F<.5&&(g=-g),g=d.max(.001,_*d.pow(1-1/(9*_)-g/(3*d.sqrt(_)),3))):g=F<(s=1-_*(.253+.12*_))?d.pow(F/s,1/_):1-d.log(1-(F-s)/(1-s));T<12;T++){if(g<=0)return 0;if((g-=s=(b=(u.lowRegGamma(_,g)-F)/(s=_>1?C*d.exp(-(g-I)+I*(d.log(g)-h)):d.exp(-g+I*d.log(g)-B)))/(1-.5*d.min(1,b*((_-1)/g-1))))<=0&&(g=.5*(g+s)),d.abs(s)<1e-8*g)break}return g},u.erf=function(F){var _,g,s,b,j=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=j.length-1,C=!1,T=0,I=0;for(F<0&&(F=-F,C=!0),g=4*(_=2/(2+F))-2;h>0;h--)s=T,T=g*T-I+j[h],I=s;return b=_*d.exp(-F*F+.5*(j[0]+g*T)-I),C?b-1:1-b},u.erfc=function(F){return 1-u.erf(F)},u.erfcinv=function(F){var _,g,s,b,j=0;if(F>=2)return-100;if(F<=0)return 100;for(b=F<1?F:2-F,_=-.70711*((2.30753+.27061*(s=d.sqrt(-2*d.log(b/2))))/(1+s*(.99229+.04481*s))-s);j<2;j++)_+=(g=u.erfc(_)-b)/(1.1283791670955126*d.exp(-_*_)-_*g);return F<1?_:-_},u.ibetainv=function(F,_,g){var s,b,j,h,C,T,I,B,O,A,R=_-1,Z=g-1,q=0;if(F<=0)return 0;if(F>=1)return 1;for(_>=1&&g>=1?(j=F<.5?F:1-F,T=(2.30753+.27061*(h=d.sqrt(-2*d.log(j))))/(1+h*(.99229+.04481*h))-h,F<.5&&(T=-T),I=(T*T-3)/6,B=2/(1/(2*_-1)+1/(2*g-1)),O=T*d.sqrt(I+B)/B-(1/(2*g-1)-1/(2*_-1))*(I+.8333333333333334-2/(3*B)),T=_/(_+g*d.exp(2*O))):(s=d.log(_/(_+g)),b=d.log(g/(_+g)),T=F<(h=d.exp(_*s)/_)/(O=h+(C=d.exp(g*b)/g))?d.pow(_*O*F,1/_):1-d.pow(g*O*(1-F),1/g)),A=-u.gammaln(_)-u.gammaln(g)+u.gammaln(_+g);q<10;q++){if(T===0||T===1)return T;if((T-=h=(C=(u.ibeta(T,_,g)-F)/(h=d.exp(R*d.log(T)+Z*d.log(1-T)+A)))/(1-.5*d.min(1,C*(R/T-Z/(1-T)))))<=0&&(T=.5*(T+h)),T>=1&&(T=.5*(T+h+1)),d.abs(h)<1e-8*T&&q>0)break}return T},u.ibeta=function(F,_,g){var s=F===0||F===1?0:d.exp(u.gammaln(_+g)-u.gammaln(_)-u.gammaln(g)+_*d.log(F)+g*d.log(1-F));return!(F<0||F>1)&&(F<(_+1)/(_+g+2)?s*u.betacf(F,_,g)/_:1-s*u.betacf(1-F,g,_)/g)},u.randn=function(F,_){var g,s,b,j,h;if(_||(_=F),F)return u.create(F,_,function(){return u.randn()});do g=u._random_fn(),s=1.7156*(u._random_fn()-.5),h=(b=g-.449871)*b+(j=d.abs(s)+.386595)*(.196*j-.25472*b);while(h>.27597&&(h>.27846||s*s>-4*d.log(g)*g*g));return s/g},u.randg=function(F,_,g){var s,b,j,h,C,T,I=F;if(g||(g=_),F||(F=1),_)return(T=u.zeros(_,g)).alter(function(){return u.randg(F)}),T;F<1&&(F+=1),s=F-.3333333333333333,b=1/d.sqrt(9*s);do{do h=1+b*(C=u.randn());while(h<=0);h*=h*h,j=u._random_fn()}while(j>1-.331*d.pow(C,4)&&d.log(j)>.5*C*C+s*(1-h+d.log(h)));if(F==I)return s*h;do j=u._random_fn();while(j===0);return d.pow(j,1/I)*s*h},function(F){for(var _=0;_<F.length;_++)(function(g){u.fn[g]=function(){return u(u.map(this,function(s){return u[g](s)}))}})(F[_])}("gammaln gammafn factorial factorialln".split(" ")),function(F){for(var _=0;_<F.length;_++)(function(g){u.fn[g]=function(){return u(u[g].apply(null,arguments))}})(F[_])}("randn".split(" "))}(m,Math),function(u,d){function F(g,s,b,j){for(var h,C=0,T=1,I=1,B=1,O=0,A=0;d.abs((I-A)/I)>j;)A=I,T=B+(h=-(s+O)*(s+b+O)*g/(s+2*O)/(s+2*O+1))*T,I=(C=I+h*C)+(h=(O+=1)*(b-O)*g/(s+2*O-1)/(s+2*O))*I,C/=B=T+h*B,T/=B,I/=B,B=1;return I/s}function _(g,s,b){var j=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],h=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],C=.5*g;if(C>=8)return 1;var T,I=2*u.normal.cdf(C,0,1,1,0)-1;I=I>=d.exp(-50/b)?d.pow(I,b):0;for(var B=C,O=(8-C)/(T=g>3?2:3),A=B+O,R=0,Z=b-1,q=1;q<=T;q++){for(var se=0,ge=.5*(A+B),ae=.5*(A-B),be=1;be<=12;be++){var Ae,je=ge+ae*(6<be?j[(Ae=12-be+1)-1]:-j[(Ae=be)-1]),ie=je*je;if(ie>60)break;var Pe=2*u.normal.cdf(je,0,1,1,0)*.5-2*u.normal.cdf(je,g,1,1,0)*.5;Pe>=d.exp(-30/Z)&&(se+=Pe=h[Ae-1]*d.exp(-.5*ie)*d.pow(Pe,Z))}R+=se*=2*ae*b/d.sqrt(2*d.PI),B=A,A+=O}return(I+=R)<=d.exp(-30/s)?0:(I=d.pow(I,s))>=1?1:I}(function(g){for(var s=0;s<g.length;s++)(function(b){u[b]=function j(h,C,T){return this instanceof j?(this._a=h,this._b=C,this._c=T,this):new j(h,C,T)},u.fn[b]=function(j,h,C){var T=u[b](j,h,C);return T.data=this,T},u[b].prototype.sample=function(j){var h=this._a,C=this._b,T=this._c;return j?u.alter(j,function(){return u[b].sample(h,C,T)}):u[b].sample(h,C,T)},function(j){for(var h=0;h<j.length;h++)(function(C){u[b].prototype[C]=function(T){var I=this._a,B=this._b,O=this._c;return T||T===0||(T=this.data),typeof T!="number"?u.fn.map.call(T,function(A){return u[b][C](A,I,B,O)}):u[b][C](T,I,B,O)}})(j[h])}("pdf cdf inv".split(" ")),function(j){for(var h=0;h<j.length;h++)(function(C){u[b].prototype[C]=function(){return u[b][C](this._a,this._b,this._c)}})(j[h])}("mean median mode variance".split(" "))})(g[s])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),u.extend(u.beta,{pdf:function(g,s,b){return g>1||g<0?0:s==1&&b==1?1:s<512&&b<512?d.pow(g,s-1)*d.pow(1-g,b-1)/u.betafn(s,b):d.exp((s-1)*d.log(g)+(b-1)*d.log(1-g)-u.betaln(s,b))},cdf:function(g,s,b){return g>1||g<0?1*(g>1):u.ibeta(g,s,b)},inv:function(g,s,b){return u.ibetainv(g,s,b)},mean:function(g,s){return g/(g+s)},median:function(g,s){return u.ibetainv(.5,g,s)},mode:function(g,s){return(g-1)/(g+s-2)},sample:function(g,s){var b=u.randg(g);return b/(b+u.randg(s))},variance:function(g,s){return g*s/(d.pow(g+s,2)*(g+s+1))}}),u.extend(u.centralF,{pdf:function(g,s,b){var j;return g<0?0:s<=2?g===0&&s<2?1/0:g===0&&s===2?1:1/u.betafn(s/2,b/2)*d.pow(s/b,s/2)*d.pow(g,s/2-1)*d.pow(1+s/b*g,-(s+b)/2):(j=s*g/(b+g*s),s*(b/(b+g*s))/2*u.binomial.pdf((s-2)/2,(s+b-2)/2,j))},cdf:function(g,s,b){return g<0?0:u.ibeta(s*g/(s*g+b),s/2,b/2)},inv:function(g,s,b){return b/(s*(1/u.ibetainv(g,s/2,b/2)-1))},mean:function(g,s){return s>2?s/(s-2):void 0},mode:function(g,s){return g>2?s*(g-2)/(g*(s+2)):void 0},sample:function(g,s){return 2*u.randg(g/2)/g/(2*u.randg(s/2)/s)},variance:function(g,s){if(!(s<=4))return 2*s*s*(g+s-2)/(g*(s-2)*(s-2)*(s-4))}}),u.extend(u.cauchy,{pdf:function(g,s,b){return b<0?0:b/(d.pow(g-s,2)+d.pow(b,2))/d.PI},cdf:function(g,s,b){return d.atan((g-s)/b)/d.PI+.5},inv:function(g,s,b){return s+b*d.tan(d.PI*(g-.5))},median:function(g){return g},mode:function(g){return g},sample:function(g,s){return u.randn()*d.sqrt(1/(2*u.randg(.5)))*s+g}}),u.extend(u.chisquare,{pdf:function(g,s){return g<0?0:g===0&&s===2?.5:d.exp((s/2-1)*d.log(g)-g/2-s/2*d.log(2)-u.gammaln(s/2))},cdf:function(g,s){return g<0?0:u.lowRegGamma(s/2,g/2)},inv:function(g,s){return 2*u.gammapinv(g,.5*s)},mean:function(g){return g},median:function(g){return g*d.pow(1-2/(9*g),3)},mode:function(g){return g-2>0?g-2:0},sample:function(g){return 2*u.randg(g/2)},variance:function(g){return 2*g}}),u.extend(u.exponential,{pdf:function(g,s){return g<0?0:s*d.exp(-s*g)},cdf:function(g,s){return g<0?0:1-d.exp(-s*g)},inv:function(g,s){return-d.log(1-g)/s},mean:function(g){return 1/g},median:function(g){return 1/g*d.log(2)},mode:function(){return 0},sample:function(g){return-1/g*d.log(u._random_fn())},variance:function(g){return d.pow(g,-2)}}),u.extend(u.gamma,{pdf:function(g,s,b){return g<0?0:g===0&&s===1?1/b:d.exp((s-1)*d.log(g)-g/b-u.gammaln(s)-s*d.log(b))},cdf:function(g,s,b){return g<0?0:u.lowRegGamma(s,g/b)},inv:function(g,s,b){return u.gammapinv(g,s)*b},mean:function(g,s){return g*s},mode:function(g,s){if(g>1)return(g-1)*s},sample:function(g,s){return u.randg(g)*s},variance:function(g,s){return g*s*s}}),u.extend(u.invgamma,{pdf:function(g,s,b){return g<=0?0:d.exp(-(s+1)*d.log(g)-b/g-u.gammaln(s)+s*d.log(b))},cdf:function(g,s,b){return g<=0?0:1-u.lowRegGamma(s,b/g)},inv:function(g,s,b){return b/u.gammapinv(1-g,s)},mean:function(g,s){return g>1?s/(g-1):void 0},mode:function(g,s){return s/(g+1)},sample:function(g,s){return s/u.randg(g)},variance:function(g,s){if(!(g<=2))return s*s/((g-1)*(g-1)*(g-2))}}),u.extend(u.kumaraswamy,{pdf:function(g,s,b){return g===0&&s===1?b:g===1&&b===1?s:d.exp(d.log(s)+d.log(b)+(s-1)*d.log(g)+(b-1)*d.log(1-d.pow(g,s)))},cdf:function(g,s,b){return g<0?0:g>1?1:1-d.pow(1-d.pow(g,s),b)},inv:function(g,s,b){return d.pow(1-d.pow(1-g,1/b),1/s)},mean:function(g,s){return s*u.gammafn(1+1/g)*u.gammafn(s)/u.gammafn(1+1/g+s)},median:function(g,s){return d.pow(1-d.pow(2,-1/s),1/g)},mode:function(g,s){if(g>=1&&s>=1&&g!==1&&s!==1)return d.pow((g-1)/(g*s-1),1/g)},variance:function(){throw new Error("variance not yet implemented")}}),u.extend(u.lognormal,{pdf:function(g,s,b){return g<=0?0:d.exp(-d.log(g)-.5*d.log(2*d.PI)-d.log(b)-d.pow(d.log(g)-s,2)/(2*b*b))},cdf:function(g,s,b){return g<0?0:.5+.5*u.erf((d.log(g)-s)/d.sqrt(2*b*b))},inv:function(g,s,b){return d.exp(-1.4142135623730951*b*u.erfcinv(2*g)+s)},mean:function(g,s){return d.exp(g+s*s/2)},median:function(g){return d.exp(g)},mode:function(g,s){return d.exp(g-s*s)},sample:function(g,s){return d.exp(u.randn()*s+g)},variance:function(g,s){return(d.exp(s*s)-1)*d.exp(2*g+s*s)}}),u.extend(u.noncentralt,{pdf:function(g,s,b){return d.abs(b)<1e-14?u.studentt.pdf(g,s):d.abs(g)<1e-14?d.exp(u.gammaln((s+1)/2)-b*b/2-.5*d.log(d.PI*s)-u.gammaln(s/2)):s/g*(u.noncentralt.cdf(g*d.sqrt(1+2/s),s+2,b)-u.noncentralt.cdf(g,s,b))},cdf:function(g,s,b){var j=1e-14;if(d.abs(b)<j)return u.studentt.cdf(g,s);var h=!1;g<0&&(h=!0,b=-b);for(var C=u.normal.cdf(-b,0,1),T=j+1,I=T,B=g*g/(g*g+s),O=0,A=d.exp(-b*b/2),R=d.exp(-b*b/2-.5*d.log(2)-u.gammaln(1.5))*b;O<200||I>j||T>j;)I=T,O>0&&(A*=b*b/(2*O),R*=b*b/(2*(O+.5))),C+=.5*(T=A*u.beta.cdf(B,O+.5,s/2)+R*u.beta.cdf(B,O+1,s/2)),O++;return h?1-C:C}}),u.extend(u.normal,{pdf:function(g,s,b){return d.exp(-.5*d.log(2*d.PI)-d.log(b)-d.pow(g-s,2)/(2*b*b))},cdf:function(g,s,b){return .5*(1+u.erf((g-s)/d.sqrt(2*b*b)))},inv:function(g,s,b){return-1.4142135623730951*b*u.erfcinv(2*g)+s},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},sample:function(g,s){return u.randn()*s+g},variance:function(g,s){return s*s}}),u.extend(u.pareto,{pdf:function(g,s,b){return g<s?0:b*d.pow(s,b)/d.pow(g,b+1)},cdf:function(g,s,b){return g<s?0:1-d.pow(s/g,b)},inv:function(g,s,b){return s/d.pow(1-g,1/b)},mean:function(g,s){if(!(s<=1))return s*d.pow(g,s)/(s-1)},median:function(g,s){return g*(s*d.SQRT2)},mode:function(g){return g},variance:function(g,s){if(!(s<=2))return g*g*s/(d.pow(s-1,2)*(s-2))}}),u.extend(u.studentt,{pdf:function(g,s){return s=s>1e100?1e100:s,1/(d.sqrt(s)*u.betafn(.5,s/2))*d.pow(1+g*g/s,-(s+1)/2)},cdf:function(g,s){var b=s/2;return u.ibeta((g+d.sqrt(g*g+s))/(2*d.sqrt(g*g+s)),b,b)},inv:function(g,s){var b=u.ibetainv(2*d.min(g,1-g),.5*s,.5);return b=d.sqrt(s*(1-b)/b),g>.5?b:-b},mean:function(g){return g>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(g){return u.randn()*d.sqrt(g/(2*u.randg(g/2)))},variance:function(g){return g>2?g/(g-2):g>1?1/0:void 0}}),u.extend(u.weibull,{pdf:function(g,s,b){return g<0||s<0||b<0?0:b/s*d.pow(g/s,b-1)*d.exp(-d.pow(g/s,b))},cdf:function(g,s,b){return g<0?0:1-d.exp(-d.pow(g/s,b))},inv:function(g,s,b){return s*d.pow(-d.log(1-g),1/b)},mean:function(g,s){return g*u.gammafn(1+1/s)},median:function(g,s){return g*d.pow(d.log(2),1/s)},mode:function(g,s){return s<=1?0:g*d.pow((s-1)/s,1/s)},sample:function(g,s){return g*d.pow(-d.log(u._random_fn()),1/s)},variance:function(g,s){return g*g*u.gammafn(1+2/s)-d.pow(u.weibull.mean(g,s),2)}}),u.extend(u.uniform,{pdf:function(g,s,b){return g<s||g>b?0:1/(b-s)},cdf:function(g,s,b){return g<s?0:g<b?(g-s)/(b-s):1},inv:function(g,s,b){return s+g*(b-s)},mean:function(g,s){return .5*(g+s)},median:function(g,s){return u.mean(g,s)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,s){return g/2+s/2+(s/2-g/2)*(2*u._random_fn()-1)},variance:function(g,s){return d.pow(s-g,2)/12}}),u.extend(u.binomial,{pdf:function(g,s,b){return b===0||b===1?s*b===g?1:0:u.combination(s,g)*d.pow(b,g)*d.pow(1-b,s-g)},cdf:function(g,s,b){var j,h=1e-10;if(g<0)return 0;if(g>=s)return 1;if(b<0||b>1||s<=0)return NaN;var C=b,T=(g=d.floor(g))+1,I=s-g,B=T+I,O=d.exp(u.gammaln(B)-u.gammaln(I)-u.gammaln(T)+T*d.log(C)+I*d.log(1-C));return j=C<(T+1)/(B+2)?O*F(C,T,I,h):1-O*F(1-C,I,T,h),d.round(1/h*(1-j))/(1/h)}}),u.extend(u.negbin,{pdf:function(g,s,b){return g===g>>>0&&(g<0?0:u.combination(g+s-1,s-1)*d.pow(1-b,g)*d.pow(b,s))},cdf:function(g,s,b){var j=0,h=0;if(g<0)return 0;for(;h<=g;h++)j+=u.negbin.pdf(h,s,b);return j}}),u.extend(u.hypgeom,{pdf:function(g,s,b,j){if(g!=g|0)return!1;if(g<0||g<b-(s-j)||g>j||g>b)return 0;if(2*b>s)return 2*j>s?u.hypgeom.pdf(s-b-j+g,s,s-b,s-j):u.hypgeom.pdf(j-g,s,s-b,j);if(2*j>s)return u.hypgeom.pdf(b-g,s,b,s-j);if(b<j)return u.hypgeom.pdf(g,s,j,b);for(var h=1,C=0,T=0;T<g;T++){for(;h>1&&C<j;)h*=1-b/(s-C),C++;h*=(j-T)*(b-T)/((T+1)*(s-b-j+T+1))}for(;C<j;C++)h*=1-b/(s-C);return d.min(1,d.max(0,h))},cdf:function(g,s,b,j){if(g<0||g<b-(s-j))return 0;if(g>=j||g>=b)return 1;if(2*b>s)return 2*j>s?u.hypgeom.cdf(s-b-j+g,s,s-b,s-j):1-u.hypgeom.cdf(j-g-1,s,s-b,j);if(2*j>s)return 1-u.hypgeom.cdf(b-g-1,s,b,s-j);if(b<j)return u.hypgeom.cdf(g,s,j,b);for(var h=1,C=1,T=0,I=0;I<g;I++){for(;h>1&&T<j;){var B=1-b/(s-T);C*=B,h*=B,T++}h+=C*=(j-I)*(b-I)/((I+1)*(s-b-j+I+1))}for(;T<j;T++)h*=1-b/(s-T);return d.min(1,d.max(0,h))}}),u.extend(u.poisson,{pdf:function(g,s){return s<0||g%1!=0||g<0?0:d.pow(s,g)*d.exp(-s)/u.factorial(g)},cdf:function(g,s){var b=[],j=0;if(g<0)return 0;for(;j<=g;j++)b.push(u.poisson.pdf(j,s));return u.sum(b)},mean:function(g){return g},variance:function(g){return g},sampleSmall:function(g){var s=1,b=0,j=d.exp(-g);do b++,s*=u._random_fn();while(s>j);return b-1},sampleLarge:function(g){var s,b,j,h,C,T,I,B,O,A,R=g;for(h=d.sqrt(R),C=d.log(R),T=.02483*(I=.931+2.53*h)-.059,B=1.1239+1.1328/(I-3.4),O=.9277-3.6224/(I-2);;)if(b=d.random()-.5,j=d.random(),A=.5-d.abs(b),s=d.floor((2*T/A+I)*b+R+.43),A>=.07&&j<=O||!(s<0||A<.013&&j>A)&&d.log(j)+d.log(B)-d.log(T/(A*A)+I)<=s*C-R-u.loggam(s+1))return s},sample:function(g){return g<10?this.sampleSmall(g):this.sampleLarge(g)}}),u.extend(u.triangular,{pdf:function(g,s,b,j){return b<=s||j<s||j>b?NaN:g<s||g>b?0:g<j?2*(g-s)/((b-s)*(j-s)):g===j?2/(b-s):2*(b-g)/((b-s)*(b-j))},cdf:function(g,s,b,j){return b<=s||j<s||j>b?NaN:g<=s?0:g>=b?1:g<=j?d.pow(g-s,2)/((b-s)*(j-s)):1-d.pow(b-g,2)/((b-s)*(b-j))},inv:function(g,s,b,j){return b<=s||j<s||j>b?NaN:g<=(j-s)/(b-s)?s+(b-s)*d.sqrt(g*((j-s)/(b-s))):s+(b-s)*(1-d.sqrt((1-g)*(1-(j-s)/(b-s))))},mean:function(g,s,b){return(g+s+b)/3},median:function(g,s,b){return b<=(g+s)/2?s-d.sqrt((s-g)*(s-b))/d.sqrt(2):b>(g+s)/2?g+d.sqrt((s-g)*(b-g))/d.sqrt(2):void 0},mode:function(g,s,b){return b},sample:function(g,s,b){var j=u._random_fn();return j<(b-g)/(s-g)?g+d.sqrt(j*(s-g)*(b-g)):s-d.sqrt((1-j)*(s-g)*(s-b))},variance:function(g,s,b){return(g*g+s*s+b*b-g*s-g*b-s*b)/18}}),u.extend(u.arcsine,{pdf:function(g,s,b){return b<=s?NaN:g<=s||g>=b?0:2/d.PI*d.pow(d.pow(b-s,2)-d.pow(2*g-s-b,2),-.5)},cdf:function(g,s,b){return g<s?0:g<b?2/d.PI*d.asin(d.sqrt((g-s)/(b-s))):1},inv:function(g,s,b){return s+(.5-.5*d.cos(d.PI*g))*(b-s)},mean:function(g,s){return s<=g?NaN:(g+s)/2},median:function(g,s){return s<=g?NaN:(g+s)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,s){return(g+s)/2+(s-g)/2*d.sin(2*d.PI*u.uniform.sample(0,1))},variance:function(g,s){return s<=g?NaN:d.pow(s-g,2)/8}}),u.extend(u.laplace,{pdf:function(g,s,b){return b<=0?0:d.exp(-d.abs(g-s)/b)/(2*b)},cdf:function(g,s,b){return b<=0?0:g<s?.5*d.exp((g-s)/b):1-.5*d.exp(-(g-s)/b)},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},variance:function(g,s){return 2*s*s},sample:function(g,s){var b,j=u._random_fn()-.5;return g-s*((b=j)/d.abs(b))*d.log(1-2*d.abs(j))}}),u.extend(u.tukey,{cdf:function(g,s,b){var j=s,h=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],C=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(g<=0)return 0;if(b<2||j<2)return NaN;if(!Number.isFinite(g))return 1;if(b>25e3)return _(g,1,j);var T,I=.5*b,B=I*d.log(b)-b*d.log(2)-u.gammaln(I),O=I-1,A=.25*b;T=b<=100?1:b<=800?.5:b<=5e3?.25:.125,B+=d.log(T);for(var R=0,Z=1;Z<=50;Z++){for(var q=0,se=(2*Z-1)*T,ge=1;ge<=16;ge++){var ae,be;8<ge?(ae=ge-8-1,be=B+O*d.log(se+h[ae]*T)-(h[ae]*T+se)*A):(ae=ge-1,be=B+O*d.log(se-h[ae]*T)+(h[ae]*T-se)*A),be>=-30&&(q+=_(8<ge?g*d.sqrt(.5*(h[ae]*T+se)):g*d.sqrt(.5*(-h[ae]*T+se)),1,j)*C[ae]*d.exp(be))}if(Z*T>=1&&q<=1e-14)break;R+=q}if(q>1e-14)throw new Error("tukey.cdf failed to converge");return R>1&&(R=1),R},inv:function(g,s,b){if(b<2||s<2)return NaN;if(g<0||g>1)return NaN;if(g===0)return 0;if(g===1)return 1/0;var j,h=function(O,A,R){var Z=.5-.5*O,q=d.sqrt(d.log(1/(Z*Z))),se=q+((((-453642210148e-16*q-.204231210125)*q-.342242088547)*q-1)*q+.322232421088)/((((.0038560700634*q+.10353775285)*q+.531103462366)*q+.588581570495)*q+.099348462606);R<120&&(se+=(se*se*se+se)/R/4);var ge=.8832-.2368*se;return R<120&&(ge+=-1.214/R+1.208*se/R),se*(ge*d.log(A-1)+1.4142)}(g,s,b),C=u.tukey.cdf(h,s,b)-g;j=C>0?d.max(0,h-1):h+1;for(var T,I=u.tukey.cdf(j,s,b)-g,B=1;B<50;B++)if(T=j-I*(j-h)/(I-C),C=I,h=j,T<0&&(T=0,I=-g),I=u.tukey.cdf(T,s,b)-g,j=T,d.abs(j-h)<1e-4)return T;throw new Error("tukey.inv failed to converge")}})}(m,Math),function(u,d){var F,_,g=Array.prototype.push,s=u.utils.isArray;function b(j){return s(j)||j instanceof u}u.extend({add:function(j,h){return b(h)?(b(h[0])||(h=[h]),u.map(j,function(C,T,I){return C+h[T][I]})):u.map(j,function(C){return C+h})},subtract:function(j,h){return b(h)?(b(h[0])||(h=[h]),u.map(j,function(C,T,I){return C-h[T][I]||0})):u.map(j,function(C){return C-h})},divide:function(j,h){return b(h)?(b(h[0])||(h=[h]),u.multiply(j,u.inv(h))):u.map(j,function(C){return C/h})},multiply:function(j,h){var C,T,I,B,O,A,R,Z;if(j.length===void 0&&h.length===void 0)return j*h;if(O=j.length,A=j[0].length,R=u.zeros(O,I=b(h)?h[0].length:A),Z=0,b(h)){for(;Z<I;Z++)for(C=0;C<O;C++){for(B=0,T=0;T<A;T++)B+=j[C][T]*h[T][Z];R[C][Z]=B}return O===1&&Z===1?R[0][0]:R}return u.map(j,function(q){return q*h})},outer:function(j,h){return u.multiply(j.map(function(C){return[C]}),[h])},dot:function(j,h){b(j[0])||(j=[j]),b(h[0])||(h=[h]);for(var C,T,I=j[0].length===1&&j.length!==1?u.transpose(j):j,B=h[0].length===1&&h.length!==1?u.transpose(h):h,O=[],A=0,R=I.length,Z=I[0].length;A<R;A++){for(O[A]=[],C=0,T=0;T<Z;T++)C+=I[A][T]*B[A][T];O[A]=C}return O.length===1?O[0]:O},pow:function(j,h){return u.map(j,function(C){return d.pow(C,h)})},exp:function(j){return u.map(j,function(h){return d.exp(h)})},log:function(j){return u.map(j,function(h){return d.log(h)})},abs:function(j){return u.map(j,function(h){return d.abs(h)})},norm:function(j,h){var C=0,T=0;for(isNaN(h)&&(h=2),b(j[0])&&(j=j[0]);T<j.length;T++)C+=d.pow(d.abs(j[T]),h);return d.pow(C,1/h)},angle:function(j,h){return d.acos(u.dot(j,h)/(u.norm(j)*u.norm(h)))},aug:function(j,h){var C,T=[];for(C=0;C<j.length;C++)T.push(j[C].slice());for(C=0;C<T.length;C++)g.apply(T[C],h[C]);return T},inv:function(j){for(var h,C=j.length,T=j[0].length,I=u.identity(C,T),B=u.gauss_jordan(j,I),O=[],A=0;A<C;A++)for(O[A]=[],h=T;h<B[0].length;h++)O[A][h-T]=B[A][h];return O},det:function j(h){if(h.length===2)return h[0][0]*h[1][1]-h[0][1]*h[1][0];for(var C=0,T=0;T<h.length;T++){for(var I=[],B=1;B<h.length;B++){I[B-1]=[];for(var O=0;O<h.length;O++)O<T?I[B-1][O]=h[B][O]:O>T&&(I[B-1][O-1]=h[B][O])}var A=T%2?-1:1;C+=j(I)*h[0][T]*A}return C},gauss_elimination:function(j,h){var C,T,I,B,O=0,A=0,R=j.length,Z=j[0].length,q=1,se=0,ge=[];for(C=(j=u.aug(j,h))[0].length,O=0;O<R;O++){for(T=j[O][O],A=O,B=O+1;B<Z;B++)T<d.abs(j[B][O])&&(T=j[B][O],A=B);if(A!=O)for(B=0;B<C;B++)I=j[O][B],j[O][B]=j[A][B],j[A][B]=I;for(A=O+1;A<R;A++)for(q=j[A][O]/j[O][O],B=O;B<C;B++)j[A][B]=j[A][B]-q*j[O][B]}for(O=R-1;O>=0;O--){for(se=0,A=O+1;A<=R-1;A++)se+=ge[A]*j[O][A];ge[O]=(j[O][C-1]-se)/j[O][O]}return ge},gauss_jordan:function(j,h){var C,T,I,B=u.aug(j,h),O=B.length,A=B[0].length,R=0;for(T=0;T<O;T++){var Z=T;for(I=T+1;I<O;I++)d.abs(B[I][T])>d.abs(B[Z][T])&&(Z=I);var q=B[T];for(B[T]=B[Z],B[Z]=q,I=T+1;I<O;I++)for(R=B[I][T]/B[T][T],C=T;C<A;C++)B[I][C]-=B[T][C]*R}for(T=O-1;T>=0;T--){for(R=B[T][T],I=0;I<T;I++)for(C=A-1;C>T-1;C--)B[I][C]-=B[T][C]*B[I][T]/R;for(B[T][T]/=R,C=O;C<A;C++)B[T][C]/=R}return B},triaUpSolve:function(j,h){var C,T=j[0].length,I=u.zeros(1,T)[0],B=!1;return h[0].length!=null&&(h=h.map(function(O){return O[0]}),B=!0),u.arange(T-1,-1,-1).forEach(function(O){C=u.arange(O+1,T).map(function(A){return I[A]*j[O][A]}),I[O]=(h[O]-u.sum(C))/j[O][O]}),B?I.map(function(O){return[O]}):I},triaLowSolve:function(j,h){var C,T=j[0].length,I=u.zeros(1,T)[0],B=!1;return h[0].length!=null&&(h=h.map(function(O){return O[0]}),B=!0),u.arange(T).forEach(function(O){C=u.arange(O).map(function(A){return j[O][A]*I[A]}),I[O]=(h[O]-u.sum(C))/j[O][O]}),B?I.map(function(O){return[O]}):I},lu:function(j){var h,C=j.length,T=u.identity(C),I=u.zeros(j.length,j[0].length);return u.arange(C).forEach(function(B){I[0][B]=j[0][B]}),u.arange(1,C).forEach(function(B){u.arange(B).forEach(function(O){h=u.arange(O).map(function(A){return T[B][A]*I[A][O]}),T[B][O]=(j[B][O]-u.sum(h))/I[O][O]}),u.arange(B,C).forEach(function(O){h=u.arange(B).map(function(A){return T[B][A]*I[A][O]}),I[B][O]=j[h.length][O]-u.sum(h)})}),[T,I]},cholesky:function(j){var h,C=j.length,T=u.zeros(j.length,j[0].length);return u.arange(C).forEach(function(I){h=u.arange(I).map(function(B){return d.pow(T[I][B],2)}),T[I][I]=d.sqrt(j[I][I]-u.sum(h)),u.arange(I+1,C).forEach(function(B){h=u.arange(I).map(function(O){return T[I][O]*T[B][O]}),T[B][I]=(j[I][B]-u.sum(h))/T[I][I]})}),T},gauss_jacobi:function(j,h,C,T){for(var I,B,O,A,R=0,Z=0,q=j.length,se=[],ge=[],ae=[];R<q;R++)for(se[R]=[],ge[R]=[],ae[R]=[],Z=0;Z<q;Z++)R>Z?(se[R][Z]=j[R][Z],ge[R][Z]=ae[R][Z]=0):R<Z?(ge[R][Z]=j[R][Z],se[R][Z]=ae[R][Z]=0):(ae[R][Z]=j[R][Z],se[R][Z]=ge[R][Z]=0);for(O=u.multiply(u.multiply(u.inv(ae),u.add(se,ge)),-1),B=u.multiply(u.inv(ae),h),I=C,A=u.add(u.multiply(O,C),B),R=2;d.abs(u.norm(u.subtract(A,I)))>T;)I=A,A=u.add(u.multiply(O,I),B),R++;return A},gauss_seidel:function(j,h,C,T){for(var I,B,O,A,R,Z=0,q=j.length,se=[],ge=[],ae=[];Z<q;Z++)for(se[Z]=[],ge[Z]=[],ae[Z]=[],I=0;I<q;I++)Z>I?(se[Z][I]=j[Z][I],ge[Z][I]=ae[Z][I]=0):Z<I?(ge[Z][I]=j[Z][I],se[Z][I]=ae[Z][I]=0):(ae[Z][I]=j[Z][I],se[Z][I]=ge[Z][I]=0);for(A=u.multiply(u.multiply(u.inv(u.add(ae,se)),ge),-1),O=u.multiply(u.inv(u.add(ae,se)),h),B=C,R=u.add(u.multiply(A,C),O),Z=2;d.abs(u.norm(u.subtract(R,B)))>T;)B=R,R=u.add(u.multiply(A,B),O),Z+=1;return R},SOR:function(j,h,C,T,I){for(var B,O,A,R,Z,q=0,se=j.length,ge=[],ae=[],be=[];q<se;q++)for(ge[q]=[],ae[q]=[],be[q]=[],B=0;B<se;B++)q>B?(ge[q][B]=j[q][B],ae[q][B]=be[q][B]=0):q<B?(ae[q][B]=j[q][B],ge[q][B]=be[q][B]=0):(be[q][B]=j[q][B],ge[q][B]=ae[q][B]=0);for(R=u.multiply(u.inv(u.add(be,u.multiply(ge,I))),u.subtract(u.multiply(be,1-I),u.multiply(ae,I))),A=u.multiply(u.multiply(u.inv(u.add(be,u.multiply(ge,I))),h),I),O=C,Z=u.add(u.multiply(R,C),A),q=2;d.abs(u.norm(u.subtract(Z,O)))>T;)O=Z,Z=u.add(u.multiply(R,O),A),q++;return Z},householder:function(j){for(var h,C,T,I,B=j.length,O=j[0].length,A=0,R=[],Z=[];A<B-1;A++){for(h=0,I=A+1;I<O;I++)h+=j[I][A]*j[I][A];for(h=(j[A+1][A]>0?-1:1)*d.sqrt(h),C=d.sqrt((h*h-j[A+1][A]*h)/2),(R=u.zeros(B,1))[A+1][0]=(j[A+1][A]-h)/(2*C),T=A+2;T<B;T++)R[T][0]=j[T][A]/(2*C);Z=u.subtract(u.identity(B,O),u.multiply(u.multiply(R,u.transpose(R)),2)),j=u.multiply(Z,u.multiply(j,Z))}return j},QR:(F=u.sum,_=u.arange,function(j){var h,C,T,I=j.length,B=j[0].length,O=u.zeros(B,B);for(j=u.copy(j),C=0;C<B;C++){for(O[C][C]=d.sqrt(F(_(I).map(function(A){return j[A][C]*j[A][C]}))),h=0;h<I;h++)j[h][C]=j[h][C]/O[C][C];for(T=C+1;T<B;T++)for(O[C][T]=F(_(I).map(function(A){return j[A][C]*j[A][T]})),h=0;h<I;h++)j[h][T]=j[h][T]-j[h][C]*O[C][T]}return[j,O]}),lstsq:function(j,h){var C=!1;h[0].length===void 0&&(h=h.map(function(se){return[se]}),C=!0);var T=u.QR(j),I=T[0],B=T[1],O=j[0].length,A=u.slice(I,{col:{end:O}}),R=function(se){var ge=(se=u.copy(se)).length,ae=u.identity(ge);return u.arange(ge-1,-1,-1).forEach(function(be){u.sliceAssign(ae,{row:be},u.divide(u.slice(ae,{row:be}),se[be][be])),u.sliceAssign(se,{row:be},u.divide(u.slice(se,{row:be}),se[be][be])),u.arange(be).forEach(function(Ae){var je=u.multiply(se[Ae][be],-1),ie=u.slice(se,{row:Ae}),Pe=u.multiply(u.slice(se,{row:be}),je);u.sliceAssign(se,{row:Ae},u.add(ie,Pe));var Ye=u.slice(ae,{row:Ae}),Ve=u.multiply(u.slice(ae,{row:be}),je);u.sliceAssign(ae,{row:Ae},u.add(Ye,Ve))})}),ae}(u.slice(B,{row:{end:O}})),Z=u.transpose(A);Z[0].length===void 0&&(Z=[Z]);var q=u.multiply(u.multiply(R,Z),h);return q.length===void 0&&(q=[[q]]),C?q.map(function(se){return se[0]}):q},jacobi:function(j){for(var h,C,T,I,B,O,A,R=1,Z=j.length,q=u.identity(Z,Z),se=[];R===1;){for(B=j[0][1],T=0,I=1,h=0;h<Z;h++)for(C=0;C<Z;C++)h!=C&&B<d.abs(j[h][C])&&(B=d.abs(j[h][C]),T=h,I=C);for(O=j[T][T]===j[I][I]?j[T][I]>0?d.PI/4:-d.PI/4:d.atan(2*j[T][I]/(j[T][T]-j[I][I]))/2,(A=u.identity(Z,Z))[T][T]=d.cos(O),A[T][I]=-d.sin(O),A[I][T]=d.sin(O),A[I][I]=d.cos(O),q=u.multiply(q,A),j=u.multiply(u.multiply(u.inv(A),j),A),R=0,h=1;h<Z;h++)for(C=1;C<Z;C++)h!=C&&d.abs(j[h][C])>.001&&(R=1)}for(h=0;h<Z;h++)se.push(j[h][h]);return[q,se]},rungekutta:function(j,h,C,T,I,B){var O,A,R;if(B===2)for(;T<=C;)I+=((O=h*j(T,I))+(A=h*j(T+h,I+O)))/2,T+=h;if(B===4)for(;T<=C;)I+=((O=h*j(T,I))+2*(A=h*j(T+h/2,I+O/2))+2*(R=h*j(T+h/2,I+A/2))+h*j(T+h,I+R))/6,T+=h;return I},romberg:function(j,h,C,T){for(var I,B,O,A,R,Z=0,q=(C-h)/2,se=[],ge=[],ae=[];Z<T/2;){for(R=j(h),O=h,A=0;O<=C;O+=q,A++)se[A]=O;for(I=se.length,O=1;O<I-1;O++)R+=(O%2!=0?4:2)*j(se[O]);R=q/3*(R+j(C)),ae[Z]=R,q/=2,Z++}for(B=ae.length,I=1;B!==1;){for(O=0;O<B-1;O++)ge[O]=(d.pow(4,I)*ae[O+1]-ae[O])/(d.pow(4,I)-1);B=ge.length,ae=ge,ge=[],I++}return ae},richardson:function(j,h,C,T){function I(be,Ae){for(var je,ie=0,Pe=be.length;ie<Pe;ie++)be[ie]===Ae&&(je=ie);return je}for(var B,O,A,R,Z,q=d.abs(C-j[I(j,C)+1]),se=0,ge=[],ae=[];T>=q;)B=I(j,C+T),O=I(j,C),ge[se]=(h[B]-2*h[O]+h[2*O-B])/(T*T),T/=2,se++;for(R=ge.length,A=1;R!=1;){for(Z=0;Z<R-1;Z++)ae[Z]=(d.pow(4,A)*ge[Z+1]-ge[Z])/(d.pow(4,A)-1);R=ae.length,ge=ae,ae=[],A++}return ge},simpson:function(j,h,C,T){for(var I,B=(C-h)/T,O=j(h),A=[],R=h,Z=0,q=1;R<=C;R+=B,Z++)A[Z]=R;for(I=A.length;q<I-1;q++)O+=(q%2!=0?4:2)*j(A[q]);return B/3*(O+j(C))},hermite:function(j,h,C,T){for(var I,B=j.length,O=0,A=0,R=[],Z=[],q=[],se=[];A<B;A++){for(R[A]=1,I=0;I<B;I++)A!=I&&(R[A]*=(T-j[I])/(j[A]-j[I]));for(Z[A]=0,I=0;I<B;I++)A!=I&&(Z[A]+=1/(j[A]-j[I]));q[A]=(1-2*(T-j[A])*Z[A])*(R[A]*R[A]),se[A]=(T-j[A])*(R[A]*R[A]),O+=q[A]*h[A]+se[A]*C[A]}return O},lagrange:function(j,h,C){for(var T,I,B=0,O=0,A=j.length;O<A;O++){for(I=h[O],T=0;T<A;T++)O!=T&&(I*=(C-j[T])/(j[O]-j[T]));B+=I}return B},cubic_spline:function(j,h,C){for(var T,I,B=j.length,O=0,A=[],R=[],Z=[],q=[],se=[],ge=[];O<B-1;O++)q[O]=j[O+1]-j[O];for(Z[0]=0,O=1;O<B-1;O++)Z[O]=3/q[O]*(h[O+1]-h[O])-3/q[O-1]*(h[O]-h[O-1]);for(O=1;O<B-1;O++)A[O]=[],R[O]=[],A[O][O-1]=q[O-1],A[O][O]=2*(q[O-1]+q[O]),A[O][O+1]=q[O],R[O][0]=Z[O];for(I=u.multiply(u.inv(A),R),T=0;T<B-1;T++)se[T]=(h[T+1]-h[T])/q[T]-q[T]*(I[T+1][0]+2*I[T][0])/3,ge[T]=(I[T+1][0]-I[T][0])/(3*q[T]);for(T=0;T<B&&!(j[T]>C);T++);return h[T-=1]+(C-j[T])*se[T]+u.sq(C-j[T])*I[T]+(C-j[T])*u.sq(C-j[T])*ge[T]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(j){var h,C,T,I,B,O=j.length,A=j[0].length,R=0,Z=[],q=[],se=[],ge=[],ae=[],be=[],Ae=[];for(R=0;R<O;R++)Z[R]=u.sum(j[R])/A;for(R=0;R<A;R++)for(ae[R]=[],h=0;h<O;h++)ae[R][h]=j[h][R]-Z[h];for(ae=u.transpose(ae),R=0;R<O;R++)for(be[R]=[],h=0;h<O;h++)be[R][h]=u.dot([ae[R]],[ae[h]])/(A-1);for(B=(T=u.jacobi(be))[0],q=T[1],Ae=u.transpose(B),R=0;R<q.length;R++)for(h=R;h<q.length;h++)q[R]<q[h]&&(C=q[R],q[R]=q[h],q[h]=C,se=Ae[R],Ae[R]=Ae[h],Ae[h]=se);for(I=u.transpose(ae),R=0;R<O;R++)for(ge[R]=[],h=0;h<I.length;h++)ge[R][h]=u.dot([Ae[R]],[I[h]]);return[j,q,Ae,ge]}}),function(j){for(var h=0;h<j.length;h++)(function(C){u.fn[C]=function(T,I){var B=this;return I?(setTimeout(function(){I.call(B,u.fn[C].call(B,T))},15),this):typeof u[C](this,T)=="number"?u[C](this,T):u(u[C](this,T))}})(j[h])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(m,Math),function(u,d){var F=[].slice,_=u.utils.isNumber,g=u.utils.isArray;function s(b,j,h,C){if(b>1||h>1||b<=0||h<=0)throw new Error("Proportions should be greater than 0 and less than 1");var T=(b*j+h*C)/(j+C);return(b-h)/d.sqrt(T*(1-T)*(1/j+1/C))}u.extend({zscore:function(){var b=F.call(arguments);return _(b[1])?(b[0]-b[1])/b[2]:(b[0]-u.mean(b[1]))/u.stdev(b[1],b[2])},ztest:function(){var b,j=F.call(arguments);return g(j[1])?(b=u.zscore(j[0],j[1],j[3]),j[2]===1?u.normal.cdf(-d.abs(b),0,1):2*u.normal.cdf(-d.abs(b),0,1)):j.length>2?(b=u.zscore(j[0],j[1],j[2]),j[3]===1?u.normal.cdf(-d.abs(b),0,1):2*u.normal.cdf(-d.abs(b),0,1)):(b=j[0],j[1]===1?u.normal.cdf(-d.abs(b),0,1):2*u.normal.cdf(-d.abs(b),0,1))}}),u.extend(u.fn,{zscore:function(b,j){return(b-this.mean())/this.stdev(j)},ztest:function(b,j,h){var C=d.abs(this.zscore(b,h));return j===1?u.normal.cdf(-C,0,1):2*u.normal.cdf(-C,0,1)}}),u.extend({tscore:function(){var b=F.call(arguments);return b.length===4?(b[0]-b[1])/(b[2]/d.sqrt(b[3])):(b[0]-u.mean(b[1]))/(u.stdev(b[1],!0)/d.sqrt(b[1].length))},ttest:function(){var b,j=F.call(arguments);return j.length===5?(b=d.abs(u.tscore(j[0],j[1],j[2],j[3])),j[4]===1?u.studentt.cdf(-b,j[3]-1):2*u.studentt.cdf(-b,j[3]-1)):_(j[1])?(b=d.abs(j[0]),j[2]==1?u.studentt.cdf(-b,j[1]-1):2*u.studentt.cdf(-b,j[1]-1)):(b=d.abs(u.tscore(j[0],j[1])),j[2]==1?u.studentt.cdf(-b,j[1].length-1):2*u.studentt.cdf(-b,j[1].length-1))}}),u.extend(u.fn,{tscore:function(b){return(b-this.mean())/(this.stdev(!0)/d.sqrt(this.cols()))},ttest:function(b,j){return j===1?1-u.studentt.cdf(d.abs(this.tscore(b)),this.cols()-1):2*u.studentt.cdf(-d.abs(this.tscore(b)),this.cols()-1)}}),u.extend({anovafscore:function(){var b,j,h,C,T,I,B,O,A=F.call(arguments);if(A.length===1){for(T=new Array(A[0].length),B=0;B<A[0].length;B++)T[B]=A[0][B];A=T}for(j=new Array,B=0;B<A.length;B++)j=j.concat(A[B]);for(h=u.mean(j),b=0,B=0;B<A.length;B++)b+=A[B].length*d.pow(u.mean(A[B])-h,2);for(b/=A.length-1,I=0,B=0;B<A.length;B++)for(C=u.mean(A[B]),O=0;O<A[B].length;O++)I+=d.pow(A[B][O]-C,2);return b/(I/(j.length-A.length))},anovaftest:function(){var b,j,h,C,T=F.call(arguments);if(_(T[0]))return 1-u.centralF.cdf(T[0],T[1],T[2]);var I=u.anovafscore(T);for(b=T.length-1,h=0,C=0;C<T.length;C++)h+=T[C].length;return j=h-b-1,1-u.centralF.cdf(I,b,j)},ftest:function(b,j,h){return 1-u.centralF.cdf(b,j,h)}}),u.extend(u.fn,{anovafscore:function(){return u.anovafscore(this.toArray())},anovaftes:function(){var b,j=0;for(b=0;b<this.length;b++)j+=this[b].length;return u.ftest(this.anovafscore(),this.length-1,j-this.length)}}),u.extend({qscore:function(){var b,j,h,C,T,I=F.call(arguments);return _(I[0])?(b=I[0],j=I[1],h=I[2],C=I[3],T=I[4]):(b=u.mean(I[0]),j=u.mean(I[1]),h=I[0].length,C=I[1].length,T=I[2]),d.abs(b-j)/(T*d.sqrt((1/h+1/C)/2))},qtest:function(){var b,j=F.call(arguments);j.length===3?(b=j[0],j=j.slice(1)):j.length===7?(b=u.qscore(j[0],j[1],j[2],j[3],j[4]),j=j.slice(5)):(b=u.qscore(j[0],j[1],j[2]),j=j.slice(3));var h=j[0],C=j[1];return 1-u.tukey.cdf(b,C,h-C)},tukeyhsd:function(b){for(var j=u.pooledstdev(b),h=b.map(function(A){return u.mean(A)}),C=b.reduce(function(A,R){return A+R.length},0),T=[],I=0;I<b.length;++I)for(var B=I+1;B<b.length;++B){var O=u.qtest(h[I],h[B],b[I].length,b[B].length,j,C,b.length);T.push([[I,B],O])}return T}}),u.extend({normalci:function(){var b,j=F.call(arguments),h=new Array(2);return b=j.length===4?d.abs(u.normal.inv(j[1]/2,0,1)*j[2]/d.sqrt(j[3])):d.abs(u.normal.inv(j[1]/2,0,1)*u.stdev(j[2])/d.sqrt(j[2].length)),h[0]=j[0]-b,h[1]=j[0]+b,h},tci:function(){var b,j=F.call(arguments),h=new Array(2);return b=j.length===4?d.abs(u.studentt.inv(j[1]/2,j[3]-1)*j[2]/d.sqrt(j[3])):d.abs(u.studentt.inv(j[1]/2,j[2].length-1)*u.stdev(j[2],!0)/d.sqrt(j[2].length)),h[0]=j[0]-b,h[1]=j[0]+b,h},significant:function(b,j){return b<j}}),u.extend(u.fn,{normalci:function(b,j){return u.normalci(b,j,this.toArray())},tci:function(b,j){return u.tci(b,j,this.toArray())}}),u.extend(u.fn,{oneSidedDifferenceOfProportions:function(b,j,h,C){var T=s(b,j,h,C);return u.ztest(T,1)},twoSidedDifferenceOfProportions:function(b,j,h,C){var T=s(b,j,h,C);return u.ztest(T,2)}})}(m,Math),m.models=function(){function u(d,F){var _=d.length,g=F[0].length-1,s=_-g-1,b=m.lstsq(F,d),j=m.multiply(F,b.map(function(O){return[O]})).map(function(O){return O[0]}),h=m.subtract(d,j),C=m.mean(d),T=m.sum(j.map(function(O){return Math.pow(O-C,2)})),I=m.sum(d.map(function(O,A){return Math.pow(O-j[A],2)})),B=T+I;return{exog:F,endog:d,nobs:_,df_model:g,df_resid:s,coef:b,predict:j,resid:h,ybar:C,SST:B,SSE:T,SSR:I,R2:T/B}}return{ols:function(d,F){var _=u(d,F),g=function(j){var h,C,T=(h=j.exog,C=h[0].length,m.arange(C).map(function(q){var se=m.arange(C).filter(function(ge){return ge!==q});return u(m.col(h,q).map(function(ge){return ge[0]}),m.col(h,se))})),I=Math.sqrt(j.SSR/j.df_resid),B=T.map(function(q){var se=q.SST,ge=q.R2;return I/Math.sqrt(se*(1-ge))}),O=j.coef.map(function(q,se){return(q-0)/B[se]}),A=O.map(function(q){var se=m.studentt.cdf(q,j.df_resid);return 2*(se>.5?1-se:se)}),R=m.studentt.inv(.975,j.df_resid),Z=j.coef.map(function(q,se){var ge=R*B[se];return[q-ge,q+ge]});return{se:B,t:O,p:A,sigmaHat:I,interval95:Z}}(_),s=function(j){var h,C,T,I=j.R2/j.df_model/((1-j.R2)/j.df_resid);return{F_statistic:I,pvalue:1-(h=I,C=j.df_model,T=j.df_resid,m.beta.cdf(h/(T/C+h),C/2,T/2))}}(_),b=1-(1-_.R2)*((_.nobs-1)/_.df_resid);return _.t=g,_.f=s,_.adjust_R2=b,_}}}(),m.extend({buildxmatrix:function(){for(var u=new Array(arguments.length),d=0;d<arguments.length;d++)u[d]=[1].concat(arguments[d]);return m(u)},builddxmatrix:function(){for(var u=new Array(arguments[0].length),d=0;d<arguments[0].length;d++)u[d]=[1].concat(arguments[0][d]);return m(u)},buildjxmatrix:function(u){for(var d=new Array(u.length),F=0;F<u.length;F++)d[F]=u[F];return m.builddxmatrix(d)},buildymatrix:function(u){return m(u).transpose()},buildjymatrix:function(u){return u.transpose()},matrixmult:function(u,d){var F,_,g,s,b;if(u.cols()==d.rows()){if(d.rows()>1){for(s=[],F=0;F<u.rows();F++)for(s[F]=[],_=0;_<d.cols();_++){for(b=0,g=0;g<u.cols();g++)b+=u.toArray()[F][g]*d.toArray()[g][_];s[F][_]=b}return m(s)}for(s=[],F=0;F<u.rows();F++)for(s[F]=[],_=0;_<d.cols();_++){for(b=0,g=0;g<u.cols();g++)b+=u.toArray()[F][g]*d.toArray()[_];s[F][_]=b}return m(s)}},regress:function(u,d){var F=m.xtranspxinv(u),_=u.transpose(),g=m.matrixmult(m(F),_);return m.matrixmult(g,d)},regresst:function(u,d,F){var _=m.regress(u,d),g={anova:{}},s=m.jMatYBar(u,_);g.yBar=s;var b=d.mean();g.anova.residuals=m.residuals(d,s),g.anova.ssr=m.ssr(s,b),g.anova.msr=g.anova.ssr/(u[0].length-1),g.anova.sse=m.sse(d,s),g.anova.mse=g.anova.sse/(d.length-(u[0].length-1)-1),g.anova.sst=m.sst(d,b),g.anova.mst=g.anova.sst/(d.length-1),g.anova.r2=1-g.anova.sse/g.anova.sst,g.anova.r2<0&&(g.anova.r2=0),g.anova.fratio=g.anova.msr/g.anova.mse,g.anova.pvalue=m.anovaftest(g.anova.fratio,u[0].length-1,d.length-(u[0].length-1)-1),g.anova.rmse=Math.sqrt(g.anova.mse),g.anova.r2adj=1-g.anova.mse/g.anova.mst,g.anova.r2adj<0&&(g.anova.r2adj=0),g.stats=new Array(u[0].length);for(var j,h,C,T=m.xtranspxinv(u),I=0;I<_.length;I++)j=Math.sqrt(g.anova.mse*Math.abs(T[I][I])),h=Math.abs(_[I]/j),C=m.ttest(h,d.length-u[0].length-1,F),g.stats[I]=[_[I],j,h,C];return g.regress=_,g},xtranspx:function(u){return m.matrixmult(u.transpose(),u)},xtranspxinv:function(u){var d=m.matrixmult(u.transpose(),u);return m.inv(d)},jMatYBar:function(u,d){var F=m.matrixmult(u,d);return new m(F)},residuals:function(u,d){return m.matrixsubtract(u,d)},ssr:function(u,d){for(var F=0,_=0;_<u.length;_++)F+=Math.pow(u[_]-d,2);return F},sse:function(u,d){for(var F=0,_=0;_<u.length;_++)F+=Math.pow(u[_]-d[_],2);return F},sst:function(u,d){for(var F=0,_=0;_<u.length;_++)F+=Math.pow(u[_]-d,2);return F},matrixsubtract:function(u,d){for(var F=new Array(u.length),_=0;_<u.length;_++){F[_]=new Array(u[_].length);for(var g=0;g<u[_].length;g++)F[_][g]=u[_][g]-d[_][g]}return m(F)}}),m.jStat=m,m)},960:function(W,m,u){const d=u(592);W.exports=function(F){function _(I,B){const O=B.split(".");let A=I;for(const R of O){if(A==null)return;A=A[R]}return A}for(let I=0;I<Object.keys(d).length;I++){let B,O=Object.keys(d)[I],A=[];if(typeof d[O]=="object"){A=Object.keys(d[O]),B=Object.values(d[O]);for(let R=0;R<B.length;R++)if(typeof B[R]=="object"){let Z=A[R];d[O][Z]&&(A=[...A,...Object.keys(d[O][Z]).map(q=>Z+"."+q)],A.splice(A.indexOf(Z),1))}}if(A.length<1)F[O]=d[O];else for(let R=0;R<A.length;R++)typeof _(d[O],A[R])=="function"&&(F[O]=_(d[O],A[R]))}let g=function(I){return typeof I=="number"&&(I=parseInt(I)),I},s=null,b=null,j=null;F.TABLE=function(){return j},F.COLUMN=F.COL=function(){return j.tracking&&j.tracking.push(T.getColumnNameFromCoords(g(s),g(b))),g(s)+1},F.ROW=function(){return j.tracking&&j.tracking.push(T.getColumnNameFromCoords(g(s),g(b))),g(b)+1},F.CELL=function(){return T.getColumnNameFromCoords(s,b)},F.VALUE=function(I,B,O){return j.getValueFromCoords(g(I)-1,g(B)-1,O)},F.THISROWCELL=function(I){return j.getValueFromCoords(g(I)-1,g(b))};const h=function(I,B){for(let O=0;O<I.length;O++){let A=T.getTokensFromRange(I[O]);B=B.replace(I[O],"["+A.join(",")+"]")}return B},C=function(I){return typeof I=="string"&&(I=I.trim()),!isNaN(I)&&I!==null&&I!==""},T=function(I,B,O,A,R){j=R,s=O,b=A;let Z="",q={};if(B)if(B.size){let ae,be=null;B.forEach(function(Ae,je){ae=je.replace(/!/g,"."),ae.indexOf(".")!==-1&&(ae=ae.split("."),q[ae[0]]=!0)}),ae=Object.keys(q);for(let Ae=0;Ae<ae.length;Ae++)Z+="var "+ae[Ae]+" = {};";B.forEach(function(Ae,je){ae=je.replace(/!/g,"."),Ae===null||C(Ae)||(be=Ae.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),be&&be.length&&(Ae=updateRanges(be,Ae))),ae.indexOf(".")>0?Z+=ae+" = "+B.get(je)+`;
`:Z+="var "+ae+" = "+Ae+`;
`})}else{let ae=Object.keys(B);if(ae.length){let be,Ae={};for(let je=0;je<ae.length;je++)if(be=ae[je].replace(/\!/g,"."),be.indexOf(".")>0){let ie=ie.split(".");Ae[ie[0]]={}}be=Object.keys(Ae);for(let je=0;je<be.length;je++)Z+="var "+be[je]+" = {};";for(let je=0;je<ae.length;je++){if(be=ae[je].replace(/!/g,"."),B[ae[je]]!==null&&!C(B[ae[je]])){let ie=B[ae[je]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ie&&ie.length&&(B[ae[je]]=h(ie,B[ae[je]]))}be.indexOf(".")>0?Z+=be+" = "+B[ae[je]]+`;
`:Z+="var "+be+" = "+B[ae[je]]+`;
`}}}let se=(I=function(ae,be){let Ae="",je=0,ie=["=","!",">","<"];for(let Pe=0;Pe<ae.length;Pe++)ae[Pe]==='"'&&(je=je===0?1:0),je===1?Ae+=ae[Pe]:(Ae+=ae[Pe].toUpperCase(),Pe>0&&ae[Pe]==="="&&ie.indexOf(ae[Pe-1])===-1&&ie.indexOf(ae[Pe+1])===-1&&(Ae+="="));return Ae=Ae.replace(/\^/g,"**"),Ae=Ae.replace(/<>/g,"!="),Ae=Ae.replace(/&/g,"+"),Ae=Ae.replace(/\$/g,""),Ae}(I=(I=I.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);se&&se.length&&(I=h(se,I));let ge=new Function(Z+"; return "+I)();return ge===null&&(ge=0),ge};return T.getColumnNameFromCoords=function(I,B){return A="",(O=parseInt(I))>701?(A+=String.fromCharCode(64+parseInt(O/676)),A+=String.fromCharCode(64+parseInt(O%676/26))):O>25&&(A+=String.fromCharCode(64+parseInt(O/26))),A+String.fromCharCode(65+O%26)+(parseInt(B)+1);var O,A},T.getCoordsFromColumnName=function(I){var B=/^[a-zA-Z]+/.exec(I);if(B){for(var O=0,A=0;A<B[0].length;A++)O+=parseInt(B[0].charCodeAt(A)-64)*Math.pow(26,B[0].length-1-A);--O<0&&(O=0);var R=parseInt(/[0-9]+$/.exec(I))||null;return R>0&&R--,[O,R]}},T.getRangeFromTokens=function(I){I=I.filter(function(R){return R!="#REF!"});for(var B="",O="",A=0;A<I.length;A++)I[A].indexOf(".")>=0?B=".":I[A].indexOf("!")>=0&&(B="!"),B&&(O=I[A].split(B),I[A]=O[1],O=O[0]+B);return I.sort(function(R,Z){var q=Helpers.getCoordsFromColumnName(R),se=Helpers.getCoordsFromColumnName(Z);return q[1]>se[1]?1:q[1]<se[1]?-1:q[0]>se[0]?1:q[0]<se[0]?-1:0}),I.length?O+(I[0]+":")+I[I.length-1]:"#REF!"},T.getTokensFromRange=function(I){if(I.indexOf(".")>0){var B=I.split(".");I=B[1],B=B[0]+"."}else I.indexOf("!")>0?(B=I.split("!"),I=B[1],B=B[0]+"!"):B="";I=I.split(":");var O=T.getCoordsFromColumnName(I[0]),A=T.getCoordsFromColumnName(I[1]);if(O[0]<=A[0])var R=O[0],Z=A[0];else R=A[0],Z=O[0];if(O[1]===null&&A[1]==null)for(var q=null,se=null,ge=Object.keys(vars),ae=0;ae<ge.length;ae++){var be=T.getCoordsFromColumnName(ge[ae]);be[0]===O[0]&&(q===null||be[1]<q)&&(q=be[1]),be[0]===A[0]&&(se===null||be[1]>se)&&(se=be[1])}else O[1]<=A[1]?(q=O[1],se=A[1]):(q=A[1],se=O[1]);for(var Ae=[],je=q;je<=se;je++){var ie=[];for(ae=R;ae<=Z;ae++)ie.push(B+T.getColumnNameFromCoords(ae,je));Ae.push(ie)}return Ae},T.setFormula=function(I){let B=Object.keys(I);for(let O=0;O<B.length;O++)typeof I[B[O]]=="function"&&(F[B[O]]=I[B[O]])},T.basic=!0,T}(typeof window>"u"?u.g:window)},592:function(W,m,u){var d=u(162),F=u(765);const _=new Error("#NULL!"),g=new Error("#DIV/0!"),s=new Error("#VALUE!"),b=new Error("#REF!"),j=new Error("#NAME?"),h=new Error("#NUM!"),C=new Error("#N/A"),T=new Error("#ERROR!"),I=new Error("#GETTING_DATA");var B=Object.freeze({__proto__:null,data:I,div0:g,error:T,na:C,name:j,nil:_,num:h,ref:b,value:s});function O(e){const t=[];return A(e,r=>{t.push(r)}),t}function A(e,t){let r=-1;const p=e.length;for(;++r<p&&t(e[r],r,e)!==!1;);return e}function R(e){let t,r=e.length;for(;r--;)if(t=e[r],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const p=Y(t);e[r]=p instanceof Error?0:p}}else e[r]=0;else e[r]=1;return e}function Z(e,t){if(!e)return s;e.every(N=>Array.isArray(N))&&e.length!==0||(e=[[...e]]),e.map((N,H)=>{N.map((z,re)=>{z||(e[H][re]=0)})});const r=e.reduce((N,H,z)=>H.length>e[N].length?z:N,0),p=e[r].length;return e.map(N=>[...N,...Array(p-N.length).fill(t||0)])}function q(){let e;if(arguments.length===1){const r=arguments[0];e=(t=r)!=null&&typeof t.length=="number"&&typeof t!="string"?O.apply(null,arguments):[r]}else e=Array.from(arguments);for(var t;!ge(e);)e=se(e);return e}function se(e){return e&&e.reduce?e.reduce((t,r)=>{const p=Array.isArray(t),N=Array.isArray(r);return p&&N?t.concat(r):p?(t.push(r),t):N?[t].concat(r):[t,r]}):[e]}function ge(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function ae(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function be(e){return e?e[0].map((t,r)=>e.map(p=>p[r])):s}function Ae(e,t){let r=null;return A(e,(p,N)=>{if(p[0]===t)return r=N,!1}),r??s}function je(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function ie(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function Pe(e){return Math.round(e*1e14)/1e14}function Ye(){return q.apply(null,arguments).filter(e=>typeof e=="number")}function Ve(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||s}function He(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?h:function(r){r<60&&(r+=1);const p=Math.floor(r-25569),N=new Date(86400*p*1e3),H=r-Math.floor(r)+1e-7;let z=Math.floor(86400*H);const re=z%60;z-=re;const de=Math.floor(z/3600),Ce=Math.floor(z/60)%60;let Oe=N.getUTCDate(),_e=N.getUTCMonth();return r>=60&&r<61&&(Oe=29,_e=1),new Date(N.getUTCFullYear(),_e,Oe,de,Ce,re)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?s:e}function ut(e){let t,r=e.length;for(;r--;){if(t=He(e[r]),t===s)return t;e[r]=t}return e}function Y(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?s:parseFloat(e))}function Ne(e){let t,r;if(!e||(t=e.length)===0)return s;for(;t--;){if(e[t]instanceof Error)return e[t];if(r=Y(e[t]),r instanceof Error)return r;e[t]=r}return e}function qe(e){return e instanceof Error?e:e==null?"":e.toString()}function mt(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function tt(e){return e!=null}const Le="=",Te=[">",">=","<","<=","=","<>"],Be="operator",Ue="literal",Ze=[Be,Ue],nt=Be,rt=Ue;function dt(e,t){if(Ze.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function gt(e){return function(t){let r="";const p=[];for(let N=0;N<t.length;N++){const H=t[N];N===0&&Te.indexOf(H)>=0?p.push(dt(H,nt)):r+=H}return r.length>0&&p.push(dt(function(N){return typeof N!="string"||/^\d+(\.\d+)?$/.test(N)&&(N=N.indexOf(".")===-1?parseInt(N,10):parseFloat(N)),N}(r),rt)),p.length>0&&p[0].type!==nt&&p.unshift(dt(Le,nt)),p}(function(t){const r=t.length,p=[];let N=0,H="",z="";for(;N<r;){const re=t.charAt(N);switch(re){case">":case"<":case"=":z+=re,H.length>0&&(p.push(H),H="");break;default:z.length>0&&(p.push(z),z=""),H+=re}N++}return H.length>0&&p.push(H),z.length>0&&p.push(z),p}(e))}const bt=function(e){const t=[];let r;for(let p=0;p<e.length;p++){const N=e[p];switch(N.type){case nt:r=N.value;break;case rt:t.push(N.value)}}return function(p,N){let H=!1;switch(N){case">":H=p[0]>p[1];break;case">=":H=p[0]>=p[1];break;case"<":H=p[0]<p[1];break;case"<=":H=p[0]<=p[1];break;case"=":H=p[0]==p[1];break;case"<>":H=p[0]!=p[1]}return H}(t,r)},Ft={};function Tt(e){return[s,b,g,h,j,_].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function Nt(e){return Tt(e)||e===C}function Ot(e){return e===!0||e===!1}function pt(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function qt(e){return typeof e=="string"}function It(){const e=[];for(let t=0;t<arguments.length;++t){let r=!1;const p=arguments[t];for(let N=0;N<e.length&&(r=e[N]===p,!r);++N);r||e.push(p)}return e}function w(e,t,r,p){if(!t||!r)return C;p=!(p===0||p===!1);let N=C;const H=typeof e=="number";let z=!1;for(let re=0;re<t.length;re++){const de=t[re];if(de[0]===e){N=r<de.length+1?de[r-1]:b;break}!z&&(H&&p&&de[0]<=e||p&&typeof de[0]=="string"&&de[0].localeCompare(e)<0)&&(N=r<de.length+1?de[r-1]:b),H&&de[0]>e&&(z=!0)}return N}function E(){const e=q(arguments).filter(tt);if(e.length===0)return g;const t=je.apply(void 0,e);if(t)return t;const r=Ye(e),p=r.length;let N,H=0,z=0;for(let re=0;re<p;re++)H+=r[re],z+=1;return N=H/z,isNaN(N)&&(N=h),N}function a(){const e=q(arguments).filter(tt);if(e.length===0)return g;const t=je.apply(void 0,e);if(t)return t;const r=e,p=r.length;let N,H=0,z=0;for(let re=0;re<p;re++){const de=r[re];typeof de=="number"&&(H+=de),de===!0&&H++,de!==null&&z++}return N=H/z,isNaN(N)&&(N=h),N}Ft.TYPE=e=>{switch(e){case _:return 1;case g:return 2;case s:return 3;case b:return 4;case j:return 5;case h:return 6;case C:return 7;case I:return 8}return C};const o={DIST:function(e,t,r,p,N,H){return arguments.length<4?s:(N=N===void 0?0:N,H=H===void 0?1:H,ie(e=Y(e),t=Y(t),r=Y(r),N=Y(N),H=Y(H))?s:(e=(e-N)/(H-N),p?d.beta.cdf(e,t,r):d.beta.pdf(e,t,r)))},INV:(e,t,r,p,N)=>(p=p===void 0?0:p,N=N===void 0?1:N,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p),N=Y(N))?s:d.beta.inv(e,t,r)*(N-p)+p)},P={DIST:(e,t,r,p)=>ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p))?s:p?d.binomial.cdf(e,t,r):d.binomial.pdf(e,t,r)};P.DIST.RANGE=(e,t,r,p)=>{if(p=p===void 0?r:p,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p)))return s;let N=0;for(let H=r;H<=p;H++)N+=Ke(e,H)*Math.pow(t,H)*Math.pow(1-t,e-H);return N},P.INV=(e,t,r)=>{if(ie(e=Y(e),t=Y(t),r=Y(r)))return s;let p=0;for(;p<=e;){if(d.binomial.cdf(p,e,t)>=r)return p;p++}};const ee={DIST:(e,t,r)=>ie(e=Y(e),t=Y(t))?s:r?d.chisquare.cdf(e,t):d.chisquare.pdf(e,t)};ee.DIST.RT=(e,t)=>!e|!t?C:e<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?s:1-d.chisquare.cdf(e,t),ee.INV=(e,t)=>ie(e=Y(e),t=Y(t))?s:d.chisquare.inv(e,t),ee.INV.RT=(e,t)=>!e|!t?C:e<0||e>1||t<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?s:d.chisquare.inv(1-e,t),ee.TEST=function(e,t){if(arguments.length!==2)return C;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return s;const r=e.length;let p,N,H;for(N=0;N<r;N++)e[N]instanceof Array||(p=e[N],e[N]=[],e[N].push(p)),t[N]instanceof Array||(p=t[N],t[N]=[],t[N].push(p));const z=e[0].length,re=z===1?r-1:(r-1)*(z-1);let de=0;const Ce=Math.PI;for(N=0;N<r;N++)for(H=0;H<z;H++)de+=Math.pow(e[N][H]-t[N][H],2)/t[N][H];return Math.round(1e6*function(Oe,_e){let Re=Math.exp(-.5*Oe);_e%2==1&&(Re*=Math.sqrt(2*Oe/Ce));let We=_e;for(;We>=2;)Re=Re*Oe/We,We-=2;let et=Re,ot=_e;for(;et>1e-10*Re;)ot+=2,et=et*Oe/ot,Re+=et;return 1-Re}(de,re))/1e6};const te={};function S(){return Ye(q(arguments)).length}function M(){const e=q(arguments);return e.length-V(e)}function V(){const e=q(arguments);let t,r=0;for(let p=0;p<e.length;p++)t=e[p],t!=null&&t!==""||r++;return r}te.NORM=(e,t,r)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:d.normalci(1,e,t,r)[1]-1,te.T=(e,t,r)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:d.tci(1,e,t,r)[1]-1;const G={P:(e,t)=>{if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const r=d.mean(e),p=d.mean(t);let N=0;const H=e.length;for(let z=0;z<H;z++)N+=(e[z]-r)*(t[z]-p);return N/H},S:(e,t)=>ie(e=Ne(q(e)),t=Ne(q(t)))?s:d.covariance(e,t)},oe={DIST:(e,t,r)=>ie(e=Y(e),t=Y(t))?s:r?d.exponential.cdf(e,t):d.exponential.pdf(e,t)},pe={};function ce(e,t,r){if(ie(e=Y(e),t=Ne(q(t)),r=Ne(q(r))))return s;const p=d.mean(r),N=d.mean(t),H=r.length;let z=0,re=0;for(let Ce=0;Ce<H;Ce++)z+=(r[Ce]-p)*(t[Ce]-N),re+=Math.pow(r[Ce]-p,2);const de=z/re;return N-de*p+de*e}function fe(e){return(e=Y(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?h:d.gammafn(e)}function Ee(e){return(e=Y(e))instanceof Error?e:d.gammaln(e)}pe.DIST=(e,t,r,p)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:p?d.centralF.cdf(e,t,r):d.centralF.pdf(e,t,r),pe.DIST.RT=function(e,t,r){return arguments.length!==3?C:e<0||t<1||r<1?h:typeof e!="number"||typeof t!="number"||typeof r!="number"?s:1-d.centralF.cdf(e,t,r)},pe.INV=(e,t,r)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:e<=0||e>1?h:d.centralF.inv(e,t,r),pe.INV.RT=function(e,t,r){return arguments.length!==3?C:e<0||e>1||t<1||t>Math.pow(10,10)||r<1||r>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"||typeof r!="number"?s:d.centralF.inv(1-e,t,r)},pe.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return C;if(e.length<2||t.length<2)return g;const r=(H,z)=>{let re=0;for(let de=0;de<H.length;de++)re+=Math.pow(H[de]-z,2);return re},p=Et(e)/e.length,N=Et(t)/t.length;return r(e,p)/(e.length-1)/(r(t,N)/(t.length-1))},fe.DIST=function(e,t,r,p){return arguments.length!==4?C:e<0||t<=0||r<=0||typeof e!="number"||typeof t!="number"||typeof r!="number"?s:p?d.gamma.cdf(e,t,r,!0):d.gamma.pdf(e,t,r,!1)},fe.INV=function(e,t,r){return arguments.length!==3?C:e<0||e>1||t<=0||r<=0?h:typeof e!="number"||typeof t!="number"||typeof r!="number"?s:d.gamma.inv(e,t,r)},Ee.PRECISE=function(e){return arguments.length!==1?C:e<=0?h:typeof e!="number"?s:d.gammaln(e)};const Ie={};function Se(e,t){return ie(e=Ne(q(e)),t=Y(t))?e:t<0||e.length<t?s:e.sort((r,p)=>p-r)[t-1]}function ze(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const r=d.mean(e),p=d.mean(t),N=t.length;let H=0,z=0;for(let de=0;de<N;de++)H+=(t[de]-p)*(e[de]-r),z+=Math.pow(t[de]-p,2);const re=H/z;return[re,r-re*p]}Ie.DIST=(e,t,r,p,N)=>{if(ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p)))return s;function H(z,re,de,Ce){return Ke(de,z)*Ke(Ce-de,re-z)/Ke(Ce,re)}return N?function(z,re,de,Ce){let Oe=0;for(let _e=0;_e<=z;_e++)Oe+=H(_e,re,de,Ce);return Oe}(e,t,r,p):H(e,t,r,p)};const Ge={};function Q(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;const r=Ye(e);return r.length===0?0:Math.max.apply(Math,r)}function he(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;const r=R(e);let p=d.median(r);return isNaN(p)&&(p=h),p}function we(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;const r=Ye(e);return r.length===0?0:Math.min.apply(Math,r)}Ge.DIST=(e,t,r,p)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:p?d.lognormal.cdf(e,t,r):d.lognormal.pdf(e,t,r),Ge.INV=(e,t,r)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:d.lognormal.inv(e,t,r);const U={MULT:function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=e.length,r={};let p,N=[],H=0;for(let z=0;z<t;z++)p=e[z],r[p]=r[p]?r[p]+1:1,r[p]>H&&(H=r[p],N=[]),r[p]===H&&(N[N.length]=p);return N},SNGL:function(){const e=Ne(q(arguments));return e instanceof Error?e:U.MULT(e).sort((t,r)=>t-r)[0]}},J={DIST:(e,t,r,p)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:p?d.negbin.cdf(e,t,r):d.negbin.pdf(e,t,r)},v={};function D(e,t){if(ie(t=Ne(q(t)),e=Ne(q(e))))return s;const r=d.mean(e),p=d.mean(t),N=e.length;let H=0,z=0,re=0;for(let de=0;de<N;de++)H+=(e[de]-r)*(t[de]-p),z+=Math.pow(e[de]-r,2),re+=Math.pow(t[de]-p,2);return H/Math.sqrt(z*re)}v.DIST=(e,t,r,p)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:r<=0?h:p?d.normal.cdf(e,t,r):d.normal.pdf(e,t,r),v.INV=(e,t,r)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:d.normal.inv(e,t,r),v.S={},v.S.DIST=(e,t)=>(e=Y(e))instanceof Error?s:t?d.normal.cdf(e,0,1):d.normal.pdf(e,0,1),v.S.INV=e=>(e=Y(e))instanceof Error?s:d.normal.inv(e,0,1);const X={EXC:(e,t)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;const r=(e=e.sort((H,z)=>H-z)).length;if(t<1/(r+1)||t>1-1/(r+1))return h;const p=t*(r+1)-1,N=Math.floor(p);return Pe(p===N?e[p]:e[N]+(p-N)*(e[N+1]-e[N]))},INC:(e,t)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;const r=t*((e=e.sort((N,H)=>N-H)).length-1),p=Math.floor(r);return Pe(r===p?e[r]:e[p]+(r-p)*(e[p+1]-e[p]))}},ue={EXC:(e,t,r)=>{if(r=r===void 0?3:r,ie(e=Ne(q(e)),t=Y(t),r=Y(r)))return s;e=e.sort((Oe,_e)=>Oe-_e);const p=It.apply(null,e),N=e.length,H=p.length,z=Math.pow(10,r);let re=0,de=!1,Ce=0;for(;!de&&Ce<H;)t===p[Ce]?(re=(e.indexOf(p[Ce])+1)/(N+1),de=!0):t>=p[Ce]&&(t<p[Ce+1]||Ce===H-1)&&(re=(e.indexOf(p[Ce])+1+(t-p[Ce])/(p[Ce+1]-p[Ce]))/(N+1),de=!0),Ce++;return Math.floor(re*z)/z},INC:(e,t,r)=>{if(r=r===void 0?3:r,ie(e=Ne(q(e)),t=Y(t),r=Y(r)))return s;e=e.sort((Oe,_e)=>Oe-_e);const p=It.apply(null,e),N=e.length,H=p.length,z=Math.pow(10,r);let re=0,de=!1,Ce=0;for(;!de&&Ce<H;)t===p[Ce]?(re=e.indexOf(p[Ce])/(N-1),de=!0):t>=p[Ce]&&(t<p[Ce+1]||Ce===H-1)&&(re=(e.indexOf(p[Ce])+(t-p[Ce])/(p[Ce+1]-p[Ce]))/(N-1),de=!0),Ce++;return Math.floor(re*z)/z}},K={DIST:(e,t,r)=>ie(e=Y(e),t=Y(t))?s:r?d.poisson.cdf(e,t):d.poisson.pdf(e,t)},le={EXC:(e,t)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;switch(t){case 1:return X.EXC(e,.25);case 2:return X.EXC(e,.5);case 3:return X.EXC(e,.75);default:return h}},INC:(e,t)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;switch(t){case 1:return X.INC(e,.25);case 2:return X.INC(e,.5);case 3:return X.INC(e,.75);default:return h}}},me={};function Me(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=d.mean(e),r=e.length;let p=0;for(let N=0;N<r;N++)p+=Math.pow(e[N]-t,3);return r*p/((r-1)*(r-2)*Math.pow(d.stdev(e,!0),3))}function xe(e,t){return ie(e=Ne(q(e)),t=Y(t))?e:e.sort((r,p)=>r-p)[t-1]}me.AVG=(e,t,r)=>{if(ie(e=Y(e),t=Ne(q(t))))return s;const p=(r=r||!1)?(z,re)=>z-re:(z,re)=>re-z,N=(t=(t=q(t)).sort(p)).length;let H=0;for(let z=0;z<N;z++)t[z]===e&&H++;return H>1?(2*t.indexOf(e)+H+1)/2:t.indexOf(e)+1},me.EQ=(e,t,r)=>{if(ie(e=Y(e),t=Ne(q(t))))return s;const p=(r=r||!1)?(N,H)=>N-H:(N,H)=>H-N;return(t=t.sort(p)).indexOf(e)+1},Me.P=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=d.mean(e),r=e.length;let p=0,N=0;for(let H=0;H<r;H++)N+=Math.pow(e[H]-t,3),p+=Math.pow(e[H]-t,2);return N/=r,p/=r,N/Math.pow(p,1.5)};const De={P:function(){const e=$e.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},S:function(){const e=$e.S.apply(this,arguments);return Math.sqrt(e)}},Fe={DIST:(e,t,r)=>r!==1&&r!==2?h:r===1?Fe.DIST.RT(e,t):Fe.DIST["2T"](e,t)};Fe.DIST["2T"]=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?s:2*(1-d.studentt.cdf(e,t))},Fe.DIST.RT=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?s:1-d.studentt.cdf(e,t)},Fe.INV=(e,t)=>ie(e=Y(e),t=Y(t))?s:d.studentt.inv(e,t),Fe.INV["2T"]=(e,t)=>(e=Y(e),t=Y(t),e<=0||e>1||t<1?h:ie(e,t)?s:Math.abs(d.studentt.inv(e/2,t))),Fe.TEST=(e,t)=>{if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const r=d.mean(e),p=d.mean(t);let N,H=0,z=0;for(N=0;N<e.length;N++)H+=Math.pow(e[N]-r,2);for(N=0;N<t.length;N++)z+=Math.pow(t[N]-p,2);H/=e.length-1,z/=t.length-1;const re=Math.abs(r-p)/Math.sqrt(H/e.length+z/t.length);return Fe.DIST["2T"](re,e.length+t.length-2)};const $e={};function ne(){const e=q(arguments),t=e.length;let r=0,p=0;const N=a(e);for(let H=0;H<t;H++){const z=e[H];r+=Math.pow(typeof z=="number"?z-N:z===!0?1-N:0-N,2),z!==null&&p++}return r/(p-1)}function ve(){const e=q(arguments),t=e.length;let r=0,p=0;const N=a(e);let H;for(let z=0;z<t;z++){const re=e[z];r+=Math.pow(typeof re=="number"?re-N:re===!0?1-N:0-N,2),re!==null&&p++}return H=r/p,isNaN(H)&&(H=h),H}$e.P=function(){const e=Ye(q(arguments)),t=e.length;let r=0;const p=E(e);let N;for(let H=0;H<t;H++)r+=Math.pow(e[H]-p,2);return N=r/t,isNaN(N)&&(N=h),N},$e.S=function(){const e=Ye(q(arguments)),t=e.length;let r=0;const p=E(e);for(let N=0;N<t;N++)r+=Math.pow(e[N]-p,2);return r/(t-1)};const ye={DIST:(e,t,r,p)=>ie(e=Y(e),t=Y(t),r=Y(r))?s:p?1-Math.exp(-Math.pow(e/r,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/r,t))*t/Math.pow(r,t)},ke={};function Xe(e,t,r){const p=je(e=Y(e),t=Y(t),r=Y(r));if(p)return p;if(t===0)return 0;t=Math.abs(t);const N=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.ceil(e/t)*t,N):r===0?-xt(Math.floor(Math.abs(e)/t)*t,N):-xt(Math.ceil(Math.abs(e)/t)*t,N)}function Ke(e,t){return je(e=Y(e),t=Y(t))||(e<t?h:ft(e)/(ft(t)*ft(e-t)))}ke.TEST=(e,t,r)=>{if(ie(e=Ne(q(e)),t=Y(t)))return s;r=r||De.S(e);const p=e.length;return 1-v.S.DIST((E(e)-t)/(r/Math.sqrt(p)),!0)},Xe.MATH=Xe,Xe.PRECISE=Xe;const lt=[];function ft(e){if((e=Y(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(lt[t]>0||(lt[t]=ft(t-1)*t),lt[t])}function Qe(e,t){const r=je(e=Y(e),t=Y(t));if(r)return r;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return h;t=Math.abs(t);const p=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,p):-xt(Math.ceil(Math.abs(e)/t),p)}Qe.MATH=(e,t,r)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const p=je(e=Y(e),t=Y(t),r=Y(r));if(p)return p;if(t===0)return 0;t=t?Math.abs(t):1;const N=-Math.floor(Math.log(t)/Math.log(10));return e>=0?xt(Math.floor(e/t)*t,N):r===0||r===void 0?-xt(Math.ceil(Math.abs(e)/t)*t,N):-xt(Math.floor(Math.abs(e)/t)*t,N)},Qe.PRECISE=Qe.MATH;const at={CEILING:Xe};function Je(e,t){const r=je(e=Y(e),t=Y(t));if(r)return r;if(e===0&&t===0)return h;const p=Math.pow(e,t);return isNaN(p)?h:p}function Yt(){const e=q(arguments).filter(p=>p!=null);if(e.length===0)return 0;const t=Ne(e);if(t instanceof Error)return t;let r=1;for(let p=0;p<t.length;p++)r*=t[p];return r}function xt(e,t){return je(e=Y(e),t=Y(t))||Number(Math.round(Number(e+"e"+t))+"e"+-1*t)}function Et(){let e=0;return A(O(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const r=parseFloat(t);!isNaN(r)&&(e+=r)}else if(Array.isArray(t)){const r=Et.apply(null,t);r instanceof Error?e=r:e+=r}}),e}var dn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?C:je(e=Y(e),t=Y(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?C:je(e=Y(e),t=Y(t))||(t===0?g:e/t)},EQ:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(mt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),je(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?C:(mt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),je(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?C:(mt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),je(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?C:(mt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),je(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?C:je(e=Y(e),t=Y(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?C:je(e=Y(e),t=Y(t))||e*t},NE:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?C:Je(e,t)}});const fn=new Date(Date.UTC(1900,0,1)),pn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],hn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],kt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Dt(e,t,r){r=r.toUpperCase(),e=He(e),t=He(t);const p=e.getFullYear(),N=e.getMonth(),H=e.getDate(),z=t.getFullYear(),re=t.getMonth(),de=t.getDate();let Ce;switch(r){case"Y":Ce=Math.floor(zt(e,t));break;case"D":Ce=At(t,e);break;case"M":Ce=re-N+12*(z-p),de<H&&Ce--;break;case"MD":H<=de?Ce=de-H:(re===0?(e.setFullYear(z-1),e.setMonth(12)):(e.setFullYear(z),e.setMonth(re-1)),Ce=At(t,e));break;case"YM":Ce=re-N+12*(z-p),de<H&&Ce--,Ce%=12;break;case"YD":re>N||re===N&&de<H?e.setFullYear(z):e.setFullYear(z-1),Ce=At(t,e)}return Ce}function Rt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function At(e,t){return e=He(e),t=He(t),e instanceof Error?e:t instanceof Error?t:nn(Rt(e))-nn(Rt(t))}function wt(e,t,r){if(r=Ve(r||"false"),e=He(e),t=He(t),e instanceof Error)return e;if(t instanceof Error)return t;if(r instanceof Error)return r;const p=e.getMonth();let N,H,z=t.getMonth();if(r)N=e.getDate()===31?30:e.getDate(),H=t.getDate()===31?30:t.getDate();else{const re=new Date(e.getFullYear(),p+1,0).getDate(),de=new Date(t.getFullYear(),z+1,0).getDate();N=e.getDate()===re?30:e.getDate(),t.getDate()===de?N<30?(z++,H=1):H=30:H=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(z-p)+(H-N)}function tn(e){if((e=He(e))instanceof Error)return e;(e=Rt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Ht(e,t,r){return Ht.INTL(e,t,1,r)}function Bt(e,t,r){return Bt.INTL(e,t,1,r)}function Ut(e){return new Date(e,1,29).getMonth()===1}function _t(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function zt(e,t,r){if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;r=r||0;let p=e.getDate();const N=e.getMonth()+1,H=e.getFullYear();let z=t.getDate();const re=t.getMonth()+1,de=t.getFullYear();switch(r){case 0:return p===31&&z===31?(p=30,z=30):p===31?p=30:p===30&&z===31&&(z=30),(z+30*re+360*de-(p+30*N+360*H))/360;case 1:{const Ce=(We,et)=>{const ot=We.getFullYear(),jt=new Date(ot,2,1);if(Ut(ot)&&We<jt&&et>=jt)return!0;const ct=et.getFullYear(),Ct=new Date(ct,2,1);return Ut(ct)&&et>=Ct&&We<Ct};let Oe=365;if(H===de||H+1===de&&(N>re||N===re&&p>=z))return(H===de&&Ut(H)||Ce(e,t)||re===1&&z===29)&&(Oe=366),_t(e,t)/Oe;const _e=de-H+1,Re=(new Date(de+1,0,1)-new Date(H,0,1))/1e3/60/60/24/_e;return _t(e,t)/Re}case 2:return _t(e,t)/360;case 3:return _t(e,t)/365;case 4:return(z+30*re+360*de-(p+30*N+360*H))/360}}function nn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-fn)/864e5)+t}function on(e){return(e=Y(e))===0?s:e instanceof Error?e:String.fromCharCode(e)}function rn(e){if(ie(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=s),t}function sn(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;let r=0;for(;(r=e.indexOf(!0))>-1;)e[r]="TRUE";let p=0;for(;(p=e.indexOf(!1))>-1;)e[p]="FALSE";return e.join("")}Ht.INTL=(e,t,r,p)=>{if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;let N=!1;const H=[],z=[1,2,3,4,5,6,0],re=new RegExp("^[0|1]{7}$");if(r===void 0)r=kt[1];else if(typeof r=="string"&&re.test(r)){N=!0,r=r.split("");for(let _e=0;_e<r.length;_e++)r[_e]==="1"&&H.push(z[_e])}else r=kt[r];if(!(r instanceof Array))return s;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let _e=0;_e<p.length;_e++){const Re=He(p[_e]);if(Re instanceof Error)return Re;p[_e]=Re}const de=Math.round((t-e)/864e5)+1;let Ce=de;const Oe=e;for(let _e=0;_e<de;_e++){const Re=new Date().getTimezoneOffset()>0?Oe.getUTCDay():Oe.getDay();let We=N?H.includes(Re):Re===r[0]||Re===r[1];for(let et=0;et<p.length;et++){const ot=p[et];if(ot.getDate()===Oe.getDate()&&ot.getMonth()===Oe.getMonth()&&ot.getFullYear()===Oe.getFullYear()){We=!0;break}}We&&Ce--,Oe.setDate(Oe.getDate()+1)}return Ce},Bt.INTL=(e,t,r,p)=>{if((e=He(e))instanceof Error)return e;if((t=Y(t))instanceof Error)return t;if(t<0)return h;if(!((r=r===void 0?kt[1]:kt[r])instanceof Array))return s;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let H=0;H<p.length;H++){const z=He(p[H]);if(z instanceof Error)return z;p[H]=z}let N=0;for(;N<t;){e.setDate(e.getDate()+1);const H=e.getDay();if(H!==r[0]&&H!==r[1]){for(let z=0;z<p.length;z++){const re=p[z];if(re.getDate()===e.getDate()&&re.getMonth()===e.getMonth()&&re.getFullYear()===e.getFullYear()){N--;break}}N++}}return e};const gn=sn;function an(e,t=2,r=!1){if(e=Y(e),isNaN(e)||(t=Y(t),isNaN(t)))return s;if(t<0){const p=Math.pow(10,-t);e=Math.round(e/p)*p}else e=e.toFixed(t);if(r)e=e.toString().replace(/,/g,"");else{const p=e.toString().split(".");p[0]=p[0].replace(/\B(?=(\d{3})+$)/g,","),e=p.join(".")}return e}function vt(e,t){return je(e,t)||(e=qe(e),(t=Y(t))instanceof Error?t:new Array(t+1).join(e))}const mn=on,bn=rn;function Wt(e){return/^[01]{1,10}$/.test(e)}function ht(e,t,r){if(ie(e=Y(e),t=Y(t)))return e;if((r=r===void 0?"i":r)!=="i"&&r!=="j")return s;if(e===0&&t===0)return 0;if(e===0)return t===1?r:t.toString()+r;if(t===0)return e.toString();{const p=t>0?"+":"";return e.toString()+p+(t===1?r:t.toString()+r)}}function Xt(e,t){return t=t===void 0?0:t,ie(e=Y(e),t=Y(t))?s:d.erf(e)}function Gt(e){return isNaN(e)?s:d.erfc(e)}function $t(e){const t=st(e),r=it(e);return ie(t,r)?s:Math.sqrt(Math.pow(t,2)+Math.pow(r,2))}function it(e){if(e===void 0||e===!0||e===!1)return s;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),r=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),r===0&&(r=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),N=p==="i"||p==="j";return t>=0||r>=0?N?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?h:-Number(e.substring(r+1,e.length-1)):h:N?isNaN(e.substring(0,e.length-1))?h:e.substring(0,e.length-1):isNaN(e)?h:0}function Kt(e){const t=st(e),r=it(e);return ie(t,r)?s:t===0&&r===0?g:t===0&&r>0?Math.PI/2:t===0&&r<0?-Math.PI/2:r===0&&t>0?0:r===0&&t<0?-Math.PI:t>0?Math.atan(r/t):t<0&&r>=0?Math.atan(r/t)+Math.PI:Math.atan(r/t)-Math.PI}function Pt(e){const t=st(e),r=it(e);if(ie(t,r))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.cos(t)*(Math.exp(r)+Math.exp(-r))/2,-Math.sin(t)*(Math.exp(r)-Math.exp(-r))/2,p)}function ln(e){const t=st(e),r=it(e);if(ie(t,r))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,p)}function Lt(e,t){const r=st(e),p=it(e),N=st(t),H=it(t);if(ie(r,p,N,H))return s;const z=e.substring(e.length-1),re=t.substring(t.length-1);let de="i";if((z==="j"||re==="j")&&(de="j"),N===0&&H===0)return h;const Ce=N*N+H*H;return ht((r*N+p*H)/Ce,(p*N-r*H)/Ce,de)}function st(e){if(e===void 0||e===!0||e===!1)return s;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),r=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),r===0&&(r=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),N=p==="i"||p==="j";return t>=0||r>=0?N?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(0,t)):isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?h:Number(e.substring(0,r)):h:N?isNaN(e.substring(0,e.length-1))?h:0:isNaN(e)?h:e}function Vt(e){const t=st(e),r=it(e);if(ie(t,r))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.sin(t)*(Math.exp(r)+Math.exp(-r))/2,Math.cos(t)*(Math.exp(r)-Math.exp(-r))/2,p)}function un(e){const t=st(e),r=it(e);if(ie(t,r))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,p)}Xt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Gt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const jn=o.DIST,vn=o.INV,yn=P.DIST,xn=Xe.MATH,wn=Xe.PRECISE,Cn=ee.DIST,En=ee.DIST.RT,An=ee.INV,Ln=ee.INV.RT,Mn=ee.TEST,Nn=G.P,Tn=G.P,In=G.S,Dn=P.INV,Sn=Gt.PRECISE,Fn=Xt.PRECISE,On=oe.DIST,kn=pe.DIST,Rn=pe.DIST.RT,Hn=pe.INV,Bn=pe.INV.RT,_n=Qe.MATH,Pn=Qe.PRECISE,Vn=pe.TEST,qn=fe.DIST,Yn=fe.INV,Un=Ee.PRECISE,zn=Ie.DIST,Wn=Ge.INV,Xn=Ge.DIST,Gn=Ge.INV,$n=U.MULT,Kn=U.SNGL,Jn=J.DIST,Zn=Ht.INTL,Qn=v.DIST,eo=v.INV,to=v.S.DIST,no=v.S.INV,oo=X.EXC,ro=X.INC,io=ue.EXC,so=ue.INC,ao=K.DIST,lo=le.EXC,uo=le.INC,co=me.AVG,fo=me.EQ,po=Me.P,ho=De.P,go=De.S,mo=Fe.DIST,bo=Fe.DIST.RT,jo=Fe.INV,vo=Fe.TEST,yo=$e.P,xo=$e.S,wo=ye.DIST,Co=Bt.INTL,Eo=ke.TEST;function Jt(e){const t=[];return A(e,r=>{r&&t.push(r)}),t}function yt(e,t){const r={};for(let H=1;H<e[0].length;++H)r[H]=!0;let p=t[0].length;for(let H=1;H<t.length;++H)t[H].length>p&&(p=t[H].length);for(let H=1;H<e.length;++H)for(let z=1;z<e[H].length;++z){let re=!1,de=!1;for(let Ce=0;Ce<t.length;++Ce){const Oe=t[Ce];if(Oe.length<p)continue;const _e=Oe[0];if(e[H][0]===_e){de=!0;for(let Re=1;Re<Oe.length;++Re)if(!re)if(Oe[Re]===void 0||Oe[Re]==="*")re=!0;else{const We=gt(Oe[Re]+""),et=[dt(e[H][z],rt)].concat(We);re=bt(et)}}}de&&(r[z]=r[z]&&re)}const N=[];for(let H=0;H<e[0].length;++H)r[H]&&N.push(H-1);return N}function Zt(e){return e&&e.getTime&&!isNaN(e.getTime())}function Qt(e){return e instanceof Date?e:new Date(e)}function Mt(e,t,r,p,N){if(p=p||0,N=N||0,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p),N=Y(N)))return s;let H;if(e===0)H=p+r*t;else{const z=Math.pow(1+e,t);H=N===1?p*z+r*(1+e)*(z-1)/e:p*z+r*(z-1)/e}return-H}function cn(e,t,r,p,N,H){if(N=N||0,H=H||0,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p),N=Y(N),H=Y(H)))return s;const z=St(e,r,p,N,H);return(t===1?H===1?0:-p:H===1?Mt(e,t-2,z,p,1)-z:Mt(e,t-1,z,p,0))*e}function en(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=e[0];let r=0;for(let p=1;p<e.length;p++)r+=e[p]/Math.pow(1+t,p);return r}function St(e,t,r,p,N){if(p=p||0,N=N||0,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p),N=Y(N)))return s;let H;if(e===0)H=(r+p)/t;else{const z=Math.pow(1+e,t);H=N===1?(p*e/(z-1)+r*e/(1-1/z))/(1+e):p*e/(z-1)+r*e/(1-1/z)}return-H}const Ao={errors:B,symbols:dn};m.ABS=function(e){return(e=Y(e))instanceof Error?e:Math.abs(e)},m.ACCRINT=function(e,t,r,p,N,H,z){return e=Qt(e),t=Qt(t),r=Qt(r),Zt(e)&&Zt(t)&&Zt(r)?p<=0||N<=0||[1,2,4].indexOf(H)===-1||[0,1,2,3,4].indexOf(z)===-1||r<=e?h:(N=N||0)*p*zt(e,r,z=z||0):s},m.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},m.ACOS=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=h),t},m.ACOSH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=h),t},m.ACOT=function(e){return(e=Y(e))instanceof Error?e:Math.atan(1/e)},m.ACOTH=function(e){if((e=Y(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=h),t},m.AGGREGATE=function(e,t,r,p){if(ie(e=Y(e),Y(e)))return s;switch(e){case 1:return E(r);case 2:return S(r);case 3:return M(r);case 4:return Q(r);case 5:return we(r);case 6:return Yt(r);case 7:return De.S(r);case 8:return De.P(r);case 9:return Et(r);case 10:return $e.S(r);case 11:return $e.P(r);case 12:return he(r);case 13:return U.SNGL(r);case 14:return Se(r,p);case 15:return xe(r,p);case 16:return X.INC(r,p);case 17:return le.INC(r,p);case 18:return X.EXC(r,p);case 19:return le.EXC(r,p)}},m.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},m.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},m.AND=function(){const e=q(arguments);let t=s;for(let r=0;r<e.length;r++){if(e[r]instanceof Error)return e[r];e[r]!==void 0&&e[r]!==null&&typeof e[r]!="string"&&(t===s&&(t=!0),e[r]||(t=!1))}return t},m.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return s;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,r=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),t},m.ASC=function(){throw new Error("ASC is not implemented")},m.ASIN=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=h),t},m.ASINH=function(e){return(e=Y(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},m.ATAN=function(e){return(e=Y(e))instanceof Error?e:Math.atan(e)},m.ATAN2=function(e,t){return je(e=Y(e),t=Y(t))||Math.atan2(e,t)},m.ATANH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=h),t},m.AVEDEV=function(){const e=q(arguments).filter(tt);if(e.length===0)return h;const t=Ne(e);return t instanceof Error?t:d.sum(d(t).subtract(d.mean(t)).abs()[0])/t.length},m.AVERAGE=E,m.AVERAGEA=a,m.AVERAGEIF=function(e,t,r){if(arguments.length<=1)return C;if(r=Ne(q(r=r||e).filter(tt)),e=q(e),r instanceof Error)return r;let p=0,N=0;const H=t===void 0||t==="*",z=H?null:gt(t+"");for(let re=0;re<e.length;re++){const de=e[re];if(H)N+=r[re],p++;else{const Ce=[dt(de,rt)].concat(z);bt(Ce)&&(N+=r[re],p++)}}return N/p},m.AVERAGEIFS=function(){const e=O(arguments),t=(e.length-1)/2,r=q(e[0]);let p=0,N=0;for(let z=0;z<r.length;z++){let re=!1;for(let de=0;de<t;de++){const Ce=e[2*de+1][z],Oe=e[2*de+2];let _e=!1;if(Oe===void 0||Oe==="*")_e=!0;else{const Re=gt(Oe+""),We=[dt(Ce,rt)].concat(Re);_e=bt(We)}if(!_e){re=!1;break}re=!0}re&&(N+=r[z],p++)}const H=N/p;return isNaN(H)?0:H},m.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},m.BASE=function(e,t,r){const p=je(e=Y(e),t=Y(t),r=Y(r));if(p)return p;if(t===0)return h;const N=e.toString(t);return new Array(Math.max(r+1-N.length,0)).join("0")+N},m.BESSELI=function(e,t){return ie(e=Y(e),t=Y(t))?s:F.besseli(e,t)},m.BESSELJ=function(e,t){return ie(e=Y(e),t=Y(t))?s:F.besselj(e,t)},m.BESSELK=function(e,t){return ie(e=Y(e),t=Y(t))?s:F.besselk(e,t)},m.BESSELY=function(e,t){return ie(e=Y(e),t=Y(t))?s:F.bessely(e,t)},m.BETA=o,m.BETADIST=jn,m.BETAINV=vn,m.BIN2DEC=function(e){if(!Wt(e))return h;const t=parseInt(e,2),r=e.toString();return r.length===10&&r.substring(0,1)==="1"?parseInt(r.substring(1),2)-512:t},m.BIN2HEX=function(e,t){if(!Wt(e))return h;const r=e.toString();if(r.length===10&&r.substring(0,1)==="1")return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);const p=parseInt(e,2).toString(16);return t===void 0?p:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},m.BIN2OCT=function(e,t){if(!Wt(e))return h;const r=e.toString();if(r.length===10&&r.substring(0,1)==="1")return(1073741312+parseInt(r.substring(1),2)).toString(8);const p=parseInt(e,2).toString(8);return t===void 0?p:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},m.BINOM=P,m.BINOMDIST=yn,m.BITAND=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e&t},m.BITLSHIFT=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e<<t:e>>-t},m.BITOR=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e|t},m.BITRSHIFT=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e>>t:e<<-t},m.BITXOR=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e^t},m.CEILING=Xe,m.CEILINGMATH=xn,m.CEILINGPRECISE=wn,m.CELL=function(){throw new Error("CELL is not implemented")},m.CHAR=on,m.CHIDIST=Cn,m.CHIDISTRT=En,m.CHIINV=An,m.CHIINVRT=Ln,m.CHISQ=ee,m.CHITEST=Mn,m.CHOOSE=function(){if(arguments.length<2)return C;const e=arguments[0];return e<1||e>254||arguments.length<e+1?s:arguments[e]},m.CLEAN=function(e){return ie(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},m.CODE=rn,m.COLUMN=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?d.col(e,t):void 0:s},m.COLUMNS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:d.cols(e):s},m.COMBIN=Ke,m.COMBINA=function(e,t){return je(e=Y(e),t=Y(t))||(e<t?h:e===0&&t===0?1:Ke(e+t-1,e-1))},m.COMPLEX=ht,m.CONCAT=gn,m.CONCATENATE=sn,m.CONFIDENCE=te,m.CONVERT=function(e,t,r){if((e=Y(e))instanceof Error)return e;const p=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],N={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},H={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let z,re=null,de=null,Ce=t,Oe=r,_e=1,Re=1;for(let We=0;We<p.length;We++)z=p[We][2]===null?[]:p[We][2],(p[We][1]===Ce||z.indexOf(Ce)>=0)&&(re=p[We]),(p[We][1]===Oe||z.indexOf(Oe)>=0)&&(de=p[We]);if(re===null){const We=N[t.substring(0,2)];let et=H[t.substring(0,1)];t.substring(0,2)==="da"&&(et=["dekao",10,"da"]),We?(_e=We[2],Ce=t.substring(2)):et&&(_e=et[1],Ce=t.substring(et[2].length));for(let ot=0;ot<p.length;ot++)z=p[ot][2]===null?[]:p[ot][2],(p[ot][1]===Ce||z.indexOf(Ce)>=0)&&(re=p[ot])}if(de===null){const We=N[r.substring(0,2)];let et=H[r.substring(0,1)];r.substring(0,2)==="da"&&(et=["dekao",10,"da"]),We?(Re=We[2],Oe=r.substring(2)):et&&(Re=et[1],Oe=r.substring(et[2].length));for(let ot=0;ot<p.length;ot++)z=p[ot][2]===null?[]:p[ot][2],(p[ot][1]===Oe||z.indexOf(Oe)>=0)&&(de=p[ot])}return re===null||de===null||re[3]!==de[3]?C:e*re[6]*_e/(de[6]*Re)},m.CORREL=function(e,t){return ie(e=Ne(q(e)),t=Ne(q(t)))?s:d.corrcoeff(e,t)},m.COS=function(e){return(e=Y(e))instanceof Error?e:Math.cos(e)},m.COSH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},m.COT=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.tan(e)},m.COTH=function(e){if((e=Y(e))instanceof Error)return e;if(e===0)return g;const t=Math.exp(2*e);return(t+1)/(t-1)},m.COUNT=S,m.COUNTA=M,m.COUNTBLANK=V,m.COUNTIF=function(e,t){if(e=q(e),t===void 0||t==="*")return e.length;let r=0;const p=gt(t+"");for(let N=0;N<e.length;N++){const H=[dt(e[N],rt)].concat(p);bt(H)&&r++}return r},m.COUNTIFS=function(){const e=O(arguments),t=new Array(q(e[0]).length);for(let p=0;p<t.length;p++)t[p]=!0;for(let p=0;p<e.length;p+=2){const N=q(e[p]),H=e[p+1];if(H!==void 0&&H!=="*"){const z=gt(H+"");for(let re=0;re<N.length;re++){const de=[dt(N[re],rt)].concat(z);t[re]=t[re]&&bt(de)}}}let r=0;for(let p=0;p<t.length;p++)t[p]&&r++;return r},m.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},m.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},m.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},m.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},m.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},m.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},m.COVAR=Nn,m.COVARIANCE=G,m.COVARIANCEP=Tn,m.COVARIANCES=In,m.CRITBINOM=Dn,m.CSC=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.sin(e)},m.CSCH=function(e){return(e=Y(e))instanceof Error?e:e===0?g:2/(Math.exp(e)-Math.exp(-e))},m.CUMIPMT=function(e,t,r,p,N,H){if(ie(e=Y(e),t=Y(t),r=Y(r)))return s;if(e<=0||t<=0||r<=0||p<1||N<1||p>N||H!==0&&H!==1)return h;const z=St(e,t,r,0,H);let re=0;p===1&&(H===0&&(re=-r),p++);for(let de=p;de<=N;de++)re+=H===1?Mt(e,de-2,z,r,1)-z:Mt(e,de-1,z,r,0);return re*=e,re},m.CUMPRINC=function(e,t,r,p,N,H){if(ie(e=Y(e),t=Y(t),r=Y(r)))return s;if(e<=0||t<=0||r<=0||p<1||N<1||p>N||H!==0&&H!==1)return h;const z=St(e,t,r,0,H);let re=0;p===1&&(re=H===0?z+r*e:z,p++);for(let de=p;de<=N;de++)re+=H>0?z-(Mt(e,de-2,z,r,1)-z)*e:z-Mt(e,de-1,z,r,0)*e;return re},m.DATE=function(e,t,r){let p;return ie(e=Y(e),t=Y(t),r=Y(r))?p=s:(p=new Date(e,t-1,r),p.getFullYear()<0&&(p=h)),p},m.DATEDIF=Dt,m.DATEVALUE=function(e){if(typeof e!="string")return s;const t=Date.parse(e);return isNaN(t)?s:new Date(e)},m.DAVERAGE=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);let H=0;return A(p,z=>{H+=N[z]}),p.length===0?g:H/p.length},m.DAY=function(e){const t=He(e);return t instanceof Error?t:t.getDate()},m.DAYS=At,m.DAYS360=wt,m.DB=function(e,t,r,p,N){if(N=N===void 0?12:N,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p),N=Y(N)))return s;if(e<0||t<0||r<0||p<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(N)===-1||p>r)return h;if(t>=e)return 0;const H=(1-Math.pow(t/e,1/r)).toFixed(3),z=e*H*N/12;let re=z,de=0;const Ce=p===r?r-1:p;for(let Oe=2;Oe<=Ce;Oe++)de=(e-re)*H,re+=de;return p===1?z:p===r?(e-re)*H:de},m.DBCS=function(){throw new Error("DBCS is not implemented")},m.DCOUNT=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);const H=[];return A(p,z=>{H.push(N[z])}),S(H)},m.DCOUNTA=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);const H=[];return A(p,z=>{H.push(N[z])}),M(H)},m.DDB=function(e,t,r,p,N){if(N=N===void 0?2:N,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p),N=Y(N)))return s;if(e<0||t<0||r<0||p<0||N<=0||p>r)return h;if(t>=e)return 0;let H=0,z=0;for(let re=1;re<=p;re++)z=Math.min(N/r*(e-H),e-t-H),H+=z;return z},m.DEC2BIN=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return h;if(e<0)return"1"+vt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const r=parseInt(e,10).toString(2);return t===void 0?r:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=r.length?vt("0",t-r.length)+r:h},m.DEC2HEX=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return h;if(e<0)return(1099511627776+e).toString(16);const r=parseInt(e,10).toString(16);return t===void 0?r:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=r.length?vt("0",t-r.length)+r:h},m.DEC2OCT=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return h;if(e<0)return(1073741824+e).toString(8);const r=parseInt(e,10).toString(8);return t===void 0?r:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=r.length?vt("0",t-r.length)+r:h},m.DECIMAL=function(e,t){return arguments.length<1?s:je(e=Y(e),t=Y(t))||(t===0?h:parseInt(e,t))},m.DEGREES=function(e){return(e=Y(e))instanceof Error?e:180*e/Math.PI},m.DELTA=function(e,t){return t=t===void 0?0:t,ie(e=Y(e),t=Y(t))?s:e===t?1:0},m.DEVSQ=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=d.mean(e);let r=0;for(let p=0;p<e.length;p++)r+=Math.pow(e[p]-t,2);return r},m.DGET=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];return N=ae(typeof t=="string"?e[Ae(e,t)]:e[t]),p.length===0?s:p.length>1?h:N[p[0]]},m.DISC=function(e,t,r,p,N){if(ie(e=He(e),t=He(t),r=Y(r),p=Y(p),N=(N=Y(N))||0))return s;if(r<=0||p<=0)return h;if(e>=t)return s;let H,z;switch(N){case 0:H=360,z=wt(e,t,!1);break;case 1:case 3:H=365,z=Dt(e,t,"D");break;case 2:H=360,z=Dt(e,t,"D");break;case 4:H=360,z=wt(e,t,!0);break;default:return h}return(p-r)/p*H/z},m.DMAX=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);let H=N[p[0]];return A(p,z=>{H<N[z]&&(H=N[z])}),H},m.DMIN=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);let H=N[p[0]];return A(p,z=>{H>N[z]&&(H=N[z])}),H},m.DOLLAR=function(e,t=2){if(e=Y(e),isNaN(e))return s;const r={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},p=(e=xt(e,t)).toLocaleString("en-US",r);return e<0?"$("+p.slice(2)+")":p},m.DOLLARDE=function(e,t){if(ie(e=Y(e),t=Y(t)))return s;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let r=parseInt(e,10);r+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const p=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return r=Math.round(r*p)/p,r},m.DOLLARFR=function(e,t){if(ie(e=Y(e),t=Y(t)))return s;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let r=parseInt(e,10);return r+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,r},m.DPRODUCT=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const re=Ae(e,t);N=ae(e[re])}else N=ae(e[t]);let H=[];A(p,re=>{H.push(N[re])}),H=Jt(H);let z=1;return A(H,re=>{z*=re}),z},m.DSTDEV=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);let H=[];return A(p,z=>{H.push(N[z])}),H=Jt(H),De.S(H)},m.DSTDEVP=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);let H=[];return A(p,z=>{H.push(N[z])}),H=Jt(H),De.P(H)},m.DSUM=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);const H=[];return A(p,z=>{H.push(N[z])}),Et(H)},m.DURATION=function(){throw new Error("DURATION is not implemented")},m.DVAR=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);const H=[];return A(p,z=>{H.push(N[z])}),$e.S(H)},m.DVARP=function(e,t,r){if(isNaN(t)&&typeof t!="string")return s;const p=yt(e,r);let N=[];if(typeof t=="string"){const z=Ae(e,t);N=ae(e[z])}else N=ae(e[t]);const H=[];return A(p,z=>{H.push(N[z])}),$e.P(H)},m.EDATE=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?s:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},m.EFFECT=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<=0||t<1?h:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},m.EOMONTH=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?s:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},m.ERF=Xt,m.ERFC=Gt,m.ERFCPRECISE=Sn,m.ERFPRECISE=Fn,m.ERROR=Ft,m.EVEN=function(e){return(e=Y(e))instanceof Error?e:Xe(e,-2,-1)},m.EXACT=function(e,t){return arguments.length!==2?C:je(e,t)||(e=qe(e))===qe(t)},m.EXP=function(e){return arguments.length<1?C:arguments.length>1?T:(e=Y(e))instanceof Error?e:e=Math.exp(e)},m.EXPON=oe,m.EXPONDIST=On,m.F=pe,m.FACT=ft,m.FACTDOUBLE=function e(t){if((t=Y(t))instanceof Error)return t;const r=Math.floor(t);return r<=0?1:r*e(r-2)},m.FALSE=function(){return!1},m.FDIST=kn,m.FDISTRT=Rn,m.FIND=function(e,t,r){if(arguments.length<2)return C;e=qe(e),r=r===void 0?0:r;const p=(t=qe(t)).indexOf(e,r-1);return p===-1?s:p+1},m.FINV=Hn,m.FINVRT=Bn,m.FISHER=function(e){return(e=Y(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},m.FISHERINV=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},m.FIXED=an,m.FLOOR=Qe,m.FLOORMATH=_n,m.FLOORPRECISE=Pn,m.FORECAST=ce,m.FREQUENCY=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const r=e.length,p=t.length,N=[];for(let H=0;H<=p;H++){N[H]=0;for(let z=0;z<r;z++)H===0?e[z]<=t[0]&&(N[0]+=1):H<p?e[z]>t[H-1]&&e[z]<=t[H]&&(N[H]+=1):H===p&&e[z]>t[p-1]&&(N[p]+=1)}return N},m.FTEST=Vn,m.FV=Mt,m.FVSCHEDULE=function(e,t){if(ie(e=Y(e),t=Ne(q(t))))return s;const r=t.length;let p=e;for(let N=0;N<r;N++)p*=1+t[N];return p},m.GAMMA=fe,m.GAMMADIST=qn,m.GAMMAINV=Yn,m.GAMMALN=Ee,m.GAMMALNPRECISE=Un,m.GAUSS=function(e){return(e=Y(e))instanceof Error?e:d.normal.cdf(e,0,1)-.5},m.GCD=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=e.length,r=e[0];let p=r<0?-r:r;for(let N=1;N<t;N++){const H=e[N];let z=H<0?-H:H;for(;p&&z;)p>z?p%=z:z%=p;p+=z}return p},m.GEOMEAN=function(){const e=Ne(q(arguments));return e instanceof Error?e:d.geomean(e)},m.GESTEP=function(e,t){return ie(t=t||0,e=Y(e))?e:e>=t?1:0},m.GROWTH=function(e,t,r,p){if((e=Ne(e))instanceof Error)return e;let N;if(t===void 0)for(t=[],N=1;N<=e.length;N++)t.push(N);if(r===void 0)for(r=[],N=1;N<=e.length;N++)r.push(N);if(ie(t=Ne(t),r=Ne(r)))return s;p===void 0&&(p=!0);const H=e.length;let z,re,de=0,Ce=0,Oe=0,_e=0;for(N=0;N<H;N++){const We=t[N],et=Math.log(e[N]);de+=We,Ce+=et,Oe+=We*et,_e+=We*We}de/=H,Ce/=H,Oe/=H,_e/=H,p?(z=(Oe-de*Ce)/(_e-de*de),re=Ce-z*de):(z=Oe/_e,re=0);const Re=[];for(N=0;N<r.length;N++)Re.push(Math.exp(re+z*r[N]));return Re},m.HARMEAN=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=e.length;let r=0;for(let p=0;p<t;p++)r+=1/e[p];return t/r},m.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const r=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),p=r?parseInt(e,16)-1099511627776:parseInt(e,16);if(p<-512||p>511)return h;if(r)return"1"+vt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const N=p.toString(2);return t===void 0?N:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=N.length?vt("0",t-N.length)+N:h},m.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},m.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const r=parseInt(e,16);if(r>536870911&&r<0xffe0000000)return h;if(r>=0xffe0000000)return(r-0xffc0000000).toString(8);const p=r.toString(8);return t===void 0?p:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},m.HLOOKUP=function(e,t,r,p){return w(e,be(t),r,p)},m.HOUR=function(e){return(e=He(e))instanceof Error?e:e.getHours()},m.HYPGEOM=Ie,m.HYPGEOMDIST=zn,m.IF=function(e,t,r){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(r=arguments.length===3&&r)==null&&(r=0),e?t:r)},m.IFERROR=function(e,t){return Nt(e)?t:e},m.IFNA=function(e,t){return e===C?t:e},m.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return C},m.IMABS=$t,m.IMAGINARY=it,m.IMARGUMENT=Kt,m.IMCONJUGATE=function(e){const t=st(e),r=it(e);if(ie(t,r))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",r!==0?ht(t,-r,p):e},m.IMCOS=Pt,m.IMCOSH=ln,m.IMCOT=function(e){return ie(st(e),it(e))?s:Lt(Pt(e),Vt(e))},m.IMCSC=function(e){return e===!0||e===!1?s:ie(st(e),it(e))?h:Lt("1",Vt(e))},m.IMCSCH=function(e){return e===!0||e===!1?s:ie(st(e),it(e))?h:Lt("1",un(e))},m.IMDIV=Lt,m.IMEXP=function(e){const t=st(e),r=it(e);if(ie(t,r))return s;let p=e.substring(e.length-1);p=p==="i"||p==="j"?p:"i";const N=Math.exp(t);return ht(N*Math.cos(r),N*Math.sin(r),p)},m.IMLN=function(e){const t=st(e),r=it(e);if(ie(t,r))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.log(Math.sqrt(t*t+r*r)),Math.atan(r/t),p)},m.IMLOG10=function(e){const t=st(e),r=it(e);if(ie(t,r))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.log(Math.sqrt(t*t+r*r))/Math.log(10),Math.atan(r/t)/Math.log(10),p)},m.IMLOG2=function(e){const t=st(e),r=it(e);if(ie(t,r))return s;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",ht(Math.log(Math.sqrt(t*t+r*r))/Math.log(2),Math.atan(r/t)/Math.log(2),p)},m.IMPOWER=function(e,t){if(ie(t=Y(t),st(e),it(e)))return s;let r=e.substring(e.length-1);r=r==="i"||r==="j"?r:"i";const p=Math.pow($t(e),t),N=Kt(e);return ht(p*Math.cos(t*N),p*Math.sin(t*N),r)},m.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return s;for(let t=1;t<arguments.length;t++){const r=st(e),p=it(e),N=st(arguments[t]),H=it(arguments[t]);if(ie(r,p,N,H))return s;e=ht(r*N-p*H,r*H+p*N)}return e},m.IMREAL=st,m.IMSEC=function(e){return e===!0||e===!1||ie(st(e),it(e))?s:Lt("1",Pt(e))},m.IMSECH=function(e){return ie(st(e),it(e))?s:Lt("1",ln(e))},m.IMSIN=Vt,m.IMSINH=un,m.IMSQRT=function(e){if(ie(st(e),it(e)))return s;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const r=Math.sqrt($t(e)),p=Kt(e);return ht(r*Math.cos(p/2),r*Math.sin(p/2),t)},m.IMSUB=function(e,t){const r=st(e),p=it(e),N=st(t),H=it(t);if(ie(r,p,N,H))return s;const z=e.substring(e.length-1),re=t.substring(t.length-1);let de="i";return(z==="j"||re==="j")&&(de="j"),ht(r-N,p-H,de)},m.IMSUM=function(){if(!arguments.length)return s;const e=q(arguments);let t=e[0];for(let r=1;r<e.length;r++){const p=st(t),N=it(t),H=st(e[r]),z=it(e[r]);if(ie(p,N,H,z))return s;t=ht(p+H,N+z)}return t},m.IMTAN=function(e){return e===!0||e===!1||ie(st(e),it(e))?s:Lt(Vt(e),Pt(e))},m.INDEX=function(e,t,r){const p=je(e,t,r);if(p)return p;if(!Array.isArray(e))return s;const N=e.length>0&&!Array.isArray(e[0]);return N&&!r?(r=t,t=1):(r=r||1,t=t||1),r<0||t<0?s:N&&t===1&&r<=e.length?e[r-1]:t<=e.length&&r<=e[t-1].length?e[t-1][r-1]:b},m.INFO=function(){throw new Error("INFO is not implemented")},m.INT=function(e){return(e=Y(e))instanceof Error?e:Math.floor(e)},m.INTERCEPT=function(e,t){return ie(e=Ne(e),t=Ne(t))?s:e.length!==t.length?C:ce(0,e,t)},m.INTRATE=function(){throw new Error("INTRATE is not implemented")},m.IPMT=cn,m.IRR=function(e,t){if(t=t||0,ie(e=Ne(q(e)),t=Y(t)))return s;const r=(Re,We,et)=>{const ot=et+1;let jt=Re[0];for(let ct=1;ct<Re.length;ct++)jt+=Re[ct]/Math.pow(ot,(We[ct]-We[0])/365);return jt},p=(Re,We,et)=>{const ot=et+1;let jt=0;for(let ct=1;ct<Re.length;ct++){const Ct=(We[ct]-We[0])/365;jt-=Ct*Re[ct]/Math.pow(ot,Ct+1)}return jt},N=[];let H=!1,z=!1;for(let Re=0;Re<e.length;Re++)N[Re]=Re===0?0:N[Re-1]+365,e[Re]>0&&(H=!0),e[Re]<0&&(z=!0);if(!H||!z)return h;let re,de,Ce,Oe=t=t===void 0?.1:t,_e=!0;do Ce=r(e,N,Oe),re=Oe-Ce/p(e,N,Oe),de=Math.abs(re-Oe),Oe=re,_e=de>1e-10&&Math.abs(Ce)>1e-10;while(_e);return Oe},m.ISBLANK=function(e){return e===null},m.ISERR=Tt,m.ISERROR=Nt,m.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},m.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},m.ISLOGICAL=Ot,m.ISNA=function(e){return e===C},m.ISNONTEXT=function(e){return typeof e!="string"},m.ISNUMBER=pt,m.ISO=at,m.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},m.ISOWEEKNUM=tn,m.ISPMT=function(e,t,r,p){return ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p))?s:p*e*(t/r-1)},m.ISREF=function(){throw new Error("ISREF is not implemented")},m.ISTEXT=qt,m.KURT=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;const t=d.mean(e),r=e.length;let p=0;for(let N=0;N<r;N++)p+=Math.pow(e[N]-t,4);return p/=Math.pow(d.stdev(e,!0),4),r*(r+1)/((r-1)*(r-2)*(r-3))*p-3*(r-1)*(r-1)/((r-2)*(r-3))},m.LARGE=Se,m.LCM=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;for(var t,r,p,N,H=1;(p=e.pop())!==void 0;){if(p===0)return 0;for(;p>1;){if(p%2){for(t=3,r=Math.floor(Math.sqrt(p));t<=r&&p%t;t+=2);N=t<=r?t:p}else N=2;for(p/=N,H*=N,t=e.length;t;e[--t]%N==0&&(e[t]/=N)==1&&e.splice(t,1));}}return H},m.LEFT=function(e,t){return je(e,t)||(e=qe(e),(t=Y(t=t===void 0?1:t))instanceof Error||typeof e!="string"?s:e.substring(0,t))},m.LEN=function(e){return arguments.length===0?T:e instanceof Error?e:Array.isArray(e)?s:qe(e).length},m.LINEST=ze,m.LN=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)},m.LOG=function(e,t){return je(e=Y(e),t=Y(t))||(e===0||t===0?h:Math.log(e)/Math.log(t))},m.LOG10=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)/Math.log(10)},m.LOGEST=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t)))||e.length!==t.length)return s;for(let p=0;p<e.length;p++)e[p]=Math.log(e[p]);const r=ze(e,t);return r[0]=Math.round(1e6*Math.exp(r[0]))/1e6,r[1]=Math.round(1e6*Math.exp(r[1]))/1e6,r},m.LOGINV=Wn,m.LOGNORM=Ge,m.LOGNORMDIST=Xn,m.LOGNORMINV=Gn,m.LOOKUP=function(e,t,r){t=q(t),r=r?q(r):t;const p=typeof e=="number";let N=C;for(let H=0;H<t.length;H++){if(t[H]===e)return r[H];if(p&&t[H]<=e||typeof t[H]=="string"&&t[H].localeCompare(e)<0)N=r[H];else if(p&&t[H]>e)return N}return N},m.LOWER=function(e){return arguments.length!==1?s:ie(e=qe(e))?e:e.toLowerCase()},m.MATCH=function(e,t,r){if(!e||!t||(arguments.length===2&&(r=1),!((t=q(t))instanceof Array))||r!==-1&&r!==0&&r!==1)return C;let p,N;for(let H=0;H<t.length;H++)if(r===1){if(t[H]===e)return H+1;t[H]<e&&(N?t[H]>N&&(p=H+1,N=t[H]):(p=H+1,N=t[H]))}else if(r===0){if(typeof e=="string"&&typeof t[H]=="string"){const z=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+z+"$").test(t[H].toLowerCase()))return H+1}else if(t[H]===e)return H+1}else if(r===-1){if(t[H]===e)return H+1;t[H]>e&&(N?t[H]<N&&(p=H+1,N=t[H]):(p=H+1,N=t[H]))}return p||C},m.MAX=Q,m.MAXA=function(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;let r=R(e);return r=r.map(p=>p??0),r.length===0?0:Math.max.apply(Math,r)},m.MDURATION=function(){throw new Error("MDURATION is not implemented")},m.MEDIAN=he,m.MID=function(e,t,r){if(t==null)return s;if(ie(t=Y(t),r=Y(r))||typeof e!="string")return r;const p=t-1,N=p+r;return e.substring(p,N)},m.MIN=we,m.MINA=function(){const e=q(arguments),t=je.apply(void 0,e);if(t)return t;let r=R(e);return r=r.map(p=>p??0),r.length===0?0:Math.min.apply(Math,r)},m.MINUTE=function(e){return(e=He(e))instanceof Error?e:e.getMinutes()},m.MIRR=function(e,t,r){if(ie(e=Ne(q(e)),t=Y(t),r=Y(r)))return s;const p=e.length,N=[],H=[];for(let de=0;de<p;de++)e[de]<0?N.push(e[de]):H.push(e[de]);const z=-en(r,H)*Math.pow(1+r,p-1),re=en(t,N)*(1+t);return Math.pow(z/re,1/(p-1))-1},m.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(r=>!r.length)||t.some(r=>!r.length)||se(e).some(r=>typeof r!="number")||se(t).some(r=>typeof r!="number")||e[0].length!==t.length?s:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((r,p)=>r.map((N,H)=>e[p].reduce((z,re,de)=>z+re*t[de][H],0)))},m.MOD=function(e,t){const r=je(e=Y(e),t=Y(t));if(r)return r;if(t===0)return g;let p=Math.abs(e%t);return p=e<0?t-p:p,t>0?p:-p},m.MODE=U,m.MODEMULT=$n,m.MODESNGL=Kn,m.MONTH=function(e){return(e=He(e))instanceof Error?e:e.getMonth()+1},m.MROUND=function(e,t){return je(e=Y(e),t=Y(t))||(e*t==0?0:e*t<0?h:Math.round(e/t)*t)},m.MULTINOMIAL=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;let t=0,r=1;for(let p=0;p<e.length;p++)t+=e[p],r*=ft(e[p]);return ft(t)/r},m.MUNIT=function(e){return arguments.length>1?C:!(e=parseInt(e))||e<=0?s:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,r)=>(t[r]=1,t))},m.N=function(e){return pt(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:Nt(e)?e:0},m.NA=function(){return C},m.NEGBINOM=J,m.NEGBINOMDIST=Jn,m.NETWORKDAYS=Ht,m.NETWORKDAYSINTL=Zn,m.NOMINAL=function(e,t){return ie(e=Y(e),t=Y(t))?s:e<=0||t<1?h:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},m.NORM=v,m.NORMDIST=Qn,m.NORMINV=eo,m.NORMSDIST=to,m.NORMSINV=no,m.NOT=function(e){return typeof e=="string"?s:e instanceof Error?e:!e},m.NOW=function(){return new Date},m.NPER=function(e,t,r,p,N){if(N=N===void 0?0:N,p=p===void 0?0:p,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p),N=Y(N)))return s;if(e===0)return-(r+p)/t;{const H=t*(1+e*N)-p*e,z=r*e+t*(1+e*N);return Math.log(H/z)/Math.log(1+e)}},m.NPV=en,m.NUMBERVALUE=function(e,t,r){return typeof(e=tt(e)?e:"")=="number"?e:typeof e!="string"?C:(t=t===void 0?".":t,r=r===void 0?",":r,Number(e.replace(t,".").replace(r,"")))},m.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const r=!(e.length!==10||e.substring(0,1)!=="7"),p=r?parseInt(e,8)-1073741824:parseInt(e,8);if(p<-512||p>511)return h;if(r)return"1"+vt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const N=p.toString(2);return t===void 0?N:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=N.length?vt("0",t-N.length)+N:h},m.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return h;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},m.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const r=parseInt(e,8);if(r>=536870912)return"ff"+(r+3221225472).toString(16);const p=r.toString(16);return t===void 0?p:isNaN(t)?s:t<0?h:(t=Math.floor(t))>=p.length?vt("0",t-p.length)+p:h},m.ODD=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},m.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},m.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},m.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},m.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},m.OR=function(){const e=q(arguments);let t=s;for(let r=0;r<e.length;r++){if(e[r]instanceof Error)return e[r];e[r]!==void 0&&e[r]!==null&&typeof e[r]!="string"&&(t===s&&(t=!1),e[r]&&(t=!0))}return t},m.PDURATION=function(e,t,r){return ie(e=Y(e),t=Y(t),r=Y(r))?s:e<=0?h:(Math.log(r)-Math.log(t))/Math.log(1+e)},m.PEARSON=D,m.PERCENTILE=X,m.PERCENTILEEXC=oo,m.PERCENTILEINC=ro,m.PERCENTRANK=ue,m.PERCENTRANKEXC=io,m.PERCENTRANKINC=so,m.PERMUT=function(e,t){return ie(e=Y(e),t=Y(t))?s:ft(e)/ft(e-t)},m.PERMUTATIONA=function(e,t){return ie(e=Y(e),t=Y(t))?s:Math.pow(e,t)},m.PHI=function(e){return(e=Y(e))instanceof Error?s:Math.exp(-.5*e*e)/2.5066282746310002},m.PI=function(){return Math.PI},m.PMT=St,m.POISSON=K,m.POISSONDIST=ao,m.POWER=Je,m.PPMT=function(e,t,r,p,N,H){return N=N||0,H=H||0,ie(e=Y(e),r=Y(r),p=Y(p),N=Y(N),H=Y(H))?s:St(e,r,p,N,H)-cn(e,t,r,p,N,H)},m.PRICE=function(){throw new Error("PRICE is not implemented")},m.PRICEDISC=function(e,t,r,p,N){if(ie(e=He(e),t=He(t),r=Y(r),p=Y(p),N=(N=Y(N))||0))return s;if(r<=0||p<=0)return h;if(e>=t)return s;let H,z;switch(N){case 0:H=360,z=wt(e,t,!1);break;case 1:case 3:H=365,z=Dt(e,t,"D");break;case 2:H=360,z=Dt(e,t,"D");break;case 4:H=360,z=wt(e,t,!0);break;default:return h}return p-r*p*z/H},m.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},m.PROB=function(e,t,r,p){if(r===void 0)return 0;if(p=p===void 0?r:p,ie(e=Ne(q(e)),t=Ne(q(t)),r=Y(r),p=Y(p)))return s;if(r===p)return e.indexOf(r)>=0?t[e.indexOf(r)]:0;const N=e.sort((re,de)=>re-de),H=N.length;let z=0;for(let re=0;re<H;re++)N[re]>=r&&N[re]<=p&&(z+=t[e.indexOf(N[re])]);return z},m.PRODUCT=Yt,m.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},m.PROPER=function(e){return ie(e)?e:isNaN(e)&&typeof e=="number"?s:(e=qe(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},m.PV=function(e,t,r,p,N){return p=p||0,N=N||0,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p),N=Y(N))?s:e===0?-r*t-p:((1-Math.pow(1+e,t))/e*r*(1+e*N)-p)/Math.pow(1+e,t)},m.QUARTILE=le,m.QUARTILEEXC=lo,m.QUARTILEINC=uo,m.QUOTIENT=function(e,t){return je(e=Y(e),t=Y(t))||parseInt(e/t,10)},m.RADIANS=function(e){return(e=Y(e))instanceof Error?e:e*Math.PI/180},m.RAND=function(){return Math.random()},m.RANDBETWEEN=function(e,t){return je(e=Y(e),t=Y(t))||e+Math.ceil((t-e+1)*Math.random())-1},m.RANK=me,m.RANKAVG=co,m.RANKEQ=fo,m.RATE=function(e,t,r,p,N,H){if(H=H===void 0?.01:H,p=p===void 0?0:p,N=N===void 0?0:N,ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p),N=Y(N),H=Y(H)))return s;const z=1e-10;let re=H;N=N?1:0;for(let de=0;de<20;de++){if(re<=-1)return h;let Ce,Oe,_e;if(Math.abs(re)<z?Ce=r*(1+e*re)+t*(1+re*N)*e+p:(Oe=Math.pow(1+re,e),Ce=r*Oe+t*(1/re+N)*(Oe-1)+p),Math.abs(Ce)<z)return re;if(Math.abs(re)<z)_e=r*e+t*N*e;else{Oe=Math.pow(1+re,e);const Re=e*Math.pow(1+re,e-1);_e=r*Re+t*(1/re+N)*Re+t*(-1/(re*re))*(Oe-1)}re-=Ce/_e}return re},m.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},m.REPLACE=function(e,t,r,p){return ie(t=Y(t),r=Y(r))||typeof e!="string"||typeof p!="string"?s:e.substr(0,t-1)+p+e.substr(t-1+r)},m.REPT=vt,m.RIGHT=function(e,t){return je(e,t)||(e=qe(e),(t=Y(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},m.ROMAN=function(e){if((e=Y(e))instanceof Error)return e;const t=String(e).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let p="",N=3;for(;N--;)p=(r[+t.pop()+10*N]||"")+p;return new Array(+t.join("")+1).join("M")+p},m.ROUND=xt,m.ROUNDDOWN=function(e,t){return je(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},m.ROUNDUP=function(e,t){return je(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},m.ROW=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?d.row(e,t):void 0:s},m.ROWS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:d.rows(e):s},m.RRI=function(e,t,r){return ie(e=Y(e),t=Y(t),r=Y(r))?s:e===0||t===0?h:Math.pow(r/t,1/e)-1},m.RSQ=function(e,t){return ie(e=Ne(q(e)),t=Ne(q(t)))?s:Math.pow(D(e,t),2)},m.SEARCH=function(e,t,r){let p;return typeof e!="string"||typeof t!="string"?s:(r=r===void 0?0:r,p=t.toLowerCase().indexOf(e.toLowerCase(),r-1)+1,p===0?s:p)},m.SEC=function(e){return(e=Y(e))instanceof Error?e:1/Math.cos(e)},m.SECH=function(e){return(e=Y(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},m.SECOND=function(e){return(e=He(e))instanceof Error?e:e.getSeconds()},m.SERIESSUM=function(e,t,r,p){if(ie(e=Y(e),t=Y(t),r=Y(r),p=Ne(p)))return s;let N=p[0]*Math.pow(e,t);for(let H=1;H<p.length;H++)N+=p[H]*Math.pow(e,t+H*r);return N},m.SHEET=function(){throw new Error("SHEET is not implemented")},m.SHEETS=function(){throw new Error("SHEETS is not implemented")},m.SIGN=function(e){return(e=Y(e))instanceof Error?e:e<0?-1:e===0?0:1},m.SIN=function(e){return(e=Y(e))instanceof Error?e:Math.sin(e)},m.SINH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},m.SKEW=Me,m.SKEWP=po,m.SLN=function(e,t,r){return ie(e=Y(e),t=Y(t),r=Y(r))?s:r===0?h:(e-t)/r},m.SLOPE=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const r=d.mean(t),p=d.mean(e),N=t.length;let H=0,z=0;for(let re=0;re<N;re++)H+=(t[re]-r)*(e[re]-p),z+=Math.pow(t[re]-r,2);return H/z},m.SMALL=xe,m.SORT=function(e,t=1,r=1,p=!1){if(!e||!Array.isArray(e))return C;if(e.length===0)return 0;if(!(t=Y(t))||t<1||(r=Y(r))!==1&&r!==-1)return s;if(typeof(p=Ve(p))!="boolean")return j;const N=re=>re.sort((de,Ce)=>(de=qe(de[t-1]),Ce=qe(Ce[t-1]),r===1?de<Ce?-1*r:r:de>Ce?r:-1*r)),H=Z(e),z=p?be(H):H;return t>=1&&t<=z[0].length?p?be(N(z)):N(z):s},m.SQRT=function(e){return(e=Y(e))instanceof Error?e:e<0?h:Math.sqrt(e)},m.SQRTPI=function(e){return(e=Y(e))instanceof Error?e:Math.sqrt(e*Math.PI)},m.STANDARDIZE=function(e,t,r){return ie(e=Y(e),t=Y(t),r=Y(r))?s:(e-t)/r},m.STDEV=De,m.STDEVA=function(){const e=ne.apply(this,arguments);return Math.sqrt(e)},m.STDEVP=ho,m.STDEVPA=function(){const e=ve.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},m.STDEVS=go,m.STEYX=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;const r=d.mean(t),p=d.mean(e),N=t.length;let H=0,z=0,re=0;for(let de=0;de<N;de++)H+=Math.pow(e[de]-p,2),z+=(t[de]-r)*(e[de]-p),re+=Math.pow(t[de]-r,2);return Math.sqrt((H-z*z/re)/(N-2))},m.SUBSTITUTE=function(e,t,r,p){if(arguments.length<3)return C;if(e&&t){if(p===void 0)return e.split(t).join(r);{if(p=Math.floor(Number(p)),Number.isNaN(p)||p<=0)return s;let N=0,H=0;for(;N>-1&&e.indexOf(t,N)>-1;)if(N=e.indexOf(t,N+1),H++,N>-1&&H===p)return e.substring(0,N)+r+e.substring(N+t.length);return e}}return e},m.SUBTOTAL=function(e,t){if((e=Y(e))instanceof Error)return e;switch(e){case 1:case 101:return E(t);case 2:case 102:return S(t);case 3:case 103:return M(t);case 4:case 104:return Q(t);case 5:case 105:return we(t);case 6:case 106:return Yt(t);case 7:case 107:return De.S(t);case 8:case 108:return De.P(t);case 9:case 109:return Et(t);case 10:case 110:return $e.S(t);case 11:case 111:return $e.P(t)}},m.SUM=Et,m.SUMIF=function(e,t,r){if(e=q(e),r=r?q(r):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let p=0;const N=t==="*",H=N?null:gt(t+"");for(let z=0;z<e.length;z++){const re=e[z],de=r[z];if(N)p+=re;else{const Ce=[dt(re,rt)].concat(H);p+=bt(Ce)?de:0}}return p},m.SUMIFS=function(){const e=O(arguments),t=Ne(q(e.shift()));if(t instanceof Error)return t;const r=e,p=r.length/2;for(let H=0;H<p;H++)r[2*H]=q(r[2*H]);let N=0;for(let H=0;H<t.length;H++){let z=!1;for(let re=0;re<p;re++){const de=r[2*re][H],Ce=r[2*re+1];let Oe=!1;if(Ce===void 0||Ce==="*")Oe=!0;else{const _e=gt(Ce+""),Re=[dt(de,rt)].concat(_e);Oe=bt(Re)}if(!Oe){z=!1;break}z=!0}z&&(N+=t[H])}return N},m.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return s;const e=arguments.length+1;let t,r,p,N,H=0;for(let z=0;z<arguments[0].length;z++)if(arguments[0][z]instanceof Array)for(let re=0;re<arguments[0][z].length;re++){for(t=1,r=1;r<e;r++){const de=arguments[r-1][z][re];if(de instanceof Error)return de;if(N=Y(de),N instanceof Error)return N;t*=N}H+=t}else{for(t=1,r=1;r<e;r++){const re=arguments[r-1][z];if(re instanceof Error)return re;if(p=Y(re),p instanceof Error)return p;t*=p}H+=t}return H},m.SUMSQ=function(){const e=Ne(q(arguments));if(e instanceof Error)return e;let t=0;const r=e.length;for(let p=0;p<r;p++)t+=pt(e[p])?e[p]*e[p]:0;return t},m.SUMX2MY2=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;let r=0;for(let p=0;p<e.length;p++)r+=e[p]*e[p]-t[p]*t[p];return r},m.SUMX2PY2=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;let r=0;e=Ne(q(e)),t=Ne(q(t));for(let p=0;p<e.length;p++)r+=e[p]*e[p]+t[p]*t[p];return r},m.SUMXMY2=function(e,t){if(ie(e=Ne(q(e)),t=Ne(q(t))))return s;let r=0;e=q(e),t=q(t);for(let p=0;p<e.length;p++)r+=Math.pow(e[p]-t[p],2);return r},m.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],r=arguments.length-1,p=Math.floor(r/2);let N=!1;const H=r%2!=0,z=r%2==0?null:arguments[arguments.length-1];if(p){for(let re=0;re<p;re++)if(t===arguments[2*re+1]){e=arguments[2*re+2],N=!0;break}}N||(e=H?z:C)}else e=s;return e},m.SYD=function(e,t,r,p){return ie(e=Y(e),t=Y(t),r=Y(r),p=Y(p))?s:r===0||p<1||p>r?h:(e-t)*(r-(p=parseInt(p,10))+1)*2/(r*(r+1))},m.T=function(e){return e instanceof Error||typeof e=="string"?e:""},m.TAN=function(e){return(e=Y(e))instanceof Error?e:Math.tan(e)},m.TANH=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},m.TBILLEQ=function(e,t,r){return ie(e=He(e),t=He(t),r=Y(r))?s:r<=0||e>t||t-e>31536e6?h:365*r/(360-r*wt(e,t,!1))},m.TBILLPRICE=function(e,t,r){return ie(e=He(e),t=He(t),r=Y(r))?s:r<=0||e>t||t-e>31536e6?h:100*(1-r*wt(e,t,!1)/360)},m.TBILLYIELD=function(e,t,r){return ie(e=He(e),t=He(t),r=Y(r))?s:r<=0||e>t||t-e>31536e6?h:360*(100-r)/(r*wt(e,t,!1))},m.TDIST=mo,m.TDISTRT=bo,m.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return C;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return s;const r=t.startsWith("$")?"$":"",p=t.endsWith("%");return p&&(e*=100),e=(e=an(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+r+(e=e.replace("-","")):r+e,p&&(e+="%"),e},m.TEXTJOIN=function(e,t,...r){if(typeof t!="boolean"&&(t=Ve(t)),arguments.length<3)return C;e=e??"";let p=q(r),N=t?p.filter(H=>H):p;if(Array.isArray(e)){e=q(e);let H=N.map(re=>[re]),z=0;for(let re=0;re<H.length-1;re++)H[re].push(e[z]),z++,z===e.length&&(z=0);return N=q(H),N.join("")}return N.join(e)},m.TIME=function(e,t,r){return ie(e=Y(e),t=Y(t),r=Y(r))?s:e<0||t<0||r<0?h:(3600*e+60*t+r)/86400},m.TIMEVALUE=function(e){return(e=He(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},m.TINV=jo,m.TODAY=function(){return Rt(new Date)},m.TRANSPOSE=function(e){return e?be(Z(e)):C},m.TREND=function(e,t,r){if(ie(e=Ne(q(e)),t=Ne(q(t)),r=Ne(q(r))))return s;const p=ze(e,t),N=p[0],H=p[1],z=[];return r.forEach(re=>{z.push(N*re+H)}),z},m.TRIM=function(e){return(e=qe(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},m.TRIMMEAN=function(e,t){if(ie(e=Ne(q(e)),t=Y(t)))return s;const r=Qe(e.length*t,2)/2;return d.mean((N=(N=r)||1,(p=ae(e.sort((H,z)=>H-z),r))&&typeof p.slice=="function"?p.slice(0,p.length-N):p));var p,N},m.TRUE=function(){return!0},m.TRUNC=function(e,t){return je(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},m.TTEST=vo,m.TYPE=function(e){return pt(e)?1:qt(e)?2:Ot(e)?4:Nt(e)?16:Array.isArray(e)?64:void 0},m.UNICHAR=mn,m.UNICODE=bn,m.UNIQUE=It,m.UPPER=function(e){return(e=qe(e))instanceof Error?e:e.toUpperCase()},m.VALUE=function(e){const t=je(e);if(t)return t;if(typeof e=="number")return e;if(tt(e)||(e=""),typeof e!="string")return s;const r=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let p=Number(e);return isNaN(p)?s:(p=p||0,r&&(p*=.01),p)},m.VAR=$e,m.VARA=ne,m.VARP=yo,m.VARPA=ve,m.VARS=xo,m.VDB=function(){throw new Error("VDB is not implemented")},m.VLOOKUP=w,m.WEEKDAY=function(e,t){if((e=He(e))instanceof Error)return e;t===void 0&&(t=1);const r=e.getDay();return hn[t][r]},m.WEEKNUM=function(e,t){if((e=He(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return tn(e);const r=pn[t];let p=new Date(e.getFullYear(),0,1);const N=p.getDay()<r?1:0;return p-=24*Math.abs(p.getDay()-r)*60*60*1e3,Math.floor((e-p)/864e5/7+1)+N},m.WEIBULL=ye,m.WEIBULLDIST=wo,m.WORKDAY=Bt,m.WORKDAYINTL=Co,m.XIRR=function(e,t,r){if(ie(e=Ne(q(e)),t=ut(q(t)),r=Y(r)))return s;const p=(Re,We,et)=>{const ot=et+1;let jt=Re[0];for(let ct=1;ct<Re.length;ct++)jt+=Re[ct]/Math.pow(ot,At(We[ct],We[0])/365);return jt},N=(Re,We,et)=>{const ot=et+1;let jt=0;for(let ct=1;ct<Re.length;ct++){const Ct=At(We[ct],We[0])/365;jt-=Ct*Re[ct]/Math.pow(ot,Ct+1)}return jt};let H=!1,z=!1;for(let Re=0;Re<e.length;Re++)e[Re]>0&&(H=!0),e[Re]<0&&(z=!0);if(!H||!z)return h;let re,de,Ce,Oe=r=r||.1,_e=!0;do Ce=p(e,t,Oe),re=Oe-Ce/N(e,t,Oe),de=Math.abs(re-Oe),Oe=re,_e=de>1e-10&&Math.abs(Ce)>1e-10;while(_e);return Oe},m.XNPV=function(e,t,r){if(ie(e=Y(e),t=Ne(q(t)),r=ut(q(r))))return s;let p=0;for(let N=0;N<t.length;N++)p+=t[N]/Math.pow(1+e,At(r[N],r[0])/365);return p},m.XOR=function(){const e=q(arguments);let t=s;for(let r=0;r<e.length;r++){if(e[r]instanceof Error)return e[r];e[r]!==void 0&&e[r]!==null&&typeof e[r]!="string"&&(t===s&&(t=0),e[r]&&t++)}return t===s?t:!!(1&Math.floor(Math.abs(t)))},m.YEAR=function(e){return(e=He(e))instanceof Error?e:e.getFullYear()},m.YEARFRAC=zt,m.YIELD=function(){throw new Error("YIELD is not implemented")},m.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},m.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},m.Z=ke,m.ZTEST=Eo,m.utils=Ao}},f={};function L(W){var m=f[W];if(m!==void 0)return m.exports;var u=f[W]={exports:{}};return c[W].call(u.exports,u,u.exports,L),u.exports}L.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var k=L(960);l=k}(),l)},44:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(463);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(n){var l=(""+n)[0];return l=="="||l=="#"},getMask=function(n){if(n.format||n.mask||n.locale){var l={};return n.mask?l.mask=n.mask:n.format?l.mask=n.format:(l.locale=n.locale,l.options=n.options),n.decimal&&(l.options||(l.options={}),l.options={decimal:n.decimal}),l}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(n){n==null&&(n=!obj.options.fullscreen),obj.options.fullscreen!=n&&(obj.options.fullscreen=n,n==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(n){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var l=obj.options.onevent.apply(this,arguments);typeof obj.options[n]=="function"&&(l=obj.options[n].apply(this,Array.prototype.slice.call(arguments,1)))}if(n=="onafterchanges"&&obj.options.persistance){var c=obj.options.persistance==1?obj.options.url:obj.options.persistance,f=obj.prepareJson(arguments[2]);obj.save(c,f)}return l},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var l=Object.keys(obj.options.data[0]);l.length>n&&(n=l.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var c=[],f=0;f<n;f++)obj.options.colHeaders[f]||(obj.options.colHeaders[f]=""),obj.options.colWidths[f]||(obj.options.colWidths[f]=obj.options.defaultColWidth),obj.options.colAlignments[f]||(obj.options.colAlignments[f]=obj.options.defaultColAlign),obj.options.columns[f]?obj.options.columns[f].type||(obj.options.columns[f].type="text"):obj.options.columns[f]={type:"text"},obj.options.columns[f].name||(obj.options.columns[f].name=l&&l[f]?l[f]:f),obj.options.columns[f].source||(obj.options.columns[f].source=[]),obj.options.columns[f].options||(obj.options.columns[f].options=[]),obj.options.columns[f].editor||(obj.options.columns[f].editor=null),obj.options.columns[f].allowEmpty||(obj.options.columns[f].allowEmpty=!1),obj.options.columns[f].title||(obj.options.columns[f].title=obj.options.colHeaders[f]?obj.options.colHeaders[f]:""),obj.options.columns[f].width||(obj.options.columns[f].width=obj.options.colWidths[f]?obj.options.colWidths[f]:obj.options.defaultColWidth),obj.options.columns[f].align||(obj.options.columns[f].align=obj.options.colAlignments[f]?obj.options.colAlignments[f]:"center"),obj.options.columns[f].type=="autocomplete"||obj.options.columns[f].type=="dropdown"?obj.options.columns[f].url&&c.push({url:obj.options.columns[f].url,index:f,method:"GET",dataType:"json",success:function(L){for(var k=0;k<L.length;k++)obj.options.columns[this.index].source.push(L[k])}}):obj.options.columns[f].type=="calendar"&&(obj.options.columns[f].options.format||(obj.options.columns[f].options.format="DD/MM/YYYY"));c.length?jSuites.ajax(c,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(j){obj.scrollControls(j)},obj.content.onwheel=function(j){obj.wheelControls(j)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var n=document.createElement("div"),l=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),n.appendChild(l),n.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var c=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var f=0;f<obj.options.paginationOptions.length;f++){var L=document.createElement("option");L.value=obj.options.paginationOptions[f],L.innerHTML=obj.options.paginationOptions[f],obj.paginationDropdown.appendChild(L)}obj.paginationDropdown.value=obj.options.pagination,c.appendChild(document.createTextNode(obj.options.text.show)),c.appendChild(obj.paginationDropdown),c.appendChild(document.createTextNode(obj.options.text.entries))}var k,W=document.createElement("div");if(W.classList.add("jexcel_filter"),W.appendChild(c),W.appendChild(n),obj.colgroupContainer=document.createElement("colgroup"),(k=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(k),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var m=0;m<obj.options.nestedHeaders.length;m++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[m]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(k=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(k),f=0;f<obj.options.columns.length;f++)obj.createCellHeader(f),obj.headerContainer.appendChild(obj.headers[f]),obj.colgroupContainer.appendChild(obj.colgroup[f]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var u=document.createElement("td");for(obj.filter.appendChild(u),f=0;f<obj.options.columns.length;f++)(u=document.createElement("td")).innerHTML="&nbsp;",u.setAttribute("data-x",f),u.className="jexcel_column_filter",obj.options.columns[f].type=="hidden"&&(u.style.display="none"),obj.filter.appendChild(u);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var d=document.createElement("a");d.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var F=document.createElement("span");F.innerHTML="Jspreadsheet CE",d.appendChild(F),obj.ads.appendChild(d),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var _=document.createElement("div"),g=document.createElement("div");if(obj.pagination.appendChild(_),obj.pagination.appendChild(g),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(W),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var s=Object.keys(obj.options.classes);for(f=0;f<s.length;f++){var b=jexcel.getIdFromColumnName(s[f],!0);obj.records[b[1]][b[0]].classList.add(obj.options.classes[s[f]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(n){if(n&&(typeof n=="string"&&(n=JSON.parse(n)),obj.options.data=n),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){n=[];for(var l=0;l<obj.options.data.length;l++){for(var c=[],f=0;f<obj.options.columns.length;f++)c[f]=obj.options.data[l][obj.options.columns[f].name];n.push(c)}obj.options.data=n}l=0,f=0;var L=obj.options.columns.length,k=obj.options.data.length,W=obj.options.minDimensions[0],m=obj.options.minDimensions[1],u=W>L?W:L,d=m>k?m:k;for(l=0;l<d;l++)for(f=0;f<u;f++)obj.options.data[l]==null&&(obj.options.data[l]=[]),obj.options.data[l][f]==null&&(obj.options.data[l][f]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var F=0,_=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,F=obj.options.pagination*obj.pageNumber,_=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<_&&(_=obj.options.data.length)):(F=0,_=obj.options.data.length);for(l=0;l<obj.options.data.length;l++){var g=obj.createRow(l,obj.options.data[l]);l>=F&&l<_&&obj.tbody.appendChild(g)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var s=Object.keys(obj.options.mergeCells);for(f=0;f<s.length;f++){var b=obj.options.mergeCells[s[f]];obj.setMerge(s[f],b[0],b[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(n,l){for(var c=[],f=0,L=0,k=l==1||obj.options.copyCompatibility==0,W=obj.options.columns.length,m=obj.options.data.length,u=0;u<m;u++){f=0;for(var d=0;d<W;d++)n&&!obj.records[u][d].classList.contains("highlight")||(c[L]||(c[L]=[]),c[L][f]=k?obj.options.data[u][d]:obj.records[u][d].innerHTML,f++);f>0&&L++}return c},obj.getJsonRow=function(n){for(var l=obj.options.data[n],c=obj.options.columns.length,f={},L=0;L<c;L++)obj.options.columns[L].name||(obj.options.columns[L].name=L),f[obj.options.columns[L].name]=l[L];return f},obj.getJson=function(n){for(var l=[],c=obj.options.columns.length,f=obj.options.data.length,L=0;L<f;L++){for(var k=null,W=0;W<c;W++)n&&!obj.records[L][W].classList.contains("highlight")||(k==null&&(k={}),obj.options.columns[W].name||(obj.options.columns[W].name=W),k[obj.options.columns[W].name]=obj.options.data[L][W]);k!=null&&l.push(k)}return l},obj.prepareJson=function(n){for(var l=[],c=0;c<n.length;c++){var f=n[c].x,L=n[c].y,k=obj.options.columns[f].name?obj.options.columns[f].name:f;l[L]||(l[L]={row:L,data:{}}),l[L].data[k]=n[c].newValue}return l.filter(function(W){return W!=null})},obj.save=function(n,l){var c=obj.dispatch("onbeforesave",el,obj,l);if(c)l=c;else if(c===!1)return!1;jSuites.ajax({url:n,method:"POST",dataType:"json",data:{data:JSON.stringify(l)},success:function(f){obj.dispatch("onsave",el,obj,l)}})},obj.getRowData=function(n){return obj.options.data[n]},obj.setRowData=function(n,l){for(var c=0;c<obj.headers.length;c++){var f=jexcel.getColumnNameFromId([c,n]);l[c]!=null&&obj.setValue(f,l[c])}},obj.getColumnData=function(n){for(var l=[],c=0;c<obj.options.data.length;c++)l.push(obj.options.data[c][n]);return l},obj.setColumnData=function(n,l){for(var c=0;c<obj.rows.length;c++){var f=jexcel.getColumnNameFromId([n,c]);l[c]!=null&&obj.setValue(f,l[c])}},obj.createRow=function(n,l){obj.records[n]||(obj.records[n]=[]),l||(l=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n);var c=null;obj.options.defaultRowHeight&&(obj.rows[n].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[n]&&(obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height),obj.options.rows[n].title&&(c=obj.options.rows[n].title)),c||(c=parseInt(n+1));var f=document.createElement("td");f.innerHTML=c,f.setAttribute("data-y",n),f.className="jexcel_row",obj.rows[n].appendChild(f);for(var L=0;L<obj.options.columns.length;L++)obj.records[n][L]=obj.createCell(L,n,l[L]),obj.rows[n].appendChild(obj.records[n][L]);return obj.rows[n]},obj.parseValue=function(n,l,c,f){(""+c).substr(0,1)=="="&&obj.options.parseFormulas==1&&(c=obj.executeFormula(c,n,l));var L=obj.options.columns[n];if(L&&!isFormula(c)){var k=null;if(k=getMask(L)){c&&c==Number(c)&&(c=Number(c));var W=jSuites.mask.render(c,k,!0);if(f&&k.mask){var m=k.mask.split(";");m[1]&&(m[1].match(new RegExp("\\[Red\\]","gi"))&&(c<0?f.classList.add("red"):f.classList.remove("red")),m[1].match(new RegExp("\\(","gi"))&&c<0&&(W="("+W+")"))}W&&(c=W)}}return c};var validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])};obj.createCell=function(n,l,c){var f=document.createElement("td");if(f.setAttribute("data-x",n),f.setAttribute("data-y",l),(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1){var L=secureFormula(c);L!=c&&(c=L)}if(obj.options.columns[n].editor)obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=c:f.textContent=c,typeof obj.options.columns[n].editor.createCell=="function"&&(f=obj.options.columns[n].editor.createCell(f));else if(obj.options.columns[n].type=="hidden")f.style.display="none",f.textContent=c;else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){var k=document.createElement("input");k.type=obj.options.columns[n].type,k.name="c"+n,k.checked=c==1||c==1||c=="true",k.onclick=function(){obj.setValue(f,this.checked)},obj.options.columns[n].readOnly!=1&&obj.options.editable!=0||k.setAttribute("disabled","disabled"),f.appendChild(k),obj.options.data[l][n]=k.checked}else if(obj.options.columns[n].type=="calendar"){var W=null;if(!validDate(c)){var m=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);m&&(W=m)}f.textContent=jSuites.calendar.getDateString(W||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")f.classList.add("jexcel_dropdown"),f.textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="color")if(obj.options.columns[n].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=c,f.appendChild(u)}else f.style.color=c,f.textContent=c;else if(obj.options.columns[n].type=="image"){if(c&&c.substr(0,10)=="data:image"){var d=document.createElement("img");d.src=c,f.appendChild(d)}}else obj.options.columns[n].type=="html"||obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=stripScript(obj.parseValue(n,l,c,f)):f.textContent=obj.parseValue(n,l,c,f);obj.options.columns[n].readOnly==1&&(f.className="readonly");var F=obj.options.columns[n].align?obj.options.columns[n].align:"center";return f.style.textAlign=F,obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||f.innerHTML.length>200)&&(f.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(c||f.innerHTML?obj.records[l][n-1].style.overflow="hidden":n==obj.options.columns.length-1&&(f.style.overflow="hidden")),f},obj.createCellHeader=function(n){var l=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,c=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.options.stripHTML?obj.headers[n].textContent=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n):obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=c,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.headers[n].innerText),obj.options.columns[n].id&&obj.headers[n].setAttribute("id",obj.options.columns[n].id),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",l),obj.options.columns[n].type=="hidden"&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.updateNestedHeader=function(n,l,c){obj.options.nestedHeaders[l][n].title&&(obj.options.nestedHeaders[l][n].title=c,obj.options.nestedHeaders[l].element.children[n+1].textContent=c)},obj.createNestedHeader=function(n){var l=document.createElement("tr");l.classList.add("jexcel_nested");var c=document.createElement("td");l.appendChild(c),n.element=l;for(var f=0,L=0;L<n.length;L++){n[L].colspan||(n[L].colspan=1),n[L].align||(n[L].align="center"),n[L].title||(n[L].title=""),n[L].id||(n[L].id="");for(var k=n[L].colspan,W=[],m=0;m<k;m++)obj.options.columns[f]&&obj.options.columns[f].type=="hidden"&&k++,W.push(f),f++;(c=document.createElement("td")).setAttribute("data-column",W.join(",")),c.setAttribute("colspan",n[L].colspan),c.setAttribute("align",n[L].align),c.setAttribute("id",n[L].id),c.textContent=n[L].title,l.appendChild(c)}return l},obj.createToolbar=function(n){n?obj.options.toolbar=n:n=obj.options.toolbar;for(var l=0;l<n.length;l++)if(n[l].type=="i")(k=document.createElement("i")).classList.add("jexcel_toolbar_item"),k.classList.add("material-icons"),k.setAttribute("data-k",n[l].k),k.setAttribute("data-v",n[l].v),k.setAttribute("id",n[l].id),n[l].tooltip&&k.setAttribute("title",n[l].tooltip),n[l].onclick&&(n[l].onclick,1)?k.onclick=function(W){var m=W;return function(){n[m].onclick(el,obj,this)}}(l):k.onclick=function(){var W=this.getAttribute("data-k"),m=this.getAttribute("data-v");obj.setStyle(obj.highlighted,W,m)},k.textContent=n[l].content,obj.toolbar.appendChild(k);else if(n[l].type=="select"){var c=!1;(k=document.createElement("select")).classList.add("jexcel_toolbar_item"),k.setAttribute("data-k",n[l].k),n[l].tooltip&&k.setAttribute("title",n[l].tooltip),n[l].onchange&&(n[l].onchange,1)?(k.onchange=n[l].onchange,c=!0):k.onchange=function(){var W=this.getAttribute("data-k");obj.setStyle(obj.highlighted,W,this.value)};for(var f=0;f<n[l].v.length;f++){var L=document.createElement("option");L.value=n[l].v[f],L.textContent=n[l].v[f],n[l].selectedValue&&L.value===n[l].selectedValue&&(L.selected=!0),k.appendChild(L)}c&&k.dispatchEvent(new Event("change")),obj.toolbar.appendChild(k)}else if(n[l].type=="color"){var k;(k=document.createElement("i")).classList.add("jexcel_toolbar_item"),k.classList.add("material-icons"),k.setAttribute("data-k",n[l].k),k.setAttribute("data-v",""),n[l].tooltip&&k.setAttribute("title",n[l].tooltip),obj.toolbar.appendChild(k),k.textContent=n[l].content,jSuites.color(k,{onchange:function(W,m){var u=W.getAttribute("data-k");obj.setStyle(obj.highlighted,u,m)}})}},obj.setMerge=function(n,l,c,f){var L=!1;if(!n){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var k=parseInt(obj.highlighted[0].getAttribute("data-x")),W=parseInt(obj.highlighted[0].getAttribute("data-y")),m=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),u=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));n=jexcel.getColumnNameFromId([k,W]),l=m-k+1,c=u-W+1}var d=jexcel.getIdFromColumnName(n,!0);if(obj.options.mergeCells[n])obj.records[d[1]][d[0]].getAttribute("data-merged")&&(L=obj.options.text.cellAlreadyMerged);else if((!l||l<2)&&(!c||c<2))L=obj.options.text.invalidMergeProperties;else for(var F=d[1];F<d[1]+c;F++)for(var _=d[0];_<d[0]+l;_++)jexcel.getColumnNameFromId([_,F]),obj.records[F][_].getAttribute("data-merged")&&(L=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(L)alert(L);else{l>1?obj.records[d[1]][d[0]].setAttribute("colspan",l):l=1,c>1?obj.records[d[1]][d[0]].setAttribute("rowspan",c):c=1,obj.options.mergeCells[n]=[l,c,[]],obj.records[d[1]][d[0]].setAttribute("data-merged","true"),obj.records[d[1]][d[0]].style.overflow="hidden";for(var g=[],s=d[1];s<d[1]+c;s++)for(var b=d[0];b<d[0]+l;b++)d[0]==b&&d[1]==s||(g.push(obj.options.data[s][b]),obj.updateCell(b,s,"",!0),obj.options.mergeCells[n][2].push(obj.records[s][b]),obj.records[s][b].style.display="none",obj.records[s][b]=obj.records[d[1]][d[0]]);obj.updateSelection(obj.records[d[1]][d[0]]),f||(obj.setHistory({action:"setMerge",column:n,colspan:l,rowspan:c,data:g}),obj.dispatch("onmerge",el,n,l,c))}},obj.getMerge=function(n){var l={};if(n)l=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var c=Object.keys(obj.options.mergeCells),f=0;f<c.length;f++)l[c[f]]=[obj.options.mergeCells[c[f]][0],obj.options.mergeCells[c[f]][1]]}return l},obj.removeMerge=function(n,l,c){if(obj.options.mergeCells[n]){var f=jexcel.getIdFromColumnName(n,!0);obj.records[f[1]][f[0]].removeAttribute("colspan"),obj.records[f[1]][f[0]].removeAttribute("rowspan"),obj.records[f[1]][f[0]].removeAttribute("data-merged");for(var L=obj.options.mergeCells[n],k=0,W=0;W<L[1];W++)for(var m=0;m<L[0];m++)(W>0||m>0)&&(obj.records[f[1]+W][f[0]+m]=L[2][k],obj.records[f[1]+W][f[0]+m].style.display="",l&&l[k]&&obj.updateCell(f[0]+m,f[1]+W,l[k]),k++);obj.updateSelection(obj.records[f[1]][f[0]],obj.records[f[1]+W-1][f[0]+m-1]),c||delete obj.options.mergeCells[n]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var l=Object.keys(obj.options.mergeCells),c=0;c<l.length;c++)obj.removeMerge(l[c],null,n)}},obj.isColMerged=function(n,l){var c=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),L=0;L<f.length;L++){var k=jexcel.getIdFromColumnName(f[L],!0),W=obj.options.mergeCells[f[L]][0],m=k[0],u=k[0]+(W>1?W-1:0);l==null?m<=n&&u>=n&&c.push(f[L]):l?m<n&&u>=n&&c.push(f[L]):m<=n&&u>n&&c.push(f[L])}return c},obj.isRowMerged=function(n,l){var c=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),L=0;L<f.length;L++){var k=jexcel.getIdFromColumnName(f[L],!0),W=obj.options.mergeCells[f[L]][1],m=k[1],u=k[1]+(W>1?W-1:0);l==null?m<=n&&u>=n&&c.push(f[L]):l?m<n&&u>=n&&c.push(f[L]):m<=n&&u>n&&c.push(f[L])}return c},obj.openFilter=function(n){if(obj.options.filters){n=parseInt(n),obj.resetSelection();var l=[];if(obj.options.columns[n].type=="checkbox")l.push({id:"true",name:"True"}),l.push({id:"false",name:"False"});else{for(var c=[],f=!1,L=0;L<obj.options.data.length;L++){var k=obj.options.data[L][n],W=obj.records[L][n].innerHTML;k&&W?c[k]=W:f=!0}var m=Object.keys(c);for(l=[],L=0;L<m.length;L++)l.push({id:m[L],name:c[m[L]]});f&&l.push({value:"",id:"",name:"(Blanks)"})}var u=document.createElement("div");obj.filter.children[n+1].innerHTML="",obj.filter.children[n+1].appendChild(u),obj.filter.children[n+1].style.paddingLeft="0px",obj.filter.children[n+1].style.paddingRight="0px",obj.filter.children[n+1].style.overflow="initial";var d={data:l,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[n]!==void 0?obj.filters[n]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(F){obj.resetFilters(),obj.filters[n]=F.dropdown.getValue(!0),obj.filter.children[n+1].innerHTML=F.dropdown.getText(),obj.filter.children[n+1].style.paddingLeft="",obj.filter.children[n+1].style.paddingRight="",obj.filter.children[n+1].style.overflow="",obj.closeFilter(n),obj.refreshSelection()}};jSuites.dropdown(u,d)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var n=0;n<obj.filter.children.length;n++)obj.filter.children[n].innerHTML="&nbsp;",obj.filters[n]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(n){if(!n)for(var l=0;l<obj.filter.children.length;l++)obj.filters[l]&&(n=l);var c=function(k,W,m){for(var u=0;u<k.length;u++){var d=""+obj.options.data[m][W],F=""+obj.records[m][W].innerHTML;if(k[u]==d||k[u]==F)return!0}return!1},f=obj.filters[n];obj.results=[];for(var L=0;L<obj.options.data.length;L++)c(f,n,L)&&obj.results.push(L);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,l,c){var f=n.getAttribute("data-y"),L=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,L,f),L>0&&(obj.records[f][L-1].style.overflow="hidden");var k=function(T){var I=n.getBoundingClientRect(),B=document.createElement(T);return B.style.width=I.width+"px",B.style.height=I.height-2+"px",B.style.minHeight=I.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(B),obj.dispatch("oncreateeditor",el,n,L,f,B),B};if(n.classList.contains("readonly")!=1){if(obj.edition=[obj.records[f][L],obj.records[f][L].innerHTML,L,f],obj.options.columns[L].editor)obj.options.columns[L].editor.openEditor(n,el,l,c);else if(obj.options.columns[L].type!="hidden")if(obj.options.columns[L].type=="checkbox"||obj.options.columns[L].type=="radio"){var W=!n.children[0].checked;obj.setValue(n,W),obj.edition=null}else if(obj.options.columns[L].type=="dropdown"||obj.options.columns[L].type=="autocomplete"){if(W=obj.options.data[f][L],obj.options.columns[L].multiple&&!Array.isArray(W)&&(W=W.split(";")),typeof obj.options.columns[L].filter=="function")var m=obj.options.columns[L].filter(el,n,L,f,obj.options.columns[L].source);else m=obj.options.columns[L].source;for(var u=[],d=0;d<m.length;d++)u.push(m[d]);var F=k("div"),_={data:u,multiple:!!obj.options.columns[L].multiple,autocomplete:!(!obj.options.columns[L].autocomplete&&obj.options.columns[L].type!="autocomplete"),opened:!0,value:W,width:"100%",height:F.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[L].options&&obj.options.columns[L].options.type&&(_.type=obj.options.columns[L].options.type),jSuites.dropdown(F,_)}else if(obj.options.columns[L].type=="calendar"||obj.options.columns[L].type=="color")W=obj.options.data[f][L],(F=k("input")).value=W,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[L].options.position=!0),obj.options.columns[L].options.value=obj.options.data[f][L],obj.options.columns[L].options.opened=!0,obj.options.columns[L].options.onclose=function(T,I){obj.closeEditor(n,!0)},obj.options.columns[L].type=="color"?jSuites.color(F,obj.options.columns[L].options):jSuites.calendar(F,obj.options.columns[L].options),F.focus();else if(obj.options.columns[L].type=="html"){W=obj.options.data[f][L],(F=k("div")).style.position="relative",(b=document.createElement("div")).classList.add("jexcel_richtext"),F.appendChild(b),jSuites.editor(b,{focus:!0,value:W});var g=n.getBoundingClientRect(),s=b.getBoundingClientRect();window.innerHeight<g.bottom+s.height?b.style.top=g.top-(s.height+2)+"px":b.style.top=g.top+"px"}else if(obj.options.columns[L].type=="image"){var b,j=n.children[0];(F=k("div")).style.position="relative",(b=document.createElement("div")).classList.add("jclose"),j&&j.src&&b.appendChild(j),F.appendChild(b),jSuites.image(b,obj.options.imageOptions),g=n.getBoundingClientRect(),s=b.getBoundingClientRect(),window.innerHeight<g.bottom+s.height?b.style.top=g.top-(s.height+2)+"px":b.style.top=g.top+"px"}else{W=l==1?"":obj.options.data[f][L],obj.options.columns[L].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[L].wordWrap!=1?F=k("input"):F=k("textarea"),F.focus(),F.value=W,_=obj.options.columns[L];var h=null;if(!isFormula(W)&&(h=getMask(_))){if(!_.disabledMaskOnEdition)if(_.mask){var C=_.mask.split(";");F.setAttribute("data-mask",C[0])}else _.locale&&F.setAttribute("data-locale",_.locale);h.input=F,F.mask=h,jSuites.mask.render(W,h,!1)}F.onblur=function(){obj.closeEditor(n,!0)},F.scrollLeft=F.scrollWidth}}},obj.closeEditor=function(n,l){var c=parseInt(n.getAttribute("data-x")),f=parseInt(n.getAttribute("data-y"));if(l==1){if(obj.options.columns[c].editor)var L=obj.options.columns[c].editor.closeEditor(n,l);else if(!(obj.options.columns[c].type=="checkbox"||obj.options.columns[c].type=="radio"||obj.options.columns[c].type=="hidden"))if(obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete")L=n.children[0].dropdown.close(!0);else if(obj.options.columns[c].type=="calendar")L=n.children[0].calendar.close(!0);else if(obj.options.columns[c].type=="color")L=n.children[0].color.close(!0);else if(obj.options.columns[c].type=="html")L=n.children[0].children[0].editor.getData();else if(obj.options.columns[c].type=="image"){var k=n.children[0].children[0].children[0];L=k&&k.tagName=="IMG"?k.src:""}else if(obj.options.columns[c].type=="numeric")(""+(L=n.children[0].value)).substr(0,1)!="="&&L==""&&(L=obj.options.columns[c].allowEmpty?"":0),n.children[0].onblur=null;else{L=n.children[0].value,n.children[0].onblur=null;var W,m=obj.options.columns[c];if((W=getMask(m))&&L!==""&&!isFormula(L)&&typeof L!="number"){var u=jSuites.mask.extract(L,W,!0);u&&u.value!==""&&(L=u.value)}}obj.options.data[f][c]==L?n.innerHTML=obj.edition[1]:obj.setValue(n,L)}else obj.options.columns[c].editor?obj.options.columns[c].editor.closeEditor(n,l):obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete"?n.children[0].dropdown.close(!0):obj.options.columns[c].type=="calendar"?n.children[0].calendar.close(!0):obj.options.columns[c].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,n,c,f,L,l),n.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var l=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][l]},obj.getColumnOptions=function(n,l){var c=obj.options.columns[n];return c||(c={type:"text"}),c},obj.getCellFromCoords=function(n,l){return obj.records[l][n]},obj.getLabel=function(n){var l=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][l].innerHTML},obj.getLabelFromCoords=function(n,l){return obj.records[l][n].innerHTML},obj.getValue=function(n,l){if(typeof n=="object")var c=n.getAttribute("data-x"),f=n.getAttribute("data-y");else c=(n=jexcel.getIdFromColumnName(n,!0))[0],f=n[1];var L=null;return c!=null&&f!=null&&(obj.records[f]&&obj.records[f][c]&&(l||obj.options.copyCompatibility==1)?L=obj.records[f][c].innerHTML:obj.options.data[f]&&obj.options.data[f][c]!="undefined"&&(L=obj.options.data[f][c])),L},obj.getValueFromCoords=function(n,l,c){var f=null;return n!=null&&l!=null&&(obj.records[l]&&obj.records[l][n]&&c||obj.options.copyCompatibility==1?f=obj.records[l][n].innerHTML:obj.options.data[l]&&obj.options.data[l][n]!="undefined"&&(f=obj.options.data[l][n])),f},obj.setValue=function(n,l,c){var f=[];if(typeof n=="string"){var L=(u=jexcel.getIdFromColumnName(n,!0))[0],k=u[1];f.push(obj.updateCell(L,k,l,c)),obj.updateFormulaChain(L,k,f)}else if(L=null,k=null,n&&n.getAttribute&&(L=n.getAttribute("data-x"),k=n.getAttribute("data-y")),L!=null&&k!=null)f.push(obj.updateCell(L,k,l,c)),obj.updateFormulaChain(L,k,f);else{var W=Object.keys(n);if(W.length>0)for(var m=0;m<W.length;m++){var u;typeof n[m]=="string"?(L=(u=jexcel.getIdFromColumnName(n[m],!0))[0],k=u[1]):n[m].x!=null&&n[m].y!=null?(L=n[m].x,k=n[m].y,n[m].newValue!=null?l=n[m].newValue:n[m].value!=null&&(l=n[m].value)):(L=n[m].getAttribute("data-x"),k=n[m].getAttribute("data-y")),L!=null&&k!=null&&(f.push(obj.updateCell(L,k,l,c)),obj.updateFormulaChain(L,k,f))}}obj.setHistory({action:"setValue",records:f,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,f)},obj.setValueFromCoords=function(n,l,c,f){var L=[];L.push(obj.updateCell(n,l,c,f)),obj.updateFormulaChain(n,l,L),obj.setHistory({action:"setValue",records:L,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,L)},obj.setCheckRadioValue=function(){for(var n=[],l=Object.keys(obj.highlighted),c=0;c<l.length;c++){var f=obj.highlighted[c].getAttribute("data-x"),L=obj.highlighted[c].getAttribute("data-y");obj.options.columns[f].type!="checkbox"&&obj.options.columns[f].type!="radio"||n.push(obj.updateCell(f,L,!obj.options.data[L][f]))}n.length&&(obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.onafterchanges(el,n))};var stripScript=function(n){var l=new Option;l.innerHTML=n;var c=null;for(n=l.getElementsByTagName("script");c=n[0];)c.parentNode.removeChild(c);return l.innerHTML};obj.updateCell=function(n,l,c,f){if(obj.records[l][n].classList.contains("readonly")!=1||f){var L;(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1&&(L=secureFormula(c))!=c&&(c=L),(L=obj.dispatch("onbeforechange",el,obj.records[l][n],n,l,c))!=null&&(c=L),obj.options.columns[n].editor&&typeof obj.options.columns[n].editor.updateCell=="function"&&(c=obj.options.columns[n].editor.updateCell(obj.records[l][n],c,f)),F={x:n,y:l,col:n,row:l,newValue:c,oldValue:obj.options.data[l][n]};let _=obj.options.columns[n].editor;if(_)obj.options.data[l][n]=c,typeof _.setValue=="function"&&_.setValue(obj.records[l][n],c);else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){if(obj.options.columns[n].type=="radio")for(var k=0;k<obj.options.data.length;k++)obj.options.data[k][n]=!1;obj.records[l][n].children[0].checked=c==1||c==1||c=="true"||c=="TRUE",obj.options.data[l][n]=obj.records[l][n].children[0].checked}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")obj.options.data[l][n]=c,obj.records[l][n].textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="calendar"){var W=null;if(!validDate(c)){var m=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);m&&(W=m)}obj.options.data[l][n]=c,obj.records[l][n].textContent=jSuites.calendar.getDateString(W||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="color")if(obj.options.data[l][n]=c,obj.options.columns[n].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=c,obj.records[l][n].textContent="",obj.records[l][n].appendChild(u)}else obj.records[l][n].style.color=c,obj.records[l][n].textContent=c;else if(obj.options.columns[n].type=="image"){if(c=""+c,obj.options.data[l][n]=c,obj.records[l][n].innerHTML="",c&&c.substr(0,10)=="data:image"){var d=document.createElement("img");d.src=c,obj.records[l][n].appendChild(d)}}else obj.options.data[l][n]=c,obj.options.columns[n].type=="html"?obj.records[l][n].innerHTML=stripScript(obj.parseValue(n,l,c)):obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?obj.records[l][n].innerHTML=stripScript(obj.parseValue(n,l,c,obj.records[l][n])):obj.records[l][n].textContent=obj.parseValue(n,l,c,obj.records[l][n]),obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||obj.records[l][n].innerHTML.length>200)?obj.records[l][n].style.whiteSpace="pre-wrap":obj.records[l][n].style.whiteSpace="";n>0&&(obj.records[l][n-1].style.overflow=c?"hidden":""),obj.dispatch("onchange",el,obj.records[l]&&obj.records[l][n]?obj.records[l][n]:null,n,l,c,F.oldValue)}else var F={x:n,y:l,col:n,row:l};return F},obj.copyData=function(n,l){var c=obj.getData(!0,!0),f=obj.selectedContainer,L=parseInt(n.getAttribute("data-x")),k=parseInt(n.getAttribute("data-y")),W=parseInt(l.getAttribute("data-x")),m=parseInt(l.getAttribute("data-y")),u=[],d=!1;if(f[0]==L){if(k<f[1])var F=k-f[1];else F=1;var _=0}else _=L<f[0]?L-f[0]:1,F=0;for(var g=0,s=0,b=k;b<=m;b++)if(!obj.rows[b]||obj.rows[b].style.display!="none"){c[s]==null&&(s=0),g=0,f[0]!=L&&(_=L<f[0]?L-f[0]:1);for(var j=L;j<=W;j++){if(obj.records[b][j]&&!obj.records[b][j].classList.contains("readonly")&&obj.records[b][j].style.display!="none"&&d==0){if(!obj.selection.length&&obj.options.data[b][j]!=""){d=!0;continue}(c[s]==null||c[s][g]==null)&&(g=0);var h=c[s][g];if(h&&!c[1]&&obj.options.autoIncrement==1){if(obj.options.columns[j].type=="text"||obj.options.columns[j].type=="number")if((""+h).substr(0,1)=="="){var C=h.match(/([A-Z]+[0-9]+)/g);if(C){for(var T=[],I=0;I<C.length;I++){var B=jexcel.getIdFromColumnName(C[I],1);B[0]+=_,B[1]+=F,B[1]<0&&(B[1]=0);var O=jexcel.getColumnNameFromId([B[0],B[1]]);O!=C[I]&&(T[C[I]]=O)}T&&(h=obj.updateFormula(h,T))}}else h==Number(h)&&(h=Number(h)+F);else if(obj.options.columns[j].type=="calendar"){var A=new Date(h);A.setDate(A.getDate()+F),h=A.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(A.getMonth()+1))+"-"+jexcel.doubleDigitFormat(A.getDate())+" 00:00:00"}}u.push(obj.updateCell(j,b,h)),obj.updateFormulaChain(j,b,u)}g++,f[0]!=L&&_++}s++,F++}obj.setHistory({action:"setValue",records:u,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,u)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,l,c){if(n==1){if(obj.selectedCell&&(l>=obj.selectedCell[1]&&l<=obj.selectedCell[3]||c>=obj.selectedCell[1]&&c<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(l>=obj.selectedCell[0]&&l<=obj.selectedCell[2]||c>=obj.selectedCell[0]&&c<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(n){if(obj.highlighted.length){d=1;for(var l=0;l<obj.highlighted.length;l++){obj.highlighted[l].classList.remove("highlight"),obj.highlighted[l].classList.remove("highlight-left"),obj.highlighted[l].classList.remove("highlight-right"),obj.highlighted[l].classList.remove("highlight-top"),obj.highlighted[l].classList.remove("highlight-bottom"),obj.highlighted[l].classList.remove("highlight-selected");var c=parseInt(obj.highlighted[l].getAttribute("data-x")),f=parseInt(obj.highlighted[l].getAttribute("data-y"));if(obj.highlighted[l].getAttribute("data-merged"))var L=parseInt(obj.highlighted[l].getAttribute("colspan")),k=parseInt(obj.highlighted[l].getAttribute("rowspan")),W=L>0?c+(L-1):c,m=k>0?f+(k-1):f;else W=c,m=f;for(var u=c;u<=W;u++)obj.headers[u]&&obj.headers[u].classList.remove("selected");for(u=f;u<=m;u++)obj.rows[u]&&obj.rows[u].classList.remove("selected")}}else var d=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",n==1&&d==1&&obj.dispatch("onblur",el),d},obj.updateSelection=function(n,l,c){var f=n.getAttribute("data-x"),L=n.getAttribute("data-y");if(l)var k=l.getAttribute("data-x"),W=l.getAttribute("data-y");else k=f,W=L;obj.updateSelectionFromCoords(f,L,k,W,c)},obj.updateSelectionFromCoords=function(n,l,c,f,L){var k=obj.resetSelection();if(l==null&&(l=0,f=obj.rows.length-1),c==null&&(c=n),f==null&&(f=l),n>=obj.headers.length&&(n=obj.headers.length-1),l>=obj.rows.length&&(l=obj.rows.length-1),c>=obj.headers.length&&(c=obj.headers.length-1),f>=obj.rows.length&&(f=obj.rows.length-1),obj.selectedCell=[n,l,c,f],n!=null){if(obj.records[l][n]&&obj.records[l][n].classList.add("highlight-selected"),parseInt(n)<parseInt(c))var W=parseInt(n),m=parseInt(c);else W=parseInt(c),m=parseInt(n);if(parseInt(l)<parseInt(f))var u=parseInt(l),d=parseInt(f);else u=parseInt(f),d=parseInt(l);for(var F=W;F<=m;F++)for(var _=u;_<=d;_++)if(obj.records[_][F]&&obj.records[_][F].getAttribute("data-merged")){var g=parseInt(obj.records[_][F].getAttribute("data-x")),s=parseInt(obj.records[_][F].getAttribute("data-y")),b=parseInt(obj.records[_][F].getAttribute("colspan")),j=parseInt(obj.records[_][F].getAttribute("rowspan"));b>1&&(g<W&&(W=g),g+b>m&&(m=g+b-1)),j&&(s<u&&(u=s),s+j>d&&(d=s+j-1))}var h=null,C=null,T=null,I=null;for(_=u;_<=d;_++)obj.rows[_].style.display!="none"&&(T==null&&(T=_),I=_);for(F=W;F<=m;F++){for(_=u;_<=d;_++)obj.rows[_].style.display!="none"&&obj.records[_][F].style.display!="none"&&(obj.records[_][F].classList.add("highlight"),obj.highlighted.push(obj.records[_][F]));obj.options.columns[F].type!="hidden"&&(h==null&&(h=F),C=F)}for(h||(h=0),C||(C=0),F=h;F<=C;F++)obj.options.columns[F].type!="hidden"&&obj.colgroup[F].style&&obj.colgroup[F].style.display!="none"&&(obj.records[T]&&obj.records[T][F]&&obj.records[T][F].classList.add("highlight-top"),obj.records[I]&&obj.records[I][F]&&obj.records[I][F].classList.add("highlight-bottom"),obj.headers[F].classList.add("selected"));for(_=T;_<=I;_++)obj.rows[_]&&obj.rows[_].style.display!="none"&&(obj.records[_][h].classList.add("highlight-left"),obj.records[_][C].classList.add("highlight-right"),obj.rows[_].classList.add("selected"));obj.selectedContainer=[h,T,C,I]}k==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,h,T,C,I,L),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var n=0;n<obj.selection.length;n++)obj.selection[n].classList.remove("selection"),obj.selection[n].classList.remove("selection-left"),obj.selection[n].classList.remove("selection-right"),obj.selection[n].classList.remove("selection-top"),obj.selection[n].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(n,l){obj.removeCopySelection();var c=obj.selectedContainer[0],f=obj.selectedContainer[1],L=obj.selectedContainer[2],k=obj.selectedContainer[3];if(n!=null&&l!=null){if(n-L>0)var W=parseInt(L)+1,m=parseInt(n);else W=parseInt(n),m=parseInt(c)-1;if(l-k>0)var u=parseInt(k)+1,d=parseInt(l);else u=parseInt(l),d=parseInt(f)-1;m-W<=d-u?(W=parseInt(c),m=parseInt(L)):(u=parseInt(f),d=parseInt(k));for(var F=u;F<=d;F++)for(var _=W;_<=m;_++)obj.records[F][_]&&obj.rows[F].style.display!="none"&&obj.records[F][_].style.display!="none"&&(obj.records[F][_].classList.add("selection"),obj.records[u][_].classList.add("selection-top"),obj.records[d][_].classList.add("selection-bottom"),obj.records[F][W].classList.add("selection-left"),obj.records[F][m].classList.add("selection-right"),obj.selection.push(obj.records[F][_]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var n=obj.highlighted[obj.highlighted.length-1],l=n.getAttribute("data-x"),c=obj.content.getBoundingClientRect(),f=c.left,L=c.top,k=n.getBoundingClientRect(),W=k.left,m=k.top,u=k.width,d=k.height,F=W-f+obj.content.scrollLeft+u-4,_=m-L+obj.content.scrollTop+d-4;if(obj.corner.style.top=_+"px",obj.corner.style.left=F+"px",obj.options.freezeColumns){var g=obj.getFreezeWidth();l>obj.options.freezeColumns-1&&W-f+u<g?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(n){var l=obj.content.getBoundingClientRect(),c=l.left,f=l.top,L=l.width,k=l.height,W=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),m=W.left,u=W.top,d=W.width,F=W.height;if(n==0||n==1)var _=m-c+obj.content.scrollLeft,g=u-f+obj.content.scrollTop-2;else _=m-c+obj.content.scrollLeft+d,g=u-f+obj.content.scrollTop+F;g>obj.content.scrollTop+30&&g<obj.content.scrollTop+k||(g<obj.content.scrollTop+30?obj.content.scrollTop=g-F:obj.content.scrollTop=g-(k-2));var s=obj.getFreezeWidth();_>obj.content.scrollLeft+s&&_<obj.content.scrollLeft+L||(_<obj.content.scrollLeft+30?(obj.content.scrollLeft=_,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):_<obj.content.scrollLeft+s?obj.content.scrollLeft=_-s-1:obj.content.scrollLeft=_-(L-20))},obj.getWidth=function(n){if(n===void 0)for(var l=[],c=0;c<obj.headers.length;c++)l.push(obj.options.columns[c].width);else typeof n=="object"&&(n=n.getAttribute("data-x")),l=obj.colgroup[n].getAttribute("width");return l},obj.setWidth=function(n,l,c){if(l){if(Array.isArray(n)){c||(c=[]);for(var f=0;f<n.length;f++){c[f]||(c[f]=obj.colgroup[n[f]].getAttribute("width"));var L=Array.isArray(l)&&l[f]?l[f]:l;obj.colgroup[n[f]].setAttribute("width",L),obj.options.columns[n[f]].width=L}}else c||(c=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",l),obj.options.columns[n].width=l;obj.setHistory({action:"setWidth",column:n,oldValue:c,newValue:l}),obj.dispatch("onresizecolumn",el,n,l,c),obj.updateCornerPosition()}},obj.setHeight=function(n,l,c){l>0&&(typeof n=="object"&&(n=n.getAttribute("data-y")),c||(c=obj.rows[n].getAttribute("height"))||(c=obj.rows[n].getBoundingClientRect().height),l=parseInt(l),obj.rows[n].style.height=l+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=l,obj.setHistory({action:"setHeight",row:n,oldValue:c,newValue:l}),obj.dispatch("onresizerow",el,n,l,c),obj.updateCornerPosition())},obj.getHeight=function(n){if(n===void 0)for(var l=[],c=0;c<obj.rows.length;c++){var f=obj.rows[c].style.height;f&&(l[c]=f)}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),l=obj.rows[n].style.height;return l},obj.setFooter=function(n){if(n&&(obj.options.footers=n),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var l=0;l<obj.options.footers.length;l++){if(obj.tfoot.children[l])var c=obj.tfoot.children[l];else{c=document.createElement("tr");var f=document.createElement("td");c.appendChild(f),obj.tfoot.appendChild(c)}for(var L=0;L<obj.headers.length;L++){if(obj.options.footers[l][L]||(obj.options.footers[l][L]=""),obj.tfoot.children[l].children[L+1])f=obj.tfoot.children[l].children[L+1];else{f=document.createElement("td"),c.appendChild(f);var k=obj.options.columns[L].align?obj.options.columns[L].align:"center";f.style.textAlign=k}f.textContent=obj.parseValue(+obj.records.length+L,l,obj.options.footers[l][L]),f.style.display=obj.colgroup[L].style.display}}}},obj.getHeader=function(n){return obj.headers[n].textContent},obj.setHeader=function(n,l){if(obj.headers[n]){var c=obj.headers[n].textContent;l||(l=prompt(obj.options.text.columnName,c)),l&&(obj.headers[n].textContent=l,obj.headers[n].setAttribute("title",l),obj.options.columns[n].title=l),obj.setHistory({action:"setHeader",column:n,oldValue:c,newValue:l}),obj.dispatch("onchangeheader",el,n,c,l)}},obj.getHeaders=function(n){for(var l=[],c=0;c<obj.headers.length;c++)l.push(obj.getHeader(c));return n?l:l.join(obj.options.csvDelimiter)},obj.getMeta=function(n,l){return n?l?obj.options.meta[n]&&obj.options.meta[n][l]?obj.options.meta[n][l]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(n,l,c){if(obj.options.meta||(obj.options.meta={}),l&&c)obj.options.meta[n]||(obj.options.meta[n]={}),obj.options.meta[n][l]=c;else for(var f=Object.keys(n),L=0;L<f.length;L++){obj.options.meta[f[L]]||(obj.options.meta[f[L]]={});for(var k=Object.keys(n[f[L]]),W=0;W<k.length;W++)obj.options.meta[f[L]][k[W]]=n[f[L]][k[W]]}obj.dispatch("onchangemeta",el,n,l,c)},obj.updateMeta=function(n){if(obj.options.meta){for(var l={},c=Object.keys(obj.options.meta),f=0;f<c.length;f++)n[c[f]]?l[n[c[f]]]=obj.options.meta[c[f]]:l[c[f]]=obj.options.meta[c[f]];obj.options.meta=l}},obj.getStyle=function(n,l){if(n)return n=jexcel.getIdFromColumnName(n,!0),l?obj.records[n[1]][n[0]].style[l]:obj.records[n[1]][n[0]].getAttribute("style");for(var c={},f=obj.options.data[0].length,L=obj.options.data.length,k=0;k<L;k++)for(var W=0;W<f;W++){var m=l?obj.records[k][W].style[l]:obj.records[k][W].getAttribute("style");m&&(c[jexcel.getColumnNameFromId([W,k])]=m)}return c},obj.resetStyle=function(n,l){for(var c=Object.keys(n),f=0;f<c.length;f++){var L=jexcel.getIdFromColumnName(c[f],!0);obj.records[L[1]]&&obj.records[L[1]][L[0]]&&obj.records[L[1]][L[0]].setAttribute("style","")}obj.setStyle(n,null,null,null,l)},obj.setStyle=function(n,l,c,f,L){var k={},W={},m=function(h,C,T){var I=jexcel.getIdFromColumnName(h,!0);if(obj.records[I[1]]&&obj.records[I[1]][I[0]]&&(obj.records[I[1]][I[0]].classList.contains("readonly")==0||f)){var B=obj.records[I[1]][I[0]].style[C];B!=T||f?obj.records[I[1]][I[0]].style[C]=T:(T="",obj.records[I[1]][I[0]].style[C]=""),W[h]||(W[h]=[]),k[h]||(k[h]=[]),W[h].push([C+":"+B]),k[h].push([C+":"+T])}};if(l&&c)if(typeof n=="string")m(n,l,c);else for(var u=[],d=0;d<n.length;d++){var F=n[d].getAttribute("data-x"),_=n[d].getAttribute("data-y"),g=jexcel.getColumnNameFromId([F,_]);u[g]||(m(g,l,c),u[g]=!0)}else{var s=Object.keys(n);for(d=0;d<s.length;d++){var b=n[s[d]];typeof b=="string"&&(b=b.split(";"));for(var j=0;j<b.length;j++)typeof b[j]=="string"&&(b[j]=b[j].split(":")),b[j][0].trim()&&m(s[d],b[j][0].trim(),b[j][1])}}for(s=Object.keys(W),d=0;d<s.length;d++)W[s[d]]=W[s[d]].join(";");for(s=Object.keys(k),d=0;d<s.length;d++)k[s[d]]=k[s[d]].join(";");L||obj.setHistory({action:"setStyle",oldValue:W,newValue:k}),obj.dispatch("onchangestyle",el,n,l,c)},obj.getComments=function(n,l){if(n)return typeof n=="string"&&(n=jexcel.getIdFromColumnName(n,!0)),l?[obj.records[n[1]][n[0]].getAttribute("title"),obj.records[n[1]][n[0]].getAttribute("author")]:obj.records[n[1]][n[0]].getAttribute("title")||"";for(var c={},f=0;f<obj.options.data.length;f++)for(var L=0;L<obj.options.columns.length;L++){var k=obj.records[f][L].getAttribute("title");k&&(c[n=jexcel.getColumnNameFromId([L,f])]=k)}return c},obj.setComments=function(n,l,c){if(typeof n=="string")var f=jexcel.getIdFromColumnName(n,!0);else f=n;var L=obj.records[f[1]][f[0]].getAttribute("title"),k=[L,c=obj.records[f[1]][f[0]].getAttribute("data-author")];obj.records[f[1]][f[0]].setAttribute("title",l||""),obj.records[f[1]][f[0]].setAttribute("data-author",c||""),l?obj.records[f[1]][f[0]].classList.add("jexcel_comments"):obj.records[f[1]][f[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:n,newValue:[l,c],oldValue:k}),obj.dispatch("oncomments",el,l,L,f,f[0],f[1])},obj.getConfig=function(){var n=obj.options;return n.style=obj.getStyle(),n.mergeCells=obj.getMerge(),n.comments=obj.getComments(),n},obj.orderBy=function(n,l){if(n>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}l=l==null?obj.headers[n].classList.contains("arrow-down")?1:0:l?1:0;var c=[];if(obj.options.columns[n].type=="number"||obj.options.columns[n].type=="numeric"||obj.options.columns[n].type=="percentage"||obj.options.columns[n].type=="autonumber"||obj.options.columns[n].type=="color")for(var f=0;f<obj.options.data.length;f++)c[f]=[f,Number(obj.options.data[f][n])];else if(obj.options.columns[n].type=="calendar"||obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio")for(f=0;f<obj.options.data.length;f++)c[f]=[f,obj.options.data[f][n]];else for(f=0;f<obj.options.data.length;f++)c[f]=[f,obj.records[f][n].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(k){return function(W,m){var u=W[1],d=m[1];return k?u===""&&d!==""?1:u!==""&&d===""||u>d?-1:u<d?1:0:u===""&&d!==""?1:u!==""&&d===""?-1:u>d?1:u<d?-1:0}}),c=c.sort(obj.options.sorting(l));var L=[];for(f=0;f<c.length;f++)L[f]=c[f][0];return obj.setHistory({action:"orderBy",rows:L,column:n,order:l}),obj.updateOrderArrow(n,l),obj.updateOrder(L),obj.dispatch("onsort",el,n,l),!0}},obj.updateOrderArrow=function(n,l){for(var c=0;c<obj.headers.length;c++)obj.headers[c].classList.remove("arrow-up"),obj.headers[c].classList.remove("arrow-down");l?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var l=[],c=0;c<n.length;c++)l[c]=obj.options.data[n[c]];for(obj.options.data=l,l=[],c=0;c<n.length;c++)l[c]=obj.records[n[c]];for(obj.records=l,l=[],c=0;c<n.length;c++)l[c]=obj.rows[n[c]];if(obj.rows=l,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(c=0;c<obj.rows.length;c++)obj.tbody.appendChild(obj.rows[c])},obj.moveRow=function(n,l,c){if(Object.keys(obj.options.mergeCells).length>0){if(n>l)var f=1;else f=0;if(obj.isRowMerged(n).length||obj.isRowMerged(l,f).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}c||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[l])>=0?n>l?obj.tbody.insertBefore(obj.rows[n],obj.rows[l]):obj.tbody.insertBefore(obj.rows[n],obj.rows[l].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(l,0,obj.rows.splice(n,1)[0]),obj.records.splice(l,0,obj.records.splice(n,1)[0]),obj.options.data.splice(l,0,obj.options.data.splice(n,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:l}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,n,l)},obj.insertRow=function(n,l,c){if(obj.options.allowInsertRow==1){var f=[];if(n>0)var L=n;else L=1,n&&(f=n);c=!!c;var k=obj.options.data.length-1;if((l==null||l>=parseInt(k)||l<0)&&(l=k),obj.dispatch("onbeforeinsertrow",el,l,L,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(l,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var W=c?l:l+1,m=obj.records.splice(W),u=obj.options.data.splice(W),d=obj.rows.splice(W),F=[],_=[],g=[],s=W;s<L+W;s++){obj.options.data[s]=[];for(var b=0;b<obj.options.columns.length;b++)obj.options.data[s][b]=f[b]?f[b]:"";var j=obj.createRow(s,obj.options.data[s]);d[0]?Array.prototype.indexOf.call(obj.tbody.children,d[0])>=0&&obj.tbody.insertBefore(j,d[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[l])>=0&&obj.tbody.appendChild(j),F.push(obj.records[s]),_.push(obj.options.data[s]),g.push(j)}Array.prototype.push.apply(obj.records,m),Array.prototype.push.apply(obj.options.data,u),Array.prototype.push.apply(obj.rows,d),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:l,numOfRows:L,insertBefore:c,rowRecords:F,rowData:_,rowNode:g}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,l,L,F,c)}},obj.deleteRow=function(n,l){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(n==null){var c=obj.getSelectedRows();c[0]?(n=parseInt(c[0].getAttribute("data-y")),l=c.length):(n=obj.options.data.length-1,l=1)}var f=obj.options.data.length-1;if((n==null||n>f||n<0)&&(n=f),l||(l=1),n+l>=obj.options.data.length&&(l=obj.options.data.length-n),obj.dispatch("onbeforedeleterow",el,n,l)===!1)return!1;if(parseInt(n)>-1){var L=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var k=n;k<n+l;k++)obj.isRowMerged(k,!1).length&&(L=!0);if(L){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&f+1===l&&(l--,console.error("Jspreadsheet: It is not possible to delete the last row")),k=n;k<n+l;k++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[k])>=0&&(obj.rows[k].className="",obj.rows[k].parentNode.removeChild(obj.rows[k]));var W=obj.records.splice(n,l),m=obj.options.data.splice(n,l),u=obj.rows.splice(n,l);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,n,n+l-1),obj.setHistory({action:"deleteRow",rowNumber:n,numOfRows:l,insertBefore:1,rowRecords:W,rowData:m,rowNode:u}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,n,l,W)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(n,l){if(Object.keys(obj.options.mergeCells).length>0){if(n>l)var c=1;else c=0;if(obj.isColMerged(n).length||obj.isColMerged(l,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(l=parseInt(l))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[l]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[l]);for(var f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][l])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[l].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[l].nextSibling),f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][l].nextSibling);for(obj.options.columns.splice(l,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(l,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(l,0,obj.colgroup.splice(n,1)[0]),f=0;f<obj.rows.length;f++)obj.options.data[f].splice(l,0,obj.options.data[f].splice(n,1)[0]),obj.records[f].splice(l,0,obj.records[f].splice(n,1)[0]);if(obj.options.footers)for(f=0;f<obj.options.footers.length;f++)obj.options.footers[f].splice(l,0,obj.options.footers[f].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:l}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,n,l)},obj.insertColumn=function(n,l,c,f){if(obj.options.allowInsertColumn==1){var L=[];if(n>0)var k=n;else k=1,n&&(L=n);c=!!c;var W=obj.options.columns.length-1;if((l==null||l>=parseInt(W)||l<0)&&(l=W),obj.dispatch("onbeforeinsertcolumn",el,l,k,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(l,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}f||(f=[]);for(var m=0;m<k;m++)f[m]||(f[m]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var u=c?l:l+1;obj.options.columns=jexcel.injectArray(obj.options.columns,u,f);for(var d=obj.headers.splice(u),F=obj.colgroup.splice(u),_=[],g=[],s=[],b=[],j=[],h=u;h<k+u;h++)obj.createCellHeader(h),obj.headerContainer.insertBefore(obj.headers[h],obj.headerContainer.children[h+1]),obj.colgroupContainer.insertBefore(obj.colgroup[h],obj.colgroupContainer.children[h+1]),_.push(obj.headers[h]),g.push(obj.colgroup[h]);if(obj.options.footers)for(var C=0;C<obj.options.footers.length;C++){for(j[C]=[],m=0;m<k;m++)j[C].push("");obj.options.footers[C].splice(u,0,j[C])}for(var T=0;T<obj.options.data.length;T++){var I=obj.options.data[T].splice(u),B=obj.records[T].splice(u);for(b[T]=[],s[T]=[],h=u;h<k+u;h++){var O=L[T]?L[T]:"";obj.options.data[T][h]=O;var A=obj.createCell(h,T,obj.options.data[T][h]);obj.records[T][h]=A,obj.rows[T]&&obj.rows[T].insertBefore(A,obj.rows[T].children[h+1]),b[T].push(O),s[T].push(A)}Array.prototype.push.apply(obj.options.data[T],I),Array.prototype.push.apply(obj.records[T],B)}if(Array.prototype.push.apply(obj.headers,d),Array.prototype.push.apply(obj.colgroup,F),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(C=0;C<obj.options.nestedHeaders.length;C++){var R=parseInt(obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan)+k;obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan=R,obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("colspan",R);var Z=obj.thead.children[C].children[obj.thead.children[C].children.length-1].getAttribute("data-column");for(Z=Z.split(","),h=u;h<k+u;h++)Z.push(h);obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("data-column",Z)}else R=parseInt(obj.options.nestedHeaders[0].colspan)+k,obj.options.nestedHeaders[0].colspan=R,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",R);obj.setHistory({action:"insertColumn",columnNumber:l,numOfColumns:k,insertBefore:c,columns:f,headers:_,colgroup:g,records:s,footers:j,data:b}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,l,k,s,c)}},obj.deleteColumn=function(n,l){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(n==null){var c=obj.getSelectedColumns(!0);c.length?(n=parseInt(c[0]),l=parseInt(c.length)):(n=obj.headers.length-1,l=1)}var f=obj.options.data[0].length-1;if((n==null||n>f||n<0)&&(n=f),l||(l=1),l>obj.options.data[0].length-n&&(l=obj.options.data[0].length-n),obj.dispatch("onbeforedeletecolumn",el,n,l)===!1)return!1;if(parseInt(n)>-1){var L=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var k=n;k<n+l;k++)obj.isColMerged(k,!1).length&&(L=!0);if(L){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var W=obj.options.columns.splice(n,l);for(k=n;k<n+l;k++)obj.colgroup[k].className="",obj.headers[k].className="",obj.colgroup[k].parentNode.removeChild(obj.colgroup[k]),obj.headers[k].parentNode.removeChild(obj.headers[k]);for(var m=obj.headers.splice(n,l),u=obj.colgroup.splice(n,l),d=[],F=[],_=[],g=0;g<obj.options.data.length;g++)for(k=n;k<n+l;k++)obj.records[g][k].className="",obj.records[g][k].parentNode.removeChild(obj.records[g][k]);for(g=0;g<obj.options.data.length;g++)F[g]=obj.options.data[g].splice(n,l),d[g]=obj.records[g].splice(n,l);if(obj.options.footers)for(g=0;g<obj.options.footers.length;g++)_[g]=obj.options.footers[g].splice(n,l);if(obj.conditionalSelectionUpdate(0,n,n+l-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var s=0;s<obj.options.nestedHeaders.length;s++){var b=parseInt(obj.options.nestedHeaders[s][obj.options.nestedHeaders[s].length-1].colspan)-l;obj.options.nestedHeaders[s][obj.options.nestedHeaders[s].length-1].colspan=b,obj.thead.children[s].children[obj.thead.children[s].children.length-1].setAttribute("colspan",b)}else b=parseInt(obj.options.nestedHeaders[0].colspan)-l,obj.options.nestedHeaders[0].colspan=b,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",b);obj.setHistory({action:"deleteColumn",columnNumber:n,numOfColumns:l,insertBefore:1,columns:W,headers:m,colgroup:u,records:d,footers:_,data:F}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,n,l,d)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var l=[],c=0;c<obj.rows.length;c++)obj.rows[c].classList.contains("selected")&&(n?l.push(c):l.push(obj.rows[c]));return l},obj.getSelectedColumns=function(){for(var n=[],l=0;l<obj.headers.length;l++)obj.headers[l].classList.contains("selected")&&n.push(l);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var n=0;n<obj.headers.length;n++)(k=obj.headers[n].getAttribute("data-x"))!=n&&(obj.headers[n].setAttribute("data-x",n),obj.headers[n].getAttribute("title")||(obj.headers[n].innerHTML=jexcel.getColumnName(n)));for(var l=0;l<obj.rows.length;l++)obj.rows[l]&&(W=obj.rows[l].getAttribute("data-y"))!=l&&(obj.rows[l].setAttribute("data-y",l),obj.rows[l].children[0].setAttribute("data-y",l),obj.rows[l].children[0].innerHTML=l+1);var c=[],f=[],L=function(s,b,j,h){if(s!=j&&obj.records[h][j].setAttribute("data-x",j),b!=h&&obj.records[h][j].setAttribute("data-y",h),s!=j||b!=h){var C=jexcel.getColumnNameFromId([s,b]),T=jexcel.getColumnNameFromId([j,h]);c[C]=T}};for(l=0;l<obj.records.length;l++)for(n=0;n<obj.records[0].length;n++)if(obj.records[l][n]){var k=obj.records[l][n].getAttribute("data-x"),W=obj.records[l][n].getAttribute("data-y");if(obj.records[l][n].getAttribute("data-merged")){var m=jexcel.getColumnNameFromId([k,W]),u=jexcel.getColumnNameFromId([n,l]);if(f[m]==null)if(m==u)f[m]=!1;else{var d=parseInt(n-k),F=parseInt(l-W);f[m]=[u,d,F]}}else L(k,W,n,l)}var _=Object.keys(f);if(_.length){for(n=0;n<_.length;n++)if(f[_[n]]){var g=jexcel.getIdFromColumnName(_[n],!0);for(L(k=g[0],W=g[1],k+f[_[n]][1],W+f[_[n]][2]),m=_[n],u=f[_[n]][0],l=0;l<obj.options.mergeCells[m][2].length;l++)k=parseInt(obj.options.mergeCells[m][2][l].getAttribute("data-x")),W=parseInt(obj.options.mergeCells[m][2][l].getAttribute("data-y")),obj.options.mergeCells[m][2][l].setAttribute("data-x",k+f[_[n]][1]),obj.options.mergeCells[m][2][l].setAttribute("data-y",W+f[_[n]][2]);obj.options.mergeCells[u]=obj.options.mergeCells[m],delete obj.options.mergeCells[m]}}obj.updateFormulas(c),obj.updateMeta(c),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var n=0,l=obj.rows.length-1;l>=0;l--){for(var c=!1,f=0;f<obj.headers.length;f++)obj.options.data[l][f]&&(c=!0);if(c)break;n++}obj.options.minSpareRows-n>0&&obj.insertRow(obj.options.minSpareRows-n)}if(obj.options.minSpareCols>0){var L=0;for(f=obj.headers.length-1;f>=0;f--){for(c=!1,l=0;l<obj.rows.length;l++)obj.options.data[l][f]&&(c=!0);if(c)break;L++}obj.options.minSpareCols-L>0&&obj.insertColumn(obj.options.minSpareCols-L)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),l=0;l<obj.rows.length;l++)for(f=0;f<obj.headers.length;f++)obj.options.updateTable(el,obj.records[l][f],f,l,obj.options.data[l][f],obj.records[l][f].textContent,jexcel.getColumnNameFromId([f,l]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(n){if(n=obj.getCell(n))return!!n.classList.contains("readonly")},obj.setReadOnly=function(n,l){(n=obj.getCell(n))&&(l?n.classList.add("readonly"):n.classList.remove("readonly"))},obj.showRow=function(n){obj.rows[n].style.display=""},obj.hideRow=function(n){obj.rows[n].style.display="none"},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="");for(var l=0;l<obj.options.data.length;l++)obj.records[l][n].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="none");for(var l=0;l<obj.options.data.length;l++)obj.records[l][n].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(n,l,c){var f=jexcel.getColumnNameFromId([n,l]);if(obj.formula[f]&&obj.formula[f].length>0)if(chainLoopProtection[f])obj.records[l][n].innerHTML="#ERROR",obj.formula[f]="";else{chainLoopProtection[f]=!0;for(var L=0;L<obj.formula[f].length;L++){var k=jexcel.getIdFromColumnName(obj.formula[f][L],!0),W=""+obj.options.data[k[1]][k[0]];W.substr(0,1)=="="?c.push(obj.updateCell(k[0],k[1],W,!0)):Object.keys(obj.formula)[L]=null,obj.updateFormulaChain(k[0],k[1],c)}}chainLoopProtection=[]},obj.updateFormulas=function(n){for(var l=0;l<obj.options.data.length;l++)for(var c=0;c<obj.options.data[0].length;c++)if((m=""+obj.options.data[l][c]).substr(0,1)=="="){var f=obj.updateFormula(m,n);f!=m&&(obj.options.data[l][c]=f)}var L=[],k=Object.keys(obj.formula);for(l=0;l<k.length;l++){var W=k[l],m=obj.formula[W];for(n[W]&&(W=n[W]),L[W]=[],c=0;c<m.length;c++){var u=m[c];n[u]&&(u=n[u]),L[W].push(u)}}obj.formula=L},obj.updateFormula=function(n,l){for(var c=/[A-Z]/,f=/[0-9]/,L="",k=null,W=null,m="",u=0;u<n.length;u++)c.exec(n[u])?(k=1,W=0,m+=n[u]):f.exec(n[u])?(W=k?1:0,m+=n[u]):(k&&W&&(m=l[m]?l[m]:m),L+=m,L+=n[u],k=0,W=0,m="");return m&&(k&&W&&(m=l[m]?l[m]:m),L+=m),L};var secureFormula=function(n){for(var l="",c=0,f=0;f<n.length;f++)n[f]=='"'&&(c=c==0?1:0),l+=c==1?n[f]:n[f].toUpperCase();return l};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(n){for(var l=0;l<n.length;l++){var c=[],f=n[l].split(":"),L=jexcel.getIdFromColumnName(f[0],!0),k=jexcel.getIdFromColumnName(f[1],!0);if(L[0]<=k[0])var W=L[0],m=k[0];else W=k[0],m=L[0];if(L[1]<=k[1])var u=L[1],d=k[1];else u=k[1],d=L[1];for(var F=u;F<=d;F++)for(var _=W;_<=m;_++)c.push(jexcel.getColumnNameFromId([_,F]));expression=expression.replace(n[l],c.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(n){var res="#ERROR";console.log(n)}return res};return execute(expression,x,y)},obj.parseNumber=function(n,l){var c=l&&obj.options.columns[l].decimal?obj.options.columns[l].decimal:".",f=""+n;return(f=f.split(c))[0]=f[0].match(/[+-]?[0-9]/g),f[0]&&(f[0]=f[0].join("")),f[1]&&(f[1]=f[1].match(/[0-9]*/g).join("")),f[0]&&Number.isInteger(Number(f[0]))?f[1]?n=Number(f[0]+"."+f[1]):n=Number(f[0]+".00"):n=null,n},obj.row=function(n){},obj.col=function(n){},obj.up=function(n,l){if(n?obj.selectedCell[3]>0&&obj.up.visible(1,l?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-c<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var f=obj.whichPage(obj.selectedCell[3]);f!=obj.pageNumber&&obj.page(f)}obj.updateScroll(1)},obj.up.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(l==0){for(var L=0;L<f;L++)if(obj.records[L][c].style.display!="none"&&obj.rows[L].style.display!="none"){f=L;break}}else f=obj.up.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.up.get=function(n,l){n=parseInt(n);for(var c=(l=parseInt(l))-1;c>=0;c--)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[l][n])continue;l=c;break}return l},obj.down=function(n,l){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,l?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}obj.updateScroll(3)},obj.down.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(l==0){for(var L=obj.rows.length-1;L>f;L--)if(obj.records[L][c].style.display!="none"&&obj.rows[L].style.display!="none"){f=L;break}}else f=obj.down.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.down.get=function(n,l){n=parseInt(n);for(var c=(l=parseInt(l))+1;c<obj.rows.length;c++)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[l][n])continue;l=c;break}return l},obj.right=function(n,l){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,l?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(l==0){for(var L=obj.headers.length-1;L>c;L--)if(obj.records[f][L].style.display!="none"){c=L;break}}else c=obj.right.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.right.get=function(n,l){n=parseInt(n),l=parseInt(l);for(var c=n+1;c<obj.headers.length;c++)if(obj.records[l][c].style.display!="none"){if(obj.records[l][c].getAttribute("data-merged")&&obj.records[l][c]==obj.records[l][n])continue;n=c;break}return n},obj.left=function(n,l){n?obj.selectedCell[2]>0&&obj.left.visible(1,l?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,l?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(n,l){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(l==0){for(var L=0;L<c;L++)if(obj.records[f][L].style.display!="none"){c=L;break}}else c=obj.left.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.left.get=function(n,l){n=parseInt(n),l=parseInt(l);for(var c=n-1;c>=0;c--)if(obj.records[l][c].style.display!="none"){if(obj.records[l][c].getAttribute("data-merged")&&obj.records[l][c]==obj.records[l][n])continue;n=c;break}return n},obj.first=function(n,l){if(n?l?obj.selectedCell[3]=0:obj.left.visible(1,0):(l?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,l){if(n?l?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(l?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(n){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)l=obj.rows;else var l=obj.results;var c=100;n!=null&&n!=-1||(n=Math.ceil(l.length/c)-1);var f=n*c,L=n*c+c;L>l.length&&(L=l.length),(f=L-100)<0&&(f=0);for(var k=f;k<L;k++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[k]):obj.tbody.appendChild(obj.rows[l[k]]),obj.tbody.children.length>c&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var l=0;if(n.length>100){var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c>0)for(var f=0;f<30;f++)(c-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[c],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n[c]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),l=1))}return l},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var l=0;if(n.length>100){var c=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c<obj.rows.length-1)for(var f=0;f<=30;f++)c<n.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[c]):obj.tbody.appendChild(obj.rows[n[c]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),l=1)),c+=1}return l},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,l=parseInt(obj.selectedCell[3]/100),c=parseInt(obj.rows.length/100);if(n!=l&&l<=c&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(l),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(n){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],n){var l=function(f){obj.results.indexOf(f)==-1&&obj.results.push(f)},c=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");c=new RegExp(c,"i"),obj.options.data.forEach(function(f,L){if(function(d,F,_){for(var g=0;g<d.length;g++)if((""+d[g]).toLowerCase().search(F)>=0||(""+obj.records[_][g].innerHTML).toLowerCase().search(F)>=0)return!0;return!1}(f,c,L)){var k=obj.isRowMerged(L);if(k.length)for(var W=0;W<k.length;W++)for(var m=jexcel.getIdFromColumnName(k[W],!0),u=0;u<obj.options.mergeCells[k[W]][1];u++)l(m[1]+u);else l(L)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var n,l=0;for(n=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var c=0;c<obj.rows.length;c++)!obj.results||obj.results.indexOf(c)>-1?(l<n&&(obj.tbody.appendChild(obj.rows[c]),l++),obj.rows[c].style.display=""):obj.rows[c].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),n},obj.whichPage=function(n){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=obj.results.indexOf(n)),Math.ceil((parseInt(n)+1)/parseInt(obj.options.pagination))-1},obj.page=function(n){var l=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)c=obj.rows;else var c=obj.results;var f=parseInt(obj.options.pagination);n!=null&&n!=-1||(n=Math.ceil(c.length/f)-1),obj.pageNumber=n;var L=n*f,k=n*f+f;for(k>c.length&&(k=c.length),L<0&&(L=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var W=L;W<k;W++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[W]):obj.tbody.appendChild(obj.rows[c[W]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,n,l)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows.length;else var n=obj.results.length;if(n){var l=Math.ceil(n/obj.options.pagination);if(obj.pageNumber<6)var c=1,f=l<10?l:10;else l-obj.pageNumber<5?(f=l,(c=l-9)<1&&(c=1)):(c=obj.pageNumber-4,f=obj.pageNumber+5);c>1&&((k=document.createElement("div")).className="jexcel_page",k.innerHTML="<",k.title=1,obj.pagination.children[1].appendChild(k));for(var L=c;L<=f;L++){var k;(k=document.createElement("div")).className="jexcel_page",k.innerHTML=L,obj.pagination.children[1].appendChild(k),obj.pageNumber==L-1&&k.classList.add("jexcel_page_selected")}f<l&&((k=document.createElement("div")).className="jexcel_page",k.innerHTML=">",k.title=l,obj.pagination.children[1].appendChild(k)),obj.pagination.children[0].innerHTML=function(W){var m=Array.prototype.slice.call(arguments,1);return W.replace(/{(\d+)}/g,function(u,d){return m[d]!==void 0?m[d]:u})}(obj.options.text.showingPage,obj.pageNumber+1,l)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(n){if(obj.options.allowExport==0)console.error("Export not allowed");else{var l="";l+=obj.copy(!1,obj.options.csvDelimiter,!0,n,!0);var c=new Blob(["\uFEFF"+l],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(c,obj.options.csvFileName+".csv");else{var f=document.createElement("a"),L=URL.createObjectURL(c);f.href=L,f.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(f),f.click(),f.parentNode.removeChild(f)}}},obj.setHistory=function(n){if(obj.ignoreHistory!=1){var l=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,l+1),obj.history[l]=n}},obj.copy=function(n,l,c,f,L){l||(l="	");for(var k=new RegExp(l,"ig"),W=[],m=[],u=[],d=[],F=[],_=obj.options.data[0].length,g=obj.options.data.length,s="",b=!1,j="",h="",C=0,T=0,I=0,B=0,O=!0,A=0;A<g;A++)for(var R=0;R<_;R++)n&&!obj.records[A][R].classList.contains("highlight")||(I<=R&&(I=R),B<=A&&(B=A));if(_===I+1&&g===B+1&&(O=!1),L&&obj.options.includeHeadersOnDownload==1||!L&&obj.options.includeHeadersOnCopy==1&&!O||f){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(s=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],A=0;A<s.length;A++){var Z=[];for(R=0;R<s[A].length;R++){var q=parseInt(s[A][R].colspan);Z.push(s[A][R].title);for(var se=0;se<q-1;se++)Z.push("")}h+=Z.join(l)+`\r
`}b=!0}for(obj.style=[],A=0;A<g;A++){for(m=[],u=[],R=0;R<_;R++)if(!n||obj.records[A][R].classList.contains("highlight")){b==1&&W.push(obj.headers[R].textContent);var ge=obj.options.data[A][R];if(ge.match&&(ge.match(k)||ge.match(/,/g)||ge.match(/\n/)||ge.match(/\"/))&&(ge='"'+(ge=ge.replace(new RegExp('"',"g"),'""'))+'"'),m.push(ge),obj.options.columns[R].type=="checkbox"||obj.options.columns[R].type=="radio")var ae=ge;else(ae=obj.options.stripHTMLOnCopy==1?obj.records[A][R].textContent:obj.records[A][R].innerHTML).match&&(ae.match(k)||ae.match(/,/g)||ae.match(/\n/)||ae.match(/\"/))&&(ae='"'+(ae=ae.replace(new RegExp('"',"g"),'""'))+'"');u.push(ae),s=(s=obj.records[A][R].getAttribute("style")).replace("display: none;",""),obj.style.push(s||"")}m.length&&(b&&(C=m.length,d.push(W.join(l))),d.push(m.join(l))),u.length&&(T++,b&&(F.push(W.join(l)),b=!1),F.push(u.join(l)))}_==C&&g==T&&(j=h);var be=j+d.join(`\r
`),Ae=j+F.join(`\r
`);if(c||(obj.options.copyCompatibility==1?obj.textarea.value=Ae:obj.textarea.value=be,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Ae:obj.data=be,obj.hashString=obj.hash(obj.data),!c){if(obj.removeCopyingSelection(),obj.highlighted)for(R=0;R<obj.highlighted.length;R++)obj.highlighted[R].classList.add("copying"),obj.highlighted[R].classList.contains("highlight-left")&&obj.highlighted[R].classList.add("copying-left"),obj.highlighted[R].classList.contains("highlight-right")&&obj.highlighted[R].classList.add("copying-right"),obj.highlighted[R].classList.contains("highlight-top")&&obj.highlighted[R].classList.add("copying-top"),obj.highlighted[R].classList.contains("highlight-bottom")&&obj.highlighted[R].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?F:d,obj.hashString)}return obj.data},obj.paste=function(n,l,c){var f=parseInt(n),L=parseInt(l),k=parseInt(obj.selectedCell[2]),W=parseInt(obj.selectedCell[3]),m=k-f+1,u=W-L+1;k<f&&(n=k.toString(),m=f-k+1),W<L&&(l=W.toString(),u=L-W+1);var d=obj.dispatch("onbeforepaste",el,c,n,l);if(d===!1)return!1;d&&(c=d);var F=obj.hash(c),_=F==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&F==obj.hashString&&(c=obj.data),c=obj.parseCSV(c,"	"),m>1&Number.isInteger(m/c[0].length)){_=null,s=m/c[0].length;var g=c.map(function(q,se){var ge=Array.apply(null,{length:s*q.length}).map(function(ae,be){return q[be%q.length]});return ge});c=g}if(u>1&Number.isInteger(u/c.length)){_=null;var s=u/c.length;g=Array.apply(null,{length:s*c.length}).map(function(q,se){return c[se%c.length]}),c=g}if(n!=null&&l!=null&&c){for(var b=0,j=0,h=[],C={},T={},I=0,B=parseInt(n),O=parseInt(l),A=null;A=c[j];){for(b=0,B=parseInt(n);A[b]!=null;){var R=obj.updateCell(B,O,A[b]);if(h.push(R),obj.updateFormulaChain(B,O,h),_&&_[I]){var Z=jexcel.getColumnNameFromId([B,O]);C[Z]=_[I],T[Z]=obj.getStyle(Z),obj.records[O][B].setAttribute("style",_[I]),I++}if(A[++b]!=null){if(B>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}B=obj.right.get(B,O)}}if(j++,c[j]){if(O>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}O=obj.down.get(n,O)}}obj.updateSelectionFromCoords(n,l,B,O),obj.setHistory({action:"setValue",records:h,selection:obj.selectedCell,newStyle:C,oldStyle:T}),obj.updateTable(),obj.dispatch("onpaste",el,c),obj.onafterchanges(el,h)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var n=document.querySelectorAll(".jexcel .copying"),l=0;l<n.length;l++)n[l].classList.remove("copying"),n[l].classList.remove("copying-left"),n[l].classList.remove("copying-right"),n[l].classList.remove("copying-top"),n[l].classList.remove("copying-bottom")},obj.historyProcessRow=function(n,l){var c=l.insertBefore?+l.rowNumber:l.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),n==1){for(var f=l.numOfRows,L=c;L<f+c;L++)obj.rows[L].parentNode.removeChild(obj.rows[L]);obj.records.splice(c,f),obj.options.data.splice(c,f),obj.rows.splice(c,f),obj.conditionalSelectionUpdate(1,c,f+c-1)}else{obj.records=jexcel.injectArray(obj.records,c,l.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,c,l.rowData),obj.rows=jexcel.injectArray(obj.rows,c,l.rowNode);var k=0;for(L=c;L<l.numOfRows+c;L++)obj.tbody.insertBefore(l.rowNode[k],obj.tbody.children[L]),k++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(n,l){var c=l.insertBefore?l.columnNumber:l.columnNumber+1;if(n==1){var f=l.numOfColumns;obj.options.columns.splice(c,f);for(var L=c;L<f+c;L++)obj.headers[L].parentNode.removeChild(obj.headers[L]),obj.colgroup[L].parentNode.removeChild(obj.colgroup[L]);obj.headers.splice(c,f),obj.colgroup.splice(c,f);for(var k=0;k<l.data.length;k++){for(L=c;L<f+c;L++)obj.records[k][L].parentNode.removeChild(obj.records[k][L]);obj.records[k].splice(c,f),obj.options.data[k].splice(c,f)}if(obj.options.footers)for(k=0;k<obj.options.footers.length;k++)obj.options.footers[k].splice(c,f)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,c,l.columns),obj.headers=jexcel.injectArray(obj.headers,c,l.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,c,l.colgroup);var W=0;for(L=c;L<l.numOfColumns+c;L++)obj.headerContainer.insertBefore(l.headers[W],obj.headerContainer.children[L+1]),obj.colgroupContainer.insertBefore(l.colgroup[W],obj.colgroupContainer.children[L+1]),W++;for(k=0;k<l.data.length;k++)for(obj.options.data[k]=jexcel.injectArray(obj.options.data[k],c,l.data[k]),obj.records[k]=jexcel.injectArray(obj.records[k],c,l.records[k]),W=0,L=c;L<l.numOfColumns+c;L++)obj.rows[k].insertBefore(l.records[k][W],obj.rows[k].children[L+1]),W++;if(obj.options.footers)for(k=0;k<obj.options.footers.length;k++)obj.options.footers[k]=jexcel.injectArray(obj.options.footers[k],c,l.footers[k])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(k=0;k<obj.options.nestedHeaders.length;k++){if(n==1)var m=parseInt(obj.options.nestedHeaders[k][obj.options.nestedHeaders[k].length-1].colspan)-l.numOfColumns;else m=parseInt(obj.options.nestedHeaders[k][obj.options.nestedHeaders[k].length-1].colspan)+l.numOfColumns;obj.options.nestedHeaders[k][obj.options.nestedHeaders[k].length-1].colspan=m,obj.thead.children[k].children[obj.thead.children[k].children.length-1].setAttribute("colspan",m)}else m=n==1?parseInt(obj.options.nestedHeaders[0].colspan)-l.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+l.numOfColumns,obj.options.nestedHeaders[0].colspan=m,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",m);obj.updateTableReferences()},obj.undo=function(){var n=!!obj.ignoreEvents,l=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var c=[];if(obj.historyIndex>=0){var f=obj.history[obj.historyIndex--];if(f.action=="insertRow")obj.historyProcessRow(1,f);else if(f.action=="deleteRow")obj.historyProcessRow(0,f);else if(f.action=="insertColumn")obj.historyProcessColumn(1,f);else if(f.action=="deleteColumn")obj.historyProcessColumn(0,f);else if(f.action=="moveRow")obj.moveRow(f.newValue,f.oldValue);else if(f.action=="moveColumn")obj.moveColumn(f.newValue,f.oldValue);else if(f.action=="setMerge")obj.removeMerge(f.column,f.data);else if(f.action=="setStyle")obj.setStyle(f.oldValue,null,null,1);else if(f.action=="setWidth")obj.setWidth(f.column,f.oldValue);else if(f.action=="setHeight")obj.setHeight(f.row,f.oldValue);else if(f.action=="setHeader")obj.setHeader(f.column,f.oldValue);else if(f.action=="setComments")obj.setComments(f.column,f.oldValue[0],f.oldValue[1]);else if(f.action=="orderBy"){for(var L=[],k=0;k<f.rows.length;k++)L[f.rows[k]]=k;obj.updateOrderArrow(f.column,f.order?0:1),obj.updateOrder(L)}else if(f.action=="setValue"){for(var W=0;W<f.records.length;W++)c.push({x:f.records[W].x,y:f.records[W].y,newValue:f.records[W].oldValue}),f.oldStyle&&obj.resetStyle(f.oldStyle);obj.setValue(c),f.selection&&obj.updateSelectionFromCoords(f.selection[0],f.selection[1],f.selection[2],f.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=l,obj.dispatch("onundo",el,f)},obj.redo=function(){var n=!!obj.ignoreEvents,l=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var c=obj.history[++obj.historyIndex];if(c.action=="insertRow")obj.historyProcessRow(0,c);else if(c.action=="deleteRow")obj.historyProcessRow(1,c);else if(c.action=="insertColumn")obj.historyProcessColumn(0,c);else if(c.action=="deleteColumn")obj.historyProcessColumn(1,c);else if(c.action=="moveRow")obj.moveRow(c.oldValue,c.newValue);else if(c.action=="moveColumn")obj.moveColumn(c.oldValue,c.newValue);else if(c.action=="setMerge")obj.setMerge(c.column,c.colspan,c.rowspan,1);else if(c.action=="setStyle")obj.setStyle(c.newValue,null,null,1);else if(c.action=="setWidth")obj.setWidth(c.column,c.newValue);else if(c.action=="setHeight")obj.setHeight(c.row,c.newValue);else if(c.action=="setHeader")obj.setHeader(c.column,c.newValue);else if(c.action=="setComments")obj.setComments(c.column,c.newValue[0],c.newValue[1]);else if(c.action=="orderBy")obj.updateOrderArrow(c.column,c.order),obj.updateOrder(c.rows);else if(c.action=="setValue"){obj.setValue(c.records);for(var f=0;f<c.records.length;f++)c.oldStyle&&obj.resetStyle(c.newStyle);c.selection&&obj.updateSelectionFromCoords(c.selection[0],c.selection[1],c.selection[2],c.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=l,obj.dispatch("onredo",el,c)},obj.getDropDownValue=function(n,l){var c=[];if(obj.options.columns[n]&&obj.options.columns[n].source){for(var f=[],L=obj.options.columns[n].source,k=0;k<L.length;k++)typeof L[k]=="object"?f[L[k].id]=L[k].name:f[L[k]]=L[k];var W=Array.isArray(l)?l:(""+l).split(";");for(k=0;k<W.length;k++)typeof W[k]=="object"?c.push(f[W[k].id]):f[W[k]]&&c.push(f[W[k]])}else console.error("Invalid column");return c.length>0?c.join("; "):""},obj.parseCSV=function(n,l){(n=n.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(n.length-1)==9&&(n+="\0"),l=l||",";for(var c=[],f=!1,L=0,k=0,W=0;W<n.length;W++){var m=n[W],u=n[W+1];c[L]=c[L]||[],c[L][k]=c[L][k]||"",m=='"'&&f&&u=='"'?(c[L][k]+=m,++W):m!='"'?m!=l||f?m!="\r"||u!=`
`||f?m==`
`&&!f||m=="\r"&&!f?(++L,k=0):c[L][k]+=m:(++L,k=0,++W):++k:f=!f}return c},obj.hash=function(n){var l,c=0;if(n.length===0)return c;for(l=0;l<n.length;l++)c=(c<<5)-c+n.charCodeAt(l),c|=0;return c},obj.onafterchanges=function(n,l){obj.dispatch("onafterchanges",n,l)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(n){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(n){var l=obj.parseCSV(n,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&l.length>0)for(var c=l.shift(),f=0;f<c.length;f++)obj.options.columns[f]||(obj.options.columns[f]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[f].title===void 0&&(obj.options.columns[f].title=c[f]);obj.options.data=l,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(n,l,c,f){var L=[];if(c==null)obj.options.allowInsertColumn==1&&L.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(l),1)}}),obj.options.allowInsertColumn==1&&L.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(l),0)}}),obj.options.allowDeleteColumn==1&&L.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(l))}}),obj.options.allowRenameColumn==1&&L.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(l)}}),obj.options.columnSorting==1&&(L.push({type:"line"}),L.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(l,0)}}),L.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(l,1)}}));else if(obj.options.allowInsertRow==1&&(L.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(c),1)}}),L.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(c))}})),obj.options.allowDeleteRow==1&&L.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(c))}}),l&&obj.options.allowComments==1){L.push({type:"line"});var k=obj.records[c][l].getAttribute("title")||"";L.push({title:k?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var W=prompt(obj.options.text.comments,k);W&&obj.setComments([l,c],W)}}),k&&L.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([l,c],"")}})}return L.push({type:"line"}),L.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&L.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(W){W&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],W)})}}),obj.options.allowExport&&L.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&L.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),L},obj.scrollControls=function(n){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&n.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(n){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var n=0;if(obj.options.freezeColumns>0)for(var l=0;l<obj.options.freezeColumns;l++)n+=parseInt(obj.options.columns[l].width);return n};var scrollLeft=0;return obj.updateFreezePosition=function(){var n=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var l=0;l<obj.options.freezeColumns;l++){l>0&&obj.options.columns[l-1].type!=="hidden"&&(n+=parseInt(obj.options.columns[l-1].width)),obj.headers[l].classList.add("jexcel_freezed"),obj.headers[l].style.left=n+"px";for(var c=0;c<obj.rows.length;c++)if(obj.rows[c]&&obj.records[c][l]){var f=scrollLeft+(l>0?obj.records[c][l-1].style.width:0)-51+"px";obj.records[c][l].classList.add("jexcel_freezed"),obj.records[c][l].style.left=f}}else for(l=0;l<obj.options.freezeColumns;l++)for(obj.headers[l].classList.remove("jexcel_freezed"),obj.headers[l].style.left="",c=0;c<obj.rows.length;c++)obj.records[c][l]&&(obj.records[c][l].classList.remove("jexcel_freezed"),obj.records[c][l].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(n){jSuites.setDictionary(n)},jexcel.setExtensions=function(n){for(var l=Object.keys(n),c=0;c<l.length;c++)typeof n[l[c]]=="function"&&(jexcel[l[c]]=n[l[c]],jexcel.license&&typeof n[l[c]].license=="function"&&n[l[c]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(n){n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(n,l){if(n.jexcel){var c=n.jexcel.options.root?n.jexcel.options.root:document;n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",l&&(destroyEvents(c),jexcel=null)}},jexcel.build=function(n){destroyEvents(n),n.addEventListener("mouseup",jexcel.mouseUpControls),n.addEventListener("mousedown",jexcel.mouseDownControls),n.addEventListener("mousemove",jexcel.mouseMoveControls),n.addEventListener("mouseover",jexcel.mouseOverControls),n.addEventListener("dblclick",jexcel.doubleClickControls),n.addEventListener("paste",jexcel.pasteControls),n.addEventListener("contextmenu",jexcel.contextMenuControls),n.addEventListener("touchstart",jexcel.touchStartControls),n.addEventListener("touchend",jexcel.touchEndControls),n.addEventListener("touchcancel",jexcel.touchEndControls),n.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(n){if(jexcel.current){if(jexcel.current.edition)if(n.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&n.altKey){var l=jexcel.current.edition[0].children[0],c=jexcel.current.edition[0].children[0].value,f=l.selectionStart;c=c.slice(0,f)+`
`+c.slice(f),l.value=c,l.focus(),l.selectionStart=f+1,l.selectionEnd=f+1}else jexcel.current.edition[0].children[0].blur()}else n.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(n.which==37)jexcel.current.left(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)jexcel.current.right(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)jexcel.current.up(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)jexcel.current.down(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)jexcel.current.first(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)jexcel.current.last(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46||n.which==8)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(n.which==13)n.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),n.preventDefault();else if(n.which==9)n.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var L=jexcel.current.selectedCell[1],k=jexcel.current.selectedCell[0];jexcel.current.options.columns[k].type!="readonly"&&(n.keyCode==32?(n.preventDefault(),jexcel.current.options.columns[k].type=="checkbox"||jexcel.current.options.columns[k].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[L][k],!0)):n.keyCode==113?jexcel.current.openEditor(jexcel.current.records[L][k],!1):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(n.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[L][k],!0),jexcel.current.options.columns[k].type=="calendar"&&n.preventDefault()))}}else n.which==65?(jexcel.current.selectAll(),n.preventDefault()):n.which==83?(jexcel.current.download(),n.preventDefault()):n.which==89?(jexcel.current.redo(),n.preventDefault()):n.which==90?(jexcel.current.undo(),n.preventDefault()):n.which==67?(jexcel.current.copy(!0),n.preventDefault()):n.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),n.preventDefault()):n.which==86&&jexcel.pasteControls();else n.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(n.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(n){if((n=n||window.event).buttons)var l=n.buttons;else l=n.button?n.button:n.which;var c=jexcel.getElement(n.target);if(c[0]?jexcel.current!=c[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=c[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&l==1){if(n.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(n.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(c[1]==1){if(s=n.target.getAttribute("data-x")){var f=n.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&f.width-n.offsetX<6){jexcel.current.resizing={mousePosition:n.pageX,column:s,width:f.width},jexcel.current.headers[s].classList.add("resizing");for(var L=0;L<jexcel.current.records.length;L++)jexcel.current.records[L][s]&&jexcel.current.records[L][s].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&f.height-n.offsetY<6)if(jexcel.current.isColMerged(s).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target,column:s,destination:s},jexcel.current.headers[s].classList.add("dragging"),L=0;L<jexcel.current.records.length;L++)jexcel.current.records[L][s]&&jexcel.current.records[L][s].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(n.shiftKey||n.ctrlKey))var k=jexcel.current.selectedHeader,W=s;else jexcel.current.selectedHeader==s&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(s)},800)),jexcel.current.selectedHeader=s,k=s,W=s;jexcel.current.updateSelectionFromCoords(k,0,W,jexcel.current.options.data.length-1)}}else if(n.target.parentNode.classList.contains("jexcel_nested")){if(n.target.getAttribute("data-column"))var m=n.target.getAttribute("data-column").split(","),u=parseInt(m[0]),d=parseInt(m[m.length-1]);else u=0,d=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(u,0,d,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(c[1]==2){var F=n.target.getAttribute("data-y");if(n.target.classList.contains("jexcel_row"))f=n.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&f.height-n.offsetY<6?(jexcel.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:F,height:f.height},n.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&f.width-n.offsetX<6?jexcel.current.isRowMerged(F).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target.parentNode,row:F,destination:F},n.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(k=jexcel.current.selectedRow,W=F):(jexcel.current.selectedRow=F,k=F,W=F),jexcel.current.updateSelectionFromCoords(0,k,jexcel.current.options.data[0].length-1,W));else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var _=function(b){var j=b.getAttribute("data-x"),h=b.getAttribute("data-y");return j&&h?[j,h]:b.parentNode?_(b.parentNode):void 0},g=_(n.target);if(g){var s=g[0];F=g[1],jexcel.current.edition&&(jexcel.current.edition[2]==s&&jexcel.current.edition[3]==F||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(n.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],s,F):jexcel.current.updateSelectionFromCoords(s,F)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;n.target.classList.contains("jexcel_page")&&(n.target.textContent=="<"?jexcel.current.page(0):n.target.textContent==">"?jexcel.current.page(n.target.getAttribute("title")-1):jexcel.current.page(n.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(n){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var l=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),c=jexcel.current.getSelectedColumns();if(c.length>1){for(var f=[],L=0;L<c.length;L++)f.push(parseInt(jexcel.current.colgroup[c[L]].getAttribute("width")));f[c.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(c,l,f)}else jexcel.current.setWidth(jexcel.current.resizing.column,l,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var k=0;k<jexcel.current.records.length;k++)jexcel.current.records[k][jexcel.current.resizing.column]&&jexcel.current.records[k][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var W=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,W,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var m=n.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),k=0;k<jexcel.current.rows.length;k++)jexcel.current.records[k][jexcel.current.dragging.column]&&jexcel.current.records[k][jexcel.current.dragging.column].classList.remove("dragging");for(L=0;L<jexcel.current.headers.length;L++)jexcel.current.headers[L].classList.remove("dragging-left"),jexcel.current.headers[L].classList.remove("dragging-right");m&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var u=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<u&&(u-=1)}else u=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,u,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(n){if((n=n||window.event).buttons)var l=n.buttons;else l=n.button?n.button:n.which;if(l||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var c=n.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+c>0){var f=jexcel.current.resizing.width+c;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",f),jexcel.current.updateCornerPosition()}}else{var L=n.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+L>0){var k=jexcel.current.resizing.height+L;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",k),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var W=n.target.getAttribute("data-x");if(W)if(jexcel.current.isColMerged(W).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var m=0;m<jexcel.current.headers.length;m++)jexcel.current.headers[m].classList.remove("dragging-left"),jexcel.current.headers[m].classList.remove("dragging-right");jexcel.current.dragging.column==W?jexcel.current.dragging.destination=parseInt(W):n.target.clientWidth/2>n.offsetX?(jexcel.current.dragging.column<W?jexcel.current.dragging.destination=parseInt(W)-1:jexcel.current.dragging.destination=parseInt(W),jexcel.current.headers[W].classList.add("dragging-left")):(jexcel.current.dragging.column<W?jexcel.current.dragging.destination=parseInt(W):jexcel.current.dragging.destination=parseInt(W)+1,jexcel.current.headers[W].classList.add("dragging-right"))}}else{var u=n.target.getAttribute("data-y");if(u)if(jexcel.current.isRowMerged(u).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var d=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;jexcel.current.dragging.element!=d&&(n.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,d),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var F=n.target.getAttribute("data-x"),_=n.target.getAttribute("data-y"),g=n.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&F&&!_&&g.width-(n.clientX-g.left)<6?(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="col-resize"):n.target&&!F&&_&&g.height-(n.clientY-g.top)<6&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!F&&_&&g.width-(n.clientX-g.left)<6||n.target&&F&&!_&&g.height-(n.clientY-g.top)<6)&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(n){if((n=n||window.event).buttons)var l=n.buttons;else l=n.button?n.button:n.which;if(l||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var c=jexcel.getElement(n.target);if(c[0]){if(jexcel.current!=c[0].jexcel&&jexcel.current)return!1;var f=n.target.getAttribute("data-x"),L=n.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(c[1]==1&&jexcel.current.selectedHeader){f=n.target.getAttribute("data-x");var k=jexcel.current.selectedHeader,W=f;jexcel.current.updateSelectionFromCoords(k,0,W,jexcel.current.options.data.length-1)}c[1]==2&&(n.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(k=jexcel.current.selectedRow,W=L,jexcel.current.updateSelectionFromCoords(0,k,jexcel.current.options.data[0].length-1,W)):jexcel.current.edition||f&&L&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(f,L):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],f,L)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(n){if(jexcel.current)if(n.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var l=jexcel.current.highlighted[0].getAttribute("data-x"),c=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,f=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),L=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[c][l],jexcel.current.records[L][f])}}else if(n.target.classList.contains("jexcel_column_filter")){var k=n.target.getAttribute("data-x");jexcel.current.openFilter(k)}else{var W=jexcel.getElement(n.target);if(W[1]==1&&jexcel.current.options.columnSorting==1&&(k=n.target.getAttribute("data-x"))&&jexcel.current.orderBy(k),W[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var m=function(d){if(d.parentNode){var F=d.getAttribute("data-x"),_=d.getAttribute("data-y");return F&&_?d:m(d.parentNode)}},u=m(n.target);u&&u.classList.contains("highlight")&&jexcel.current.openEditor(u)}}},jexcel.copyControls=function(n){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(n){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(n){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(n&&n.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current){if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var l=n.target.getAttribute("data-x"),c=n.target.getAttribute("data-y");if(l||c){(l<parseInt(jexcel.current.selectedCell[0])||l>parseInt(jexcel.current.selectedCell[2])||c<parseInt(jexcel.current.selectedCell[1])||c>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(l,c,l,c);var f=jexcel.current.options.contextMenu(jexcel.current,l,c,n);jexcel.current.contextMenu.contextmenu.open(n,f),n.preventDefault()}}}},jexcel.touchStartControls=function(n){var l=jexcel.getElement(n.target);if(l[0]?jexcel.current!=l[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=l[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var c=n.target.getAttribute("data-x"),f=n.target.getAttribute("data-y");c&&f&&(jexcel.current.updateSelectionFromCoords(c,f),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[c].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(n){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(n,l){var c=[];if(n.classList.contains("jexcel_tabs"))L=n.children[0],k=n.children[1];else{n.innerHTML="",n.classList.add("jexcel_tabs"),n.jexcel=[];var f=document.createElement("div"),L=n.appendChild(f),k=(f=document.createElement("div"),n.appendChild(f))}for(var W=[],m=[],u=0;u<l.length;u++){W[u]=document.createElement("div"),W[u].classList.add("jexcel_tab");var d=jexcel(W[u],l[u]);k.appendChild(W[u]),c[u]=n.jexcel.push(d),m[u]=document.createElement("div"),m[u].classList.add("jexcel_tab_link"),m[u].setAttribute("data-spreadsheet",n.jexcel.length-1),m[u].innerHTML=l[u].sheetName,m[u].onclick=function(){for(var _=0;_<L.children.length;_++)L.children[_].classList.remove("selected"),k.children[_].style.display="none";var g=this.getAttribute("data-spreadsheet");k.children[g].style.display="block",L.children[g].classList.add("selected")},L.appendChild(m[u])}for(var F=0;F<L.children.length;F++)L.children[F].classList.remove("selected"),k.children[F].style.display="none";return L.children[L.children.length-1].classList.add("selected"),k.children[L.children.length-1].style.display="block",c},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(n,l){var c,f=function(L){var k=[];return L.SheetNames.forEach(function(W){var m={rows:[],columns:[],data:[],style:{}};if(m.sheetName=W,(h=L.Sheets[W]["!cols"])&&h.length)for(var u=0;u<h.length;u++)m.columns[u]={},h[u]&&h[u].wpx&&(m.columns[u].width=h[u].wpx+"px");if((h=L.Sheets[W]["!rows"])&&h.length)for(u=0;u<h.length;u++)h[u]&&h[u].hpx&&(m.rows[u]={},m.rows[u].height=h[u].hpx+"px");if((h=L.Sheets[W]["!merges"])&&h.length>0)for(m.mergeCells=[],u=0;u<h.length;u++){var d=h[u].s.c,F=h[u].s.r,_=h[u].e.c,g=h[u].e.r,s=jexcel.getColumnNameFromId([d,F]);m.mergeCells[s]=[_-d+1,g-F+1]}var b=0,j=0,h=Object.keys(L.Sheets[W]);for(u=0;u<h.length;u++)if(h[u].substr(0,1)!="!"){var C=L.Sheets[W][h[u]],T=jexcel.getIdFromColumnName(h[u],!0);m.data[T[1]]||(m.data[T[1]]=[]),m.data[T[1]][T[0]]=C.f?"="+C.f:C.w,b<T[0]&&(b=T[0]),j<T[1]&&(j=T[1]),C.style&&Object.keys(C.style).length>0&&(m.style[h[u]]=C.style),C.s&&C.s.fgColor&&(m.style[h[u]]&&(m.style[h[u]]+=";"),m.style[h[u]]+="background-color:#"+C.s.fgColor.rgb)}for(var I=m.columns,B=0;B<=j;B++)for(u=0;u<=b;u++)m.data[B]||(m.data[B]=[]),m.data[B][u]||I<u&&(m.data[B][u]="");k.push(m)}),k};(c=new XMLHttpRequest).open("GET",n,!0),typeof Uint8Array<"u"?(c.responseType="arraybuffer",c.onload=function(L){var k=c.response,W=new Uint8Array(k),m=XLSX.read(W,{type:"array",cellFormula:!0,cellStyles:!0});l(f(m))}):(c.setRequestHeader("Accept-Charset","x-user-defined"),c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){var L=convertResponseBodyToText(c.responseBody),k=XLSX.read(L,{type:"binary",cellFormula:!0,cellStyles:!0});l(f(k))}}),c.send()},jexcel.validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,l,c){return n.slice(0,l).concat(c).concat(n.slice(l))},jexcel.getColumnName=function(n){return jexcel.helpers.getColumnName(n)},jexcel.getIdFromColumnName=function(n,l){var c=/^[a-zA-Z]+/.exec(n);if(c){for(var f=0,L=0;L<c[0].length;L++)f+=parseInt(c[0].charCodeAt(L)-64)*Math.pow(26,c[0].length-1-L);--f<0&&(f=0);var k=parseInt(/[0-9]+$/.exec(n));k>0&&k--,n=l==1?[f,k]:f+"-"+k}return n},jexcel.getColumnNameFromId=function(n){return Array.isArray(n)||(n=n.split("-")),jexcel.getColumnName(parseInt(n[0]))+(parseInt(n[1])+1)},jexcel.getElement=function(n){var l=0,c=0;return function f(L){L.className&&L.classList.contains("jexcel_container")&&(c=L),L.tagName=="THEAD"?l=1:L.tagName=="TBODY"&&(l=2),L.parentNode&&(c||f(L.parentNode))}(n),[c,l]},jexcel.doubleDigitFormat=function(n){return(n=""+n).length==1&&(n="0"+n),n},jexcel.createFromTable=function(n,l){if(n.tagName=="TABLE"){l||(l={}),l.columns=[],l.data=[];var c=n.querySelectorAll("colgroup > col");if(c.length)for(var f=0;f<c.length;f++){if(!(L=c[f].style.width))var L=c[f].getAttribute("width");L&&(l.columns[f]||(l.columns[f]={}),l.columns[f].width=L)}var k=function(be){var Ae=be.getBoundingClientRect(),je=Ae.width>50?Ae.width:50;l.columns[f]||(l.columns[f]={}),be.getAttribute("data-celltype")?l.columns[f].type=be.getAttribute("data-celltype"):l.columns[f].type="text",l.columns[f].width=je+"px",l.columns[f].title=be.innerHTML,l.columns[f].align=be.style.textAlign||"center",(Ae=be.getAttribute("name"))&&(l.columns[f].name=Ae),(Ae=be.getAttribute("id"))&&(l.columns[f].id=Ae),(Ae=be.getAttribute("data-mask"))&&(l.columns[f].mask=Ae)},W=[],m=n.querySelectorAll(":scope > thead > tr");if(m.length){for(var u=0;u<m.length-1;u++){var d=[];for(f=0;f<m[u].children.length;f++){var F={title:m[u].children[f].textContent,colspan:m[u].children[f].getAttribute("colspan")||1};d.push(F)}W.push(d)}for(m=m[m.length-1].children,f=0;f<m.length;f++)k(m[f])}var _=0,g={},s={},b={},j={},h=n.querySelectorAll(":scope > tr, :scope > tbody > tr");for(u=0;u<h.length;u++)if(l.data[_]=[],l.parseTableFirstRowAsHeader!=1||m.length||u!=0){for(f=0;f<h[u].children.length;f++){if(C=h[u].children[f].getAttribute("data-formula"))C.substr(0,1)!="="&&(C="="+C);else var C=h[u].children[f].innerHTML;l.data[_].push(C);var T=jexcel.getColumnNameFromId([f,u]),I=h[u].children[f].getAttribute("class");I&&(j[T]=I);var B=parseInt(h[u].children[f].getAttribute("colspan"))||0,O=parseInt(h[u].children[f].getAttribute("rowspan"))||0;(B||O)&&(g[T]=[B||1,O||1]),h[u].children[f].style&&h[u].children[f].style.display=="none"&&(h[u].children[f].style.display="");var A=h[u].children[f].getAttribute("style");A&&(b[T]=A),h[u].children[f].classList.contains("styleBold")&&(b[T]?b[T]+="; font-weight:bold;":b[T]="font-weight:bold;")}h[u].style&&h[u].style.height&&(s[u]={height:h[u].style.height}),_++}else for(f=0;f<h[u].children.length;f++)k(h[u].children[f]);if(Object.keys(W).length>0&&(l.nestedHeaders=W),Object.keys(b).length>0&&(l.style=b),Object.keys(g).length>0&&(l.mergeCells=g),Object.keys(s).length>0&&(l.rows=s),Object.keys(j).length>0&&(l.classes=j),(h=n.querySelectorAll("tfoot tr")).length){var R=[];for(u=0;u<h.length;u++){var Z=[];for(f=0;f<h[u].children.length;f++)Z.push(h[u].children[f].textContent);R.push(Z)}Object.keys(R).length>0&&(l.footers=R)}if(l.parseTableAutoCellType==1){var q=[];for(f=0;f<l.columns.length;f++){var se=!0,ge=!0;for(q[f]=[],u=0;u<l.data.length;u++)C=l.data[u][f],q[f][C]||(q[f][C]=0),q[f][C]++,C.length>25&&(se=!1),C.length==10&&C.substr(4,1)=="-"&&C.substr(7,1)=="-"||(ge=!1);var ae=Object.keys(q[f]).length;ge?l.columns[f].type="calendar":se==1&&ae>1&&ae<=parseInt(.1*l.data.length)&&(l.columns[f].type="dropdown",l.columns[f].source=Object.keys(q[f]))}}return l}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(n){if(this.config.root)var l=this.config.root;else l=window;var c=0,f=l.getSelection();if(f&&f.rangeCount!==0){var L=f.getRangeAt(0),k=L.cloneRange();k.selectNodeContents(n),k.setEnd(L.endContainer,L.endOffset),c=k.toString().length}return c},invert:function(n){for(var l=[],c=Object.keys(n),f=0;f<c.length;f++)l[n[c[f]]]=c[f];return l},getColumnName:function(n){let l,c=n+1,f="";for(;c>0;)l=(c-1)%26,f=String.fromCharCode(65+l).toString()+f,c=parseInt((c-l)/26);return f},getColumnNameFromCoords:function(n,l){return component.getColumnName(parseInt(n))+(parseInt(l)+1)},getCoordsFromColumnName:function(n){var l=/^[a-zA-Z]+/.exec(n);if(l){for(var c=0,f=0;f<l[0].length;f++)c+=parseInt(l[0].charCodeAt(f)-64)*Math.pow(26,l[0].length-1-f);--c<0&&(c=0);var L=parseInt(/[0-9]+$/.exec(n))||null;return L>0&&L--,[c,L]}},createFromTable:function(){},injectArray:function(n,l,c){return n.slice(0,l).concat(c).concat(n.slice(l))},parseCSV:function(n,l){l=l||",";for(var c=0,f=0,L=[[]],k=0,W=null,m=!1,u=!1,d=0;d<n.length;d++)if(L[f]||(L[f]=[]),L[f][c]||(L[f][c]=""),n[d]!="\r")if(n[d]!=`
`&&n[d]!=l||m!=0&&u!=1&&W){if(n[d]=='"'&&(m=!m),W===null){if((W=m)==1)continue}else if(W===!0&&!u&&n[d]=='"'){n[d+1]=='"'?(m=!0,L[f][c]+=n[d],d++):u=!0;continue}L[f][c]+=n[d]}else{if(W=null,m=!1,u=!1,L[f][c][0]=='"'){var F=L[f][c].trim();F[F.length-1]=='"'&&(L[f][c]=F.substr(1,F.length-2))}n[d]==`
`?(c=0,f++):++c>k&&(k=c)}for(var _=0;_<L.length;_++)for(d=0;d<=k;d++)L[_][d]===void 0&&(L[_][d]="");return L}},component),typeof jQuery<"u"&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(l){var c=n(this).get(0);return c.jexcel?Array.isArray(c.jexcel)?c.jexcel[l][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):c.jexcel[l].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(n){var l=__webpack_module_cache__[n];if(l!==void 0)return l.exports;var c=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(c.exports,c,c.exports,__webpack_require__),c.exports}var __webpack_exports__=__webpack_require__(44);jspreadsheet=__webpack_exports__}(),jspreadsheet})})(dist);const jspreadsheet$1=distExports,jspreadsheet="",JspreadsheetComponent_vue_vue_type_style_index_0_scoped_10e37365_lang="",_sfc_main={name:"JspreadsheetComponent",setup(){const n=ref(null);return onMounted(()=>{const l={data:[["","T-Shirt","Pants"],["Size","XL","M"]],columns:[{type:"text",title:"Product",width:120},{type:"dropdown",title:"Option",width:120,source:["Option1","Option2","Option3"]},{type:"text",title:"Details",width:150}]};console.log("Jspreadsheet config:",l),jspreadsheet$1(n.value,l)}),{spreadsheetContainer:n}}},_hoisted_1={ref:"spreadsheetContainer"};function _sfc_render(n,l,c,f,L,k){return openBlock(),createElementBlock("div",_hoisted_1,null,512)}const JspreadsheetComponent=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-10e37365"]]);export{JspreadsheetComponent as default};
